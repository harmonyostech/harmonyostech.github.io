<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harmonyostech.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="[Daily HarmonyOS Hext Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction1. HarmonyOS: When navigating to a">
<meta property="og:type" content="article">
<meta property="og:title" content="[Daily HarmonyOS Next Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction">
<meta property="og:url" content="https://harmonyostech.github.io/2025/06/29/4127-Daily-HarmonyOS-Next-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction/index.html">
<meta property="og:site_name" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:description" content="[Daily HarmonyOS Hext Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction1. HarmonyOS: When navigating to a">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-06-28T16:09:01.000Z">
<meta property="article:modified_time" content="2025-06-28T16:09:34.507Z">
<meta property="article:author" content="Qingkouwei">
<meta property="article:tag" content="HarmonyOS Next">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://harmonyostech.github.io/2025/06/29/4127-Daily-HarmonyOS-Next-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>[Daily HarmonyOS Next Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction | HarmonyOS NEXT Knowledge Charging Station</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HarmonyOS NEXT Knowledge Charging Station</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Analysis of Core Technologies and Application Scenarios of HarmonyOS NEXT</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/4127-Daily-HarmonyOS-Next-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [Daily HarmonyOS Next Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 00:09:01 / Modified: 00:09:34" itemprop="dateCreated datePublished" datetime="2025-06-29T00:09:01+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Daily-HarmonyOS-Hext-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction"><a href="#Daily-HarmonyOS-Hext-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction" class="headerlink" title="[Daily HarmonyOS Hext Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction"></a>[Daily HarmonyOS Hext Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction</h1><h4 id="1-HarmonyOS-When-navigating-to-a-non-existent-URL-no-exception-is-thrown-and-it-jumps-to-a-blank-page"><a href="#1-HarmonyOS-When-navigating-to-a-non-existent-URL-no-exception-is-thrown-and-it-jumps-to-a-blank-page" class="headerlink" title="1. HarmonyOS: When navigating to a non-existent URL, no exception is thrown, and it jumps to a blank page?"></a>1. HarmonyOS: When navigating to a non-existent URL, no exception is thrown, and it jumps to a blank page?</h4><p>Using <code>pushDestinationByName</code> can catch exceptions. Refer to the following:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">this.pageStack.pushDestinationByName(&#x27;PageOne&#x27;, &quot;PageOne Param&quot;)</span><br><span class="line">  .catch((error: BusinessError) =&gt; &#123;</span><br><span class="line">    console.error(`Push destination failed, error code = $&#123;error.code&#125;, error.message = $&#123;error.message&#125;.`);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">  console.error(&#x27;Push destination succeed.&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">#### 2. HarmonyOS: How to set the webview to load the mobile version of a webpage by default?  </span><br></pre></td></tr></table></figure>
<p>import webview from ‘@ohos.web.webview’;</p>
<p>@Entry<br>@Component<br>struct Page2 {<br>  webController: webview.WebviewController &#x3D; new webview.WebviewController();<br>  aboutToAppear(): void {<br>    webview.WebviewController.setWebDebuggingAccess(true)<br>  }<br>  build() {<br>    Row() {<br>      Column() {<br>        Web({src: “<a target="_blank" rel="noopener" href="https://www.huawei.com/">https://www.huawei.com</a>“, controller: this.webController}).domStorageAccess(true)<br>          .onControllerAttached(() &#x3D;&gt; {<br>          let newAgent &#x3D; “Mozilla&#x2F;5.0 (Phone; OpenHarmony 4.1) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;114.0.0.0 Safari&#x2F;537.36 ArkWeb&#x2F;4.1.6.1 Mobile”;<br>          this.webController.setCustomUserAgent(newAgent)<br>        })<br>      }<br>      .width(‘100%’)<br>    }<br>    .height(‘100%’)<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 3. HarmonyOS: How to control the position of a popped Menu?  </span><br><span class="line">When clicking a button to pop up a Menu, the position cannot be controlled—it sometimes appears below the button, sometimes on the left/right. To fix the Menu position, configure the `placement` attribute. For example, `Placement.BottomLeft` displays the Menu below the bound component with the left edge aligned.  </span><br><span class="line">Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ui-js-components-menu-V5#%E5%88%9B%E5%BB%BAmenu%E7%BB%84%E4%BB%B6  </span><br><span class="line"></span><br><span class="line">#### 4. HarmonyOS: How to generate an image from a View and save it to the album?  </span><br><span class="line">**Implementation Steps**:  </span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; 1. Poster layout<br>Column() {<br>  &#x2F;&#x2F; Top image<br>  this.renderImage(this.isHiresSong)</p>
<p>  &#x2F;&#x2F; Hi-Res quality label<br>  if (this.labelInfoJson !&#x3D;&#x3D; null || this.labelInfoJson !&#x3D;&#x3D; undefined) {<br>    this.renderHiresLabel()<br>  }</p>
<p>  &#x2F;&#x2F; Lyrics<br>  if (this.selectLyricList.length &gt; 0) {<br>    this.renderLyric()<br>  }</p>
<p>  &#x2F;&#x2F; Title and author<br>  this.renderTitleInfo(this.selectLyricList.length &gt; 0)</p>
<p>  &#x2F;&#x2F; Watermark and QR code<br>  this.renderWatermarkQrc()<br>}<br>.id(‘placard_layout’)<br>.backgroundColor(this.bgColor)<br>.margin({ top: ‘25vp’, bottom: ‘48vp’, left: ‘30vp’, right: ‘30vp’ })<br>.padding({ top: ‘16vp’, bottom: ‘16vp’, left: ‘16vp’, right: ‘16vp’ })</p>
<p>&#x2F;&#x2F; 2. Check permissions before saving (no permission needed for in-app storage)<br>&#x2F;&#x2F; Note: ohos.permission.WRITE_IMAGEVIDEO is a system_basic permission. Ordinary apps need ACL elevation.<br>let content: Context &#x3D; getContext(this)<br>let permissions: Array<Permissions> &#x3D; [‘ohos.permission.WRITE_IMAGEVIDEO’]<br>let atManager &#x3D; abilityAccessCtrl.createAtManager();<br>let promise &#x3D; atManager.requestPermissionsFromUser(content, permissions);<br>let rejectNum &#x3D; 0;<br>promise.then(async (data) &#x3D;&gt; {<br>  let grant: number[] &#x3D; data.authResults;<br>  let grantName: string[] &#x3D; data.permissions;<br>  for (let i &#x3D; 0; i &lt; grant.length; i++) {<br>    if (grant[i] !&#x3D;&#x3D; 0) {<br>      console.info(TAG, ‘user reject permission request ‘ + grantName[i]);<br>      rejectNum++;<br>    }<br>  }<br>  if (rejectNum &gt; 0) {<br>    promptAction.showToast({ message: ‘拒绝权限’ })<br>  } else {<br>    this.savePlacard()<br>  }<br>}).catch((err: Error) &#x3D;&gt; {<br>  console.error(TAG, ‘ requestPermissionsFromUser, error &#x3D; ‘ + err);<br>});</p>
<p>&#x2F;&#x2F; 3. Save the image<br>&#x2F;&#x2F; Capture the component screenshot via componentSnapshot.get(“placard_layout”), returning image.PixelMap<br>componentSnapshot.get(“placard_layout”)<br>  .then((pixmap: image.PixelMap) &#x3D;&gt; {<br>    this.pixmap &#x3D; pixmap;<br>    &#x2F;&#x2F; Choose storage method<br>    …<br>  })</p>
<p>&#x2F;&#x2F; 1) Save directly to app storage<br>image.createImagePacker().packing(pixmap, { format: “image&#x2F;jpeg”, quality: 98 })<br>  .then(((data: ArrayBuffer): void &#x3D;&gt; {<br>    let dir &#x3D; getContext().cacheDir<br>    let file &#x3D; fs.openSync(<code>$&#123;dir&#125;/xxx.jpg</code>, fs.OpenMode.WRITE_ONLY | fs.OpenMode.CREATE | fs.OpenMode.TRUNC)<br>    let len: number &#x3D; fs.writeSync(file.fd, data, { encoding: “utf-8” })<br>    console.log(<code>$&#123;len&#125;</code>)<br>  }))</p>
<p>&#x2F;&#x2F; 2) Use ohos.file.picker to open the system file manager for the user to select a save path, returning a URI<br>const photoSaveOptions &#x3D; new picker.PhotoSaveOptions();<br>photoSaveOptions.newFileNames &#x3D; [fileName + ‘.png’];<br>const photoViewPicker &#x3D; new picker.PhotoViewPicker();<br>photoViewPicker.save(photoSaveOptions)<br>  .then((photoSaveResult) &#x3D;&gt; {<br>    console.log(TAG, “photoSaveUri  photoSaveResult[0]” + JSON.stringify(photoSaveResult[0]))<br>    this.photoSaveUri &#x3D; photoSaveResult[0]<br>  })<br>  .catch((err:Error) &#x3D;&gt; {<br>    console.log(TAG, “photoSaveUri  fail” + JSON.stringify(err))<br>    promptAction.showToast({message:’保存失败’})<br>  })</p>
<p>&#x2F;&#x2F; 3) Save to the album via photoAccessHelper<br>let photoType &#x3D; photoAccessHelper.PhotoType.IMAGE;<br>let extension &#x3D; ‘jpg’;<br>const context &#x3D; getContext(this);<br>let phAccessHelper &#x3D; photoAccessHelper.getPhotoAccessHelper(context);</p>
<p>phAccessHelper.createAsset(photoType, extension, {<br>  title: fileName<br>}, (err, uri) &#x3D;&gt; {<br>  if (uri !&#x3D; undefined) {<br>    console.info(TAG + ‘createAsset uri’ + uri);<br>    this.photoSaveUri &#x3D; uri<br>    console.info(TAG + ‘createAsset successfully’);<br>  } else {<br>    console.error(TAG + ‘createAsset failed, message &#x3D; ‘, err);<br>  }<br>});</p>
<p>&#x2F;&#x2F; After creating the URI, perform file writing<br>pixmap: image.PixelMap | undefined &#x3D; undefined;<br>@State @Watch(“onPhotoSaveUriUpdate”) photoSaveUri: string &#x3D; ‘’;</p>
<p>&#x2F;&#x2F; Listen for URI updates to perform file read&#x2F;write operations<br>onPhotoSaveUriUpdate() {<br>  if (this.photoSaveUri) {<br>    console.error(TAG, ‘photoSaveUri is: ‘ + JSON.stringify(this.photoSaveUri));<br>    const imagePacker &#x3D; image.createImagePacker();<br>    if (this.pixmap &#x3D;&#x3D;&#x3D; undefined) {<br>      return<br>    }<br>    imagePacker.packing(this.pixmap, { format: “image&#x2F;jpeg”, quality: 100 })<br>      .then(data &#x3D;&gt; {<br>        let file &#x3D; fs.openSync(this.photoSaveUri, fs.OpenMode.WRITE_ONLY);<br>        fs.writeSync(file.fd, data);<br>        fs.closeSync(file);<br>        promptAction.showToast({<br>          message: ‘已成功保存至相册’,<br>          duration: 1000<br>        })<br>      })<br>      .catch((error: Error) &#x3D;&gt; {<br>        console.error(TAG, ‘Failed to pack the image. And the error is: ‘ + error);<br>      })<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 5. HarmonyOS: How does H5 communicate with HarmonyOS?  </span><br><span class="line">Refer to the document: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/web-app-page-data-channel-V5  </span><br><span class="line"></span><br><span class="line">Frontend pages and the app can use the `createWebMessagePorts()` API to create message ports for two-way communication.  </span><br><span class="line"></span><br><span class="line">**App-side code**:  </span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; xxx.ets<br>import { webview } from ‘@kit.ArkWeb’;<br>import { BusinessError } from ‘@kit.BasicServicesKit’;</p>
<p>@Entry<br>@Component<br>struct WebComponent {<br>  controller: webview.WebviewController &#x3D; new webview.WebviewController();<br>  ports: webview.WebMessagePort[] &#x3D; [];<br>  @State sendFromEts: string &#x3D; ‘Send this message from ets to HTML’;<br>  @State receivedFromHtml: string &#x3D; ‘Display received message send from HTML’;</p>
<p>  build() {<br>    Column() {<br>      Text(this.receivedFromHtml)<br>      TextInput({ placeholder: ‘Send this message from ets to HTML’ })<br>        .onChange((value: string) &#x3D;&gt; {<br>          this.sendFromEts &#x3D; value;<br>        })</p>
<pre><code>  Button(&#39;postMessage&#39;)
    .onClick(() =&gt; &#123;
      try &#123;
        this.ports = this.controller.createWebMessagePorts();
        this.ports[1].onMessageEvent((result: webview.WebMessage) =&gt; &#123;
          let msg = &#39;Got msg from HTML:&#39;;
          if (typeof (result) === &#39;string&#39;) &#123;
            console.info(`received string message from html5, string is: $&#123;result&#125;`);
            msg = msg + result;
          &#125; else if (typeof (result) === &#39;object&#39;) &#123;
            if (result instanceof ArrayBuffer) &#123;
              console.info(`received arraybuffer from html5, length is: $&#123;result.byteLength&#125;`);
              msg = msg + &#39;length is &#39; + result.byteLength;
            &#125; else &#123;
              console.info(&#39;not support&#39;);
            &#125;
          &#125; else &#123;
            console.info(&#39;not support&#39;);
          &#125;
          this.receivedFromHtml = msg;
        &#125;)
        this.controller.postMessage(&#39;__init_port__&#39;, [this.ports[0]], &#39;*&#39;);
      &#125; catch (error) &#123;
        console.error(`ErrorCode: $&#123;(error as BusinessError).code&#125;,  Message: $&#123;(error as BusinessError).message&#125;`);
      &#125;
    &#125;)

  Button(&#39;SendDataToHTML&#39;)
    .onClick(() =&gt; &#123;
      try &#123;
        if (this.ports &amp;&amp; this.ports[1]) &#123;
          this.ports[1].postMessageEvent(this.sendFromEts);
        &#125; else &#123;
          console.error(`ports is null, Please initialize first`);
        &#125;
      &#125; catch (error) &#123;
        console.error(`ErrorCode: $&#123;(error as BusinessError).code&#125;,  Message: $&#123;(error as BusinessError).message&#125;`);
      &#125;
    &#125;)
  Web(&#123; src: $rawfile(&#39;index.html&#39;), controller: this.controller &#125;)
&#125;
</code></pre>
<p>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**Frontend page code (index.html)**:  </span><br></pre></td></tr></table></figure>
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebView Message Port Demo</title>
</head>
<body>
    <h1>WebView Message Port Demo</h1>
    <div>
        <input type="button" value="SendToEts" onclick="PostMsgToEts(msgFromJS.value);"/><br/>
        <input id="msgFromJS" type="text" value="send this message from HTML to ets"/><br/>
    </div>
    <p class="output">display received message send from ets</p>
</body>
<script>
var h5Port;
var output = document.querySelector('.output');
window.addEventListener('message', function (event) {
    if (event.data === '__init_port__') {
        if (event.ports[0] !== null) {
            h5Port = event.ports[0];
            h5Port.onmessage = function (event) {
              var msg = 'Got message from ets:';
              var result = event.data;
              if (typeof(result) === 'string') {
                console.info(`received string message from html5, string is: ${result}`);
                msg = msg + result;
              } else if (typeof(result) === 'object') {
                if (result instanceof ArrayBuffer) {
                  console.info(`received arraybuffer from html5, length is: ${result.byteLength}`);
                  msg = msg + 'length is ' + result.byteLength;
                } else {
                  console.info('not support');
                }
              } else {
                console.info('not support');
              }
              output.innerHTML = msg;
            }
        }
    }
})
function PostMsgToEts(data) {
    if (h5Port) {
      h5Port.postMessage(data);
    } else {
      console.error('h5Port is null, Please initialize first');
    }
}
</script>
</html>
```
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/HarmonyOS-Next/" rel="tag"># HarmonyOS Next</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/06/29/4126-Daily-HarmonyOS-Next-Knowledge-Desktop-Shortcut-API-Swiper-Display-Anomalies-Page-Screenshot-Prevention-Tabs-Component-Show-Hide-Listening-PDF-Page-Turning-Callbacks/" rel="prev" title="[Daily HarmonyOS Next Knowledge] Desktop Shortcut API, Swiper Display Anomalies, Page Screenshot Prevention, Tabs Component Show/Hide Listening, PDF Page Turning Callbacks">
      <i class="fa fa-chevron-left"></i> [Daily HarmonyOS Next Knowledge] Desktop Shortcut API, Swiper Display Anomalies, Page Screenshot Prevention, Tabs Component Show/Hide Listening, PDF Page Turning Callbacks
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/06/29/4128-Daily-HarmonyOS-Next-Knowledge-Listening-for-Input-Box-Delete-Key-Network-Requests-Before-Page-Entry-Same-Layer-Rendering-GridCol-Left-Alignment-and-Custom-Popup-Gesture-Prevention/" rel="next" title="[Daily HarmonyOS Next Knowledge] Listening for Input Box Delete Key, Network Requests Before Page Entry, Same-Layer Rendering, GridCol Left Alignment, and Custom Popup Gesture Prevention">
      [Daily HarmonyOS Next Knowledge] Listening for Input Box Delete Key, Network Requests Before Page Entry, Same-Layer Rendering, GridCol Left Alignment, and Custom Popup Gesture Prevention <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Daily-HarmonyOS-Hext-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction"><span class="nav-number">1.</span> <span class="nav-text">[Daily HarmonyOS Hext Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-HarmonyOS-When-navigating-to-a-non-existent-URL-no-exception-is-thrown-and-it-jumps-to-a-blank-page"><span class="nav-number">1.0.0.1.</span> <span class="nav-text">1. HarmonyOS: When navigating to a non-existent URL, no exception is thrown, and it jumps to a blank page?</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">WebView Message Port Demo</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Qingkouwei</p>
  <div class="site-description" itemprop="description">Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">317</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingkouwei</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>

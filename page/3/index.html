<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harmonyostech.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:type" content="website">
<meta property="og:title" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:url" content="https://harmonyostech.github.io/page/3/index.html">
<meta property="og:site_name" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Qingkouwei">
<meta property="article:tag" content="HarmonyOSNext, HarmonyOS NEXT, HarmonyOS, Cangjie">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://harmonyostech.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>HarmonyOS NEXT Knowledge Charging Station</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HarmonyOS NEXT Knowledge Charging Station</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Analysis of Core Technologies and Application Scenarios of HarmonyOS NEXT</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4811-Learn-HarmonyOS-Next-Knowledge-Daily-Hotfix-Image-Preview-Performance-Issues-with-Multiple-State-Refreshes-etc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4811-Learn-HarmonyOS-Next-Knowledge-Daily-Hotfix-Image-Preview-Performance-Issues-with-Multiple-State-Refreshes-etc/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Daily] Hotfix, Image Preview, Performance Issues with Multiple @State Refreshes, etc.</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:16:49 / Modified: 17:17:06" itemprop="dateCreated datePublished" datetime="2025-06-30T17:16:49+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Daily-Hotfix-Image-Preview-Performance-Issues-with-Multiple-State-Refreshes-etc"><a href="#Learn-HarmonyOS-Next-Knowledge-Daily-Hotfix-Image-Preview-Performance-Issues-with-Multiple-State-Refreshes-etc" class="headerlink" title="[Learn HarmonyOS Next Knowledge Daily] Hotfix, Image Preview, Performance Issues with Multiple @State Refreshes, etc."></a>[Learn HarmonyOS Next Knowledge Daily] Hotfix, Image Preview, Performance Issues with Multiple @State Refreshes, etc.</h1><h2 id="1-Is-it-recommended-to-use-bm-quickfix-to-create-repair-packages"><a href="#1-Is-it-recommended-to-use-bm-quickfix-to-create-repair-packages" class="headerlink" title="1. Is it recommended to use bm quickfix to create repair packages?"></a>1. Is it recommended to use bm quickfix to create repair packages?</h2><p>The <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/bm-tool-V5#%E5%BF%AB%E9%80%9F%E4%BF%AE%E5%A4%8D">official document</a> shows the command for installing quick-fix patches: <code>bm quickfix -a -f /data/app/</code>, but two issues exist:  </p>
<ol>
<li>Documentation on how to create HQF files is missing.  </li>
<li>Is HQF a delta package between the new and old versions?<br><strong>Scenario</strong>: Can the bm quickfix command repair partial bugs during app runtime? Are there relevant reference documents?</li>
</ol>
<p><strong>Current recommendation</strong>: Manual creation of HQF packages is not recommended. Use the hot-reload capability instead: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hot-reload-0000001527628941-V5?catalogVersion=V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hot-reload-0000001527628941-V5?catalogVersion=V5</a>  </p>
<h2 id="2-How-to-implement-image-preview"><a href="#2-How-to-implement-image-preview" class="headerlink" title="2. How to implement image preview?"></a>2. How to implement image preview?</h2><p>How to implement clicking an image to enlarge it with pinch-to-zoom support?  </p>
<pre><code class="language-typescript">@Entry
@Component
struct Index &#123;
  @State visible: Visibility = Visibility.None
  @State scaleValue: number = 1
  @State pinchValue: number = 1
  @State pinchX: number = 0
  @State pinchY: number = 0
  @State count: number = 0
  @State offsetX: number = 0
  @State offsetY: number = 0
  @State positionX: number = 0
  @State positionY: number = 0

  build() &#123;
    Stack() &#123;
      Row() &#123;
        Column() &#123;
          Image($r(&#39;app.media.icon&#39;))
            .width(100)
            .height(100)
            .onClick(() =&gt; &#123;
              console.log(&quot;hit me!&quot;)
              if (this.visible == Visibility.Visible) &#123;
                this.visible = Visibility.None
              &#125; else &#123;
                this.visible = Visibility.Visible
              &#125;
            &#125;)
        &#125;
        .width(&#39;100%&#39;)
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
      &#125;
      .height(&#39;100%&#39;)


      Text(&#39;&#39;)
        .onClick(() =&gt; &#123;
          if (this.visible == Visibility.Visible) &#123;
            this.visible = Visibility.None
          &#125; else &#123;
            this.visible = Visibility.Visible
          &#125;
        &#125;)
        .width(&#39;100%&#39;)
        .height(&#39;100%&#39;)// Transparency can be adjusted
        .opacity(0.16)
        .backgroundColor(0x000000)
        .visibility(this.visible)

      Column() &#123;
        Image($r(&#39;app.media.icon&#39;))
          .width(300)
          .height(300)
          .draggable(false)
          .visibility(this.visible)
          .scale(&#123; x: this.scaleValue, y: this.scaleValue, z: 1 &#125;)
          .translate(&#123; x: this.offsetX, y: this.offsetY, z: 0 &#125;)
          .gesture(
            GestureGroup(GestureMode.Parallel,
              PinchGesture(&#123; fingers: 2 &#125;)
                .onActionStart((event?: GestureEvent) =&gt; &#123;
                  console.info(&#39;Pinch start&#39;)
                &#125;)
                .onActionUpdate((event?: GestureEvent) =&gt; &#123;
                  if (event) &#123;
                    this.scaleValue = this.pinchValue * event.scale
                    this.pinchX = event.pinchCenterX
                    this.pinchY = event.pinchCenterY
                  &#125;
                &#125;)
                .onActionEnd(() =&gt; &#123;
                  this.pinchValue = this.scaleValue
                  console.info(&#39;Pinch end&#39;)
                &#125;),

              PanGesture()
                .onActionUpdate((event?: GestureEvent) =&gt; &#123;
                  if (event) &#123;
                    this.offsetX = this.positionX + event.offsetX
                    this.offsetY = this.positionY + event.offsetY
                  &#125;
                  console.info(&#39;pan update&#39;)
                &#125;)
                .onActionEnd(() =&gt; &#123;
                  this.positionX = this.offsetX
                  this.positionY = this.offsetY
                  console.info(&#39;pan end&#39;)
                &#125;)
            )
          )
      &#125;
    &#125;
  &#125;
&#125;
</code></pre>
<h2 id="3-What-are-the-roles-of-netlost-and-netUnavailable-in-the-connection-module"><a href="#3-What-are-the-roles-of-netlost-and-netUnavailable-in-the-connection-module" class="headerlink" title="3. What are the roles of netlost and netUnavailable in the connection module?"></a>3. What are the roles of netlost and netUnavailable in the connection module?</h2><ul>
<li>The <code>netlost</code> event monitors network status loss, such as when Wi-Fi&#x2F;mobile network disconnects.  </li>
<li>The <code>netUnavailable</code> event monitors scenarios where the network is connected but abnormal, preventing normal browser access.</li>
</ul>
<h2 id="4-How-to-handle-installation-error-code-9568347-error-install-parse-native-so-failed"><a href="#4-How-to-handle-installation-error-code-9568347-error-install-parse-native-so-failed" class="headerlink" title="4. How to handle installation error code: 9568347, error: install parse native so failed?"></a>4. How to handle installation error code: 9568347, error: install parse native so failed?</h2><p>Refer to the official document for troubleshooting:<br><a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/bm-tool-V5#%E5%AE%89%E8%A3%85hap%E6%97%B6%E6%8F%90%E7%A4%BAcode9568347-error-install-parse-native-so-failed%E9%94%99%E8%AF%AF">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/bm-tool-V5#%E5%AE%89%E8%A3%85hap%E6%97%B6%E6%8F%90%E7%A4%BAcode9568347-error-install-parse-native-so-failed%E9%94%99%E8%AF%AF</a>  </p>
<h2 id="5-Will-batch-refreshing-multiple-State-variables-in-a-custom-component-affect-performance"><a href="#5-Will-batch-refreshing-multiple-State-variables-in-a-custom-component-affect-performance" class="headerlink" title="5. Will batch-refreshing multiple @State variables in a custom component affect performance?"></a>5. Will batch-refreshing multiple @State variables in a custom component affect performance?</h2><p>For example, a custom Component has 20 @State variables, each with defined update interfaces. If these States are batch-updated at a certain timing, will calling each State’s update interface cause frequent Component updates and performance issues?  </p>
<p>Batch-updating multiple State interfaces does not cause performance issues. Each @State is designed to update the UI, and modifying multiple States at once does not trigger repeated refreshes for the same component. Within one Vsync cycle, multiple dirt markings for the same component only trigger one refresh.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4807-Learn-HarmonyOS-Next-Knowledge-Daily-JSVM-API-Hotfix-Object-Unique-Hash-Value-Monitoring-VPN-Network-Changes-etc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4807-Learn-HarmonyOS-Next-Knowledge-Daily-JSVM-API-Hotfix-Object-Unique-Hash-Value-Monitoring-VPN-Network-Changes-etc/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Daily] JSVM-API, Hotfix, Object Unique Hash Value, Monitoring VPN Network Changes, etc.</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:15:19 / Modified: 17:15:51" itemprop="dateCreated datePublished" datetime="2025-06-30T17:15:19+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Daily-JSVM-API-Hotfix-Object-Unique-Hash-Value-Monitoring-VPN-Network-Changes-etc"><a href="#Learn-HarmonyOS-Next-Knowledge-Daily-JSVM-API-Hotfix-Object-Unique-Hash-Value-Monitoring-VPN-Network-Changes-etc" class="headerlink" title="[Learn HarmonyOS Next Knowledge Daily] JSVM-API, Hotfix, Object Unique Hash Value, Monitoring VPN Network Changes, etc."></a>[Learn HarmonyOS Next Knowledge Daily] JSVM-API, Hotfix, Object Unique Hash Value, Monitoring VPN Network Changes, etc.</h1><h2 id="1-How-to-Use-JSVM-API-Interfaces-to-Create-Multiple-Engines-for-Executing-JS-Code-and-Destroy-Them"><a href="#1-How-to-Use-JSVM-API-Interfaces-to-Create-Multiple-Engines-for-Executing-JS-Code-and-Destroy-Them" class="headerlink" title="1. How to Use JSVM-API Interfaces to Create Multiple Engines for Executing JS Code and Destroy Them?"></a>1. How to Use JSVM-API Interfaces to Create Multiple Engines for Executing JS Code and Destroy Them?</h2><p>Create a new JS basic runtime environment and obtain a CoreID through the <code>CreateJsCore</code> method:  </p>
<pre><code class="language-cpp">static napi_value CreateJsCore(napi_env env1, napi_callback_info info) &#123;
  OH_LOG_INFO(LOG_APP, &quot;JSVM CreateJsCore START&quot;);
  size_t argc = 1;
  napi_value argv[1];
  napi_get_cb_info(env1, info, &amp;argc, argv, nullptr, nullptr);
  if (argc &lt; 1) &#123;
    OH_LOG_ERROR(LOG_APP, &quot;JSVM CreateJsCore the number of params must be one&quot;);
    return nullptr;
  &#125;
  g_napiEnvMap[ENVTAG_NUMBER] = env1;
  g_taskQueueMap[ENVTAG_NUMBER] = deque&lt;Task *&gt;&#123;&#125;;
  // Store the callback function passed from the TS side in correspondence with env for subsequent calls
  napi_ref callFun;
  napi_create_reference(env1, argv[0], 1, &amp;callFun);
  g_callBackMap[ENVTAG_NUMBER] = callFun;
  napi_value coreID = 0;
  &#123;
    std::lock_guard&lt;std::mutex&gt; lock_guard(envMapLock);
    CreateArkJSContext();
    napi_create_uint32(env1, ENVTAG_NUMBER, &amp;coreID);
    ENVTAG_NUMBER++;
  &#125;
  OH_LOG_INFO(LOG_APP, &quot;JSVM CreateJsCore END&quot;);
  return coreID;
&#125;
</code></pre>
<p>Execute JS code using the runtime environment corresponding to CoreID through the <code>EvalUateJS</code> method:  </p>
<pre><code class="language-cpp">static napi_value EvalUateJS(napi_env env, napi_callback_info info) &#123;
  OH_LOG_INFO(LOG_APP, &quot;JSVM EvalUateJS START&quot;);
  size_t argc = 2;
  napi_value args[2] = &#123;nullptr&#125;;
  napi_get_cb_info(env, info, &amp;argc, args, nullptr, nullptr);
  uint32_t envId;
  napi_status status = napi_get_value_uint32(env, args[0], &amp;envId);
  if (status != napi_ok) &#123;
    OH_LOG_ERROR(LOG_APP, &quot;EvalUateJS first param should be number&quot;);
    return nullptr;
  &#125;

  if (g_envMap.count(envId) == 0 || g_envMap[envId] == nullptr) &#123;
    OH_LOG_ERROR(LOG_APP, &quot;EvalUateJS env is null&quot;);
    return nullptr;
  &#125;
  std::string dataStr = napiValueToString(env, args[1]);
  napi_value res = nullptr;
  std::lock_guard&lt;std::mutex&gt; lock_guard(mutexLock);
  &#123;
    // Open handle scope
    JSVM_HandleScope handlescope;
    OH_JSVM_OpenHandleScope(*g_envMap[envId], &amp;handlescope);
    // Compile js script
    JSVM_Value sourcecodevalue;
    OH_JSVM_CreateStringUtf8(*g_envMap[envId], dataStr.c_str(), dataStr.size(), &amp;sourcecodevalue);
    JSVM_Script script;
    OH_JSVM_CompileScript(*g_envMap[envId], sourcecodevalue, nullptr, 0, true, nullptr, &amp;script);
    // Run js script
    JSVM_Value result;
    OH_JSVM_RunScript(*g_envMap[envId], script, &amp;result);
    JSVM_ValueType type;
    OH_JSVM_Typeof(*g_envMap[envId], result, &amp;type);
    OH_LOG_INFO(LOG_APP, &quot;JSVM API TEST type: %&#123;public&#125;d&quot;, type);
    // Execute tasks in the current env event queue
    while (!g_taskQueueMap[envId].empty()) &#123;
      auto task = g_taskQueueMap[envId].front();
      g_taskQueueMap[envId].pop_front();
      task-&gt;Run();
      delete task;
    &#125;

    if (type == JSVM_STRING) &#123;
      std::string stdResult = fromOHStringValue(*g_envMap[envId], result);
      napi_create_string_utf8(env, stdResult.c_str(), stdResult.length(), &amp;res);
    &#125; else if (type == JSVM_BOOLEAN) &#123;
      bool ret = false;
      std::string stdResult;
      OH_JSVM_GetValueBool(*g_envMap[envId], result, &amp;ret);
      ret ? stdResult = &quot;true&quot; : stdResult = &quot;false&quot;;
      napi_create_string_utf8(env, stdResult.c_str(), stdResult.length(), &amp;res);
    &#125; else if (type == JSVM_NUMBER) &#123;
      int32_t num;
      OH_JSVM_GetValueInt32(*g_envMap[envId], result, &amp;num);
      std::string stdResult = std::to_string(num);
      napi_create_string_utf8(env, stdResult.c_str(), stdResult.length(), &amp;res);
    &#125; else if (type == JSVM_OBJECT) &#123;
      JSVM_Value objResult;
      OH_JSVM_JsonStringify(*g_envMap[envId], result, &amp;objResult);
      std::string stdResult = fromOHStringValue(*g_envMap[envId], objResult);
      napi_create_string_utf8(env, stdResult.c_str(), stdResult.length(), &amp;res);
    &#125;
    OH_JSVM_CloseHandleScope(*g_envMap[envId], handlescope);
  &#125;
  OH_LOG_INFO(LOG_APP, &quot;JSVM EvalUateJS END&quot;);
  return res;
&#125;
</code></pre>
<p>Release the runtime environment corresponding to CoreID through the <code>ReleaseJsCore</code> method:  </p>
<pre><code class="language-cpp">static napi_value ReleaseJsCore(napi_env env1, napi_callback_info info) &#123;
  OH_LOG_INFO(LOG_APP, &quot;JSVM ReleaseJsCore START&quot;);
  size_t argc = 1;
  napi_value argv[1];
  napi_get_cb_info(env1, info, &amp;argc, argv, nullptr, nullptr);
  if (argc &lt; 1) &#123;
    OH_LOG_ERROR(LOG_APP, &quot;JSVM ReleaseJsCore the number of params must be one&quot;);
    return nullptr;
  &#125;

  uint32_t coreEnvId;
  napi_status status = napi_get_value_uint32(env1, argv[0], &amp;coreEnvId);
  if (status != napi_ok) &#123;
    OH_LOG_ERROR(LOG_APP, &quot;JSVM CreateJsCore napi_get_value_uint32 faild&quot;);
    return nullptr;
  &#125;
  if (g_envMap.count(coreEnvId) == 0 ) &#123;
    OH_LOG_ERROR(LOG_APP, &quot;JSVM CreateJsCore not has env &quot;);
    return nullptr;
  &#125;
  if (g_envMap[coreEnvId] != nullptr) &#123;
    std::lock_guard&lt;std::mutex&gt; lock_guard(envMapLock);
    OH_JSVM_CloseEnvScope(*g_envMap[coreEnvId], g_envScopeMap[coreEnvId]);
    g_envScopeMap.erase(coreEnvId);
    OH_JSVM_DestroyEnv(*g_envMap[coreEnvId]);
    g_envMap[coreEnvId] = nullptr;
    g_envMap.erase(coreEnvId);
    OH_JSVM_CloseVMScope(*g_vmMap[coreEnvId], g_vmScopeMap[coreEnvId]);
    g_vmScopeMap.erase(coreEnvId);
    OH_JSVM_DestroyVM(*g_vmMap[coreEnvId]);
    g_vmMap[coreEnvId] = nullptr;
    g_vmMap.erase(coreEnvId);
    delete [] g_callBackStructMap[coreEnvId];
    g_callBackStructMap[coreEnvId] = nullptr;
    g_callBackStructMap.erase(coreEnvId);
    napi_delete_reference(env1, g_callBackMap[coreEnvId]);
    g_callBackMap.erase(coreEnvId);
    g_taskQueueMap.erase(coreEnvId);
  &#125;
  OH_LOG_INFO(LOG_APP, &quot;JSVM ReleaseJsCore END&quot;);
  return nullptr;
&#125;
</code></pre>
<h2 id="2-How-to-Handle-Error-Code-9568258-error-install-releaseType-not-same"><a href="#2-How-to-Handle-Error-Code-9568258-error-install-releaseType-not-same" class="headerlink" title="2. How to Handle Error Code 9568258: error:install releaseType not same?"></a>2. How to Handle Error Code 9568258: error:install releaseType not same?</h2><p>After upgrading the IDE, package installation consistently prompts code:9568258, error:install releaseType not same, even after formatting the phone. Suspected to be caused by HSP packages, but there are 14 HSP packages in the private repository, making a full rebuild impractical. Are there alternative solutions?  </p>
<p><strong>Method 1</strong>: Uninstall the previous HAP on the local device before reinstalling.<br><strong>Method 2</strong>: The issue arises from installing HAPs compiled with different SDK versions. Search for releasetype in the generated artifacts to check if the corresponding SDK value matches the current version.  </p>
<h2 id="3-How-to-Monitor-and-Determine-VPN-Type-Networks"><a href="#3-How-to-Monitor-and-Determine-VPN-Type-Networks" class="headerlink" title="3. How to Monitor and Determine VPN-Type Networks?"></a>3. How to Monitor and Determine VPN-Type Networks?</h2><p>The VPN type can be obtained using the <code>getNetCapabilities</code> method to get <code>bearerTypes</code>. When the value of <code>bearerTypes</code> is 4, it indicates a VPN is in use. Sample code:  </p>
<pre><code class="language-typescript">connection.getDefaultNet().then((netHandle: connection.NetHandle) =&gt; &#123;
  connection.getNetCapabilities(netHandle).then((data: connection.NetCapabilities) =&gt; &#123;
    const type: Number = data.bearerTypes[0];
    if (type === 4) &#123;
      console.info(&#39;is vpn&#39;);
    &#125;
  &#125;)
&#125;);
</code></pre>
<h2 id="4-How-to-Obtain-a-Unique-Identifier-Hash-Value-for-an-Object"><a href="#4-How-to-Obtain-a-Unique-Identifier-Hash-Value-for-an-Object" class="headerlink" title="4. How to Obtain a Unique Identifier (Hash Value) for an Object?"></a>4. How to Obtain a Unique Identifier (Hash Value) for an Object?</h2><p>Use the <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-util-V5#utilgethash12">util.getHash</a> interface:  </p>
<ul>
<li>For the first-time acquisition, calculate the Hash value and save it to the object’s Hash field (returns a random Hash value).  </li>
<li>For subsequent acquisitions, retrieve and return the Hash value from the Hash field (the same object returns a consistent value across multiple calls).</li>
</ul>
<h2 id="5-Is-It-Recommended-to-Use-bm-quickfix-to-Create-Repair-Packages"><a href="#5-Is-It-Recommended-to-Use-bm-quickfix-to-Create-Repair-Packages" class="headerlink" title="5. Is It Recommended to Use bm quickfix to Create Repair Packages?"></a>5. Is It Recommended to Use bm quickfix to Create Repair Packages?</h2><p>The <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/bm-tool-V5#%E5%BF%AB%E9%80%9F%E4%BF%AE%E5%A4%8D">reference document</a> shows the command for installing quick-fix patches: <code>bm quickfix -a -f /data/app/</code>. Two questions arise:  </p>
<ol>
<li>Documentation on how to create HQF files is missing.  </li>
<li>Is HQF a delta package between new and old versions? Scenario: Can the bm quickfix command be used to fix partial bugs during app runtime? Are there relevant reference documents?</li>
</ol>
<p><strong>Current Recommendation</strong>: Manual creation of HQF packages is not recommended. Instead, use the hot-reload capability: <a target="_blank" rel="noopener" href="https://link.segmentfault.com/?enc=Gi2XNg57BafRnYTjEImzbQ==.zvgzN8qZZsT1TUA0+Bk1CCIzj/9nOZBE+nRf+34SIzE/+W6vwh2OxV5h6xMsBIUGXqdh6zk7xyCEDk8S1d9+8jVozpppBlQyoCs/0zMQEIMZ7goF6obk1W3eb5Z3MNDX/67NDVt3M2sa2R5E4cJ54peh1/xEZI2d+VefeSa3pqk=">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hot-reload-0000001527628941-V5?catalogVersion=V5</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4806-Learn-HarmonyOS-Next-Knowledge-Daily-Debugging-Network-Caching-Rich-Text-Editing-etc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4806-Learn-HarmonyOS-Next-Knowledge-Daily-Debugging-Network-Caching-Rich-Text-Editing-etc/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Daily] Debugging, Network, Caching, Rich Text Editing, etc.</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:14:06 / Modified: 17:14:23" itemprop="dateCreated datePublished" datetime="2025-06-30T17:14:06+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Daily-Debugging-Network-Caching-Rich-Text-Editing-etc"><a href="#Learn-HarmonyOS-Next-Knowledge-Daily-Debugging-Network-Caching-Rich-Text-Editing-etc" class="headerlink" title="[Learn HarmonyOS Next Knowledge Daily] Debugging, Network, Caching, Rich Text Editing, etc."></a>[Learn HarmonyOS Next Knowledge Daily] Debugging, Network, Caching, Rich Text Editing, etc.</h1><h2 id="1-How-to-Use-a-Release-Certificate-for-Debugging"><a href="#1-How-to-Use-a-Release-Certificate-for-Debugging" class="headerlink" title="1. How to Use a Release Certificate for Debugging?"></a>1. How to Use a Release Certificate for Debugging?</h2><p>Since some functions require certificate information verification, debugging needs to be performed using both a debug certificate and a release certificate. However, after using the release certificate, an installation error occurs:<br><code>05/14 19:04:39: Install Failed: error: failed to install bundle.code:9568322error: signature verification failed due to not trusted app source.View detailed instructions.$ hdc shell rm -rf data/local/tmp/c07053e4cafe4f06bbbfecc3c2a697bbError while Deploy Hap.</code>  </p>
<p><strong>Specification Issue</strong>: Release certificates published on the AppGallery cannot be installed through non-AppGallery channels.<br><strong>Solution</strong>: For testing release certificate applications, consider using AGC-&gt;Open Testing.  </p>
<h2 id="2-Is-netBearType-Defined-as-an-Array-Type-in-the-Documentation-the-Current-Specification"><a href="#2-Is-netBearType-Defined-as-an-Array-Type-in-the-Documentation-the-Current-Specification" class="headerlink" title="2. Is netBearType Defined as an Array Type in the Documentation the Current Specification?"></a>2. Is netBearType Defined as an Array Type in the Documentation the Current Specification?</h2><p>In scenarios where both Wi-Fi and cellular networks are connected (dual-mode), the netBearType parameter only returns the status information of Wi-Fi. The array type definition is the current specification to handle multiple calling scenarios.  </p>
<h2 id="3-How-to-Make-RichEditor-and-a-Component-a-Whole-for-Adaptive-Scrolling-Based-on-Cursor-Position"><a href="#3-How-to-Make-RichEditor-and-a-Component-a-Whole-for-Adaptive-Scrolling-Based-on-Cursor-Position" class="headerlink" title="3. How to Make RichEditor and a Component a Whole for Adaptive Scrolling Based on Cursor Position?"></a>3. How to Make RichEditor and a Component a Whole for Adaptive Scrolling Based on Cursor Position?</h2><p>There is a Component above RichEditor, and the goal is to make RichEditor and the Component a whole that can scroll adaptively based on the cursor position. Currently, using a Scroller cannot obtain the specific coordinates of the cursor in RichEditor (cursor x and y positions relative to RichEditor), making scrolling impossible.  </p>
<p><strong>Solution</strong>: Wrap RichEditor and the Component with a Scroll component. Use the onAreaChange callback to call scroller.scrollBy to adjust the height of the scrolling component.  </p>
<p><strong>Reference Code</strong>:  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  editorController = <span class="keyword">new</span> <span class="title class_">RichEditorController</span>()</span><br><span class="line">  <span class="attr">scroller</span>: <span class="title class_">Scroller</span> = <span class="keyword">new</span> <span class="title class_">Scroller</span>()</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Scroll</span>(<span class="variable language_">this</span>.<span class="property">scroller</span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="title class_">Image</span>($r(<span class="string">&#x27;app.media.startIcon&#x27;</span>))</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">200</span>)</span><br><span class="line">            .<span class="title function_">margin</span>(&#123; <span class="attr">bottom</span>: <span class="number">20</span> &#125;)</span><br><span class="line">          <span class="title class_">RichEditor</span>(&#123; <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">editorController</span> &#125;)</span><br><span class="line">            .<span class="title function_">id</span>(<span class="string">&#x27;RichEditor&#x27;</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Yellow</span>)</span><br><span class="line">            .<span class="title function_">onReady</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">editorController</span>.<span class="title function_">addImageSpan</span>($r(<span class="string">&quot;app.media.startIcon&quot;</span>),</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">imageStyle</span>:</span><br><span class="line">                  &#123;</span><br><span class="line">                    <span class="attr">size</span>: [<span class="string">&quot;100px&quot;</span>, <span class="string">&quot;100px&quot;</span>]</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">editorController</span>.<span class="title function_">addTextSpan</span>(<span class="string">&#x27;男生女生向前冲&#x27;</span>,</span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="attr">style</span>:</span><br><span class="line">                  &#123;</span><br><span class="line">                    <span class="attr">fontColor</span>: <span class="title class_">Color</span>.<span class="property">Blue</span>,</span><br><span class="line">                    <span class="attr">fontSize</span>: <span class="number">30</span></span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">onAreaChange</span>(<span class="function">(<span class="params">_, value</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (_.<span class="property">height</span> !== value.<span class="property">height</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">scroller</span>.<span class="title function_">scrollBy</span>(<span class="number">0</span>, <span class="title class_">Number</span>(value.<span class="property">height</span>) - <span class="number">200</span>)</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---_.height&#x27;</span>, _.<span class="property">height</span>)</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;---value.height&#x27;</span>, value.<span class="property">height</span>)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          <span class="title class_">Button</span>(<span class="string">&#x27;getSpans-文字&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">(<span class="params"><span class="attr">event</span>: <span class="title class_">ClickEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> getSpans = <span class="variable language_">this</span>.<span class="property">editorController</span>.<span class="title function_">getSpans</span>(&#123; <span class="attr">start</span>: <span class="number">0</span> &#125;)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;getSpans0&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(getSpans[<span class="number">0</span>]))</span><br><span class="line">            <span class="comment">// Strong casting is required to obtain text or image information</span></span><br><span class="line">            <span class="keyword">let</span> span0 = getSpans[<span class="number">0</span>] <span class="keyword">as</span> <span class="title class_">RichEditorTextSpanResult</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Text-related information: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(span0))</span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="title class_">Button</span>(<span class="string">&#x27;getSpans-图片&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">(<span class="params"><span class="attr">event</span>: <span class="title class_">ClickEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> getSpans = <span class="variable language_">this</span>.<span class="property">editorController</span>.<span class="title function_">getSpans</span>(&#123; <span class="attr">start</span>: <span class="number">0</span> &#125;)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;getSpans1&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(getSpans[<span class="number">1</span>]))</span><br><span class="line">            <span class="keyword">let</span> span1 = getSpans[<span class="number">1</span>] <span class="keyword">as</span> <span class="title class_">RichEditorImageSpanResult</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Image-related information: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(span1))</span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="title class_">Button</span>(<span class="string">&#x27;RichEditor获焦&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            focusControl.<span class="title function_">requestFocus</span>(<span class="string">&#x27;RichEditor&#x27;</span>)</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">scrollable</span>(<span class="title class_">ScrollDirection</span>.<span class="property">Vertical</span>) <span class="comment">// Vertical scrolling direction</span></span><br><span class="line">      .<span class="title function_">scrollBar</span>(<span class="title class_">BarState</span>.<span class="property">On</span>) <span class="comment">// Scrollbar always visible</span></span><br><span class="line">      .<span class="title function_">scrollBarColor</span>(<span class="title class_">Color</span>.<span class="property">Gray</span>) <span class="comment">// Scrollbar color</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 4. Why Do Performance Issues Occur When Storing Complex Objects in LocalStorage or APPStorage?  </span></span><br><span class="line"><span class="string">Two questions about performance issues when storing complex objects in LocalStorage and APPStorage:  </span></span><br><span class="line"><span class="string">1. **Frequent Reading/Writing**: Why does frequent reading/writing of complex objects degrade page performance? Does LocalStorage affect page rendering?  </span></span><br><span class="line"><span class="string">2. **Data Structure**: Are data stored locally in LocalStorage and APPStorage? They should be in memory—why does serialization/deserialization occur?  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Answers**:  </span></span><br><span class="line"><span class="string">- LocalStorage operations are synchronous. When reading/writing, the program blocks until the operation completes, which affects refresh efficiency, especially for complex objects.  </span></span><br><span class="line"><span class="string">- LocalStorage and APPStorage do not serialize complex objects when reading them locally.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 5. Error When Using Synchronous Methods to Get Network Status in a No-Network Environment?  </span></span><br><span class="line"><span class="string">In a no-network environment, calling synchronous methods cannot parse the corresponding nethandle content, and an error occurs when the method internally executes getCap. Use try-catch to get the error information:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> netHandle = connection.<span class="title function_">getDefaultNetSync</span>();</span><br><span class="line">  <span class="keyword">let</span> connectionproperties = connection.<span class="title function_">getConnectionPropertiesSync</span>(netHandle);</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;error: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4805-Learn-HarmonyOS-Next-Knowledge-Daily-Package-Size-Optimization-WebView-PDF-Download-etc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4805-Learn-HarmonyOS-Next-Knowledge-Daily-Package-Size-Optimization-WebView-PDF-Download-etc/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Daily] Package Size Optimization, WebView PDF Download, etc.</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:12:22 / Modified: 17:13:24" itemprop="dateCreated datePublished" datetime="2025-06-30T17:12:22+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Daily-Package-Size-Optimization-WebView-PDF-Download-etc"><a href="#Learn-HarmonyOS-Next-Knowledge-Daily-Package-Size-Optimization-WebView-PDF-Download-etc" class="headerlink" title="[Learn HarmonyOS Next Knowledge Daily] Package Size Optimization, WebView PDF Download, etc."></a>[Learn HarmonyOS Next Knowledge Daily] Package Size Optimization, WebView PDF Download, etc.</h1><h2 id="1-How-to-Configure-Package-Size-Optimization-for-Large-Packaging"><a href="#1-How-to-Configure-Package-Size-Optimization-for-Large-Packaging" class="headerlink" title="1. How to Configure Package Size Optimization for Large Packaging?"></a>1. How to Configure Package Size Optimization for Large Packaging?</h2><p><strong>Problem Scenario:</strong><br>The package size of a program containing SO libraries is excessively large after packaging, exceeding expectations.  </p>
<p><strong>Reference Response:</strong>  </p>
<ol>
<li><strong>Check the packaging type first</strong>: Debug compilation includes debugging information, making the package larger than the release version. You can reduce the SO size by configuring <code>&quot;strip&quot;: true</code> to remove debug information from SO files. This configuration should be applied to both HAP and HSP modules, and works for both release and debug modes. Refer to the <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-cpp-0000001733922376-V5">configuration guide</a>:</li>
</ol>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;nativeLib&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;debugSymbol&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="comment">// This configuration strips debug information and symbol tables from compiled C++ SO files</span></span><br><span class="line">    <span class="attr">&quot;strip&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// Enable stripping</span></span><br><span class="line">    <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span> <span class="comment">// Regular expression rules for stripping exclusions</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> **Compress SO libraries**<span class="punctuation">:</span> By default<span class="punctuation">,</span> DevEco Studio does not compress SO files during packaging. Enabling the SO compression option will package SO files in a compressed format<span class="punctuation">,</span> reducing the app package size. Modify the `compressNativeLibs` field in the module configuration file `module.json5` to `<span class="literal"><span class="keyword">true</span></span>`<span class="punctuation">,</span> then recompile and package the app<span class="punctuation">:</span>  </span><br><span class="line">```json</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">&quot;compressNativeLibs&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span> <span class="comment">// Indicate that libs should be packaged in compressed storage mode</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">2.</span> PDF Download and Preview Based on WebDownloadDelegate  </span><br><span class="line">First<span class="punctuation">,</span> use the web page interception interface `onInterceptRequest` to determine if the PDF needs to be downloaded and viewed. The identifier is whether the URL&#x27;s response header contains the `Content-Disposition` attribute<span class="punctuation">,</span> such as `<span class="string">&quot;attachment; filename=XXXX.pdf&quot;</span>`.  </span><br><span class="line">```typescript</span><br><span class="line">try <span class="punctuation">&#123;</span></span><br><span class="line">  if (event) <span class="punctuation">&#123;</span></span><br><span class="line">    const webResponse = new WebResourceResponse();</span><br><span class="line">    let url = event.request.getRequestUrl()</span><br><span class="line">    let headers = event.request.getRequestHeader()</span><br><span class="line">    if(headers<span class="punctuation">[</span>&#x27;content-disposition&#x27;<span class="punctuation">]</span>)<span class="punctuation">&#123;</span></span><br><span class="line">      AlertDialog.show(<span class="punctuation">&#123;</span></span><br><span class="line">        title<span class="punctuation">:</span> &#x27;File Download&#x27;<span class="punctuation">,</span> cancel<span class="punctuation">:</span> () =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">          console.log(&#x27;Cancel download&#x27;);</span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        message<span class="punctuation">:</span> &#x27;Download now?&#x27;<span class="punctuation">,</span> confirm<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          value<span class="punctuation">:</span> &#x27;Confirm&#x27;<span class="punctuation">,</span> action<span class="punctuation">:</span> () =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">            this.setDownloadDelegate()</span><br><span class="line">            this.controller.startDownload(&#x27;https<span class="punctuation">:</span><span class="comment">//example.com&#x27;);</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#125;</span>)</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">To preview the PDF after download<span class="punctuation">,</span> use the `startDownload()` interface to initiate a download task<span class="punctuation">,</span> which will notify the app of the download progress via the configured `DownloadDelegate`. First<span class="punctuation">,</span> register a `DownloadDelegate` with the Web component using `setDownloadDelegate()` to listen for download tasks triggered by the page. The Web component handles the download and notifies the app of the progress through `DownloadDelegate`<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">setDownloadDelegate() <span class="punctuation">&#123;</span></span><br><span class="line">  try <span class="punctuation">&#123;</span></span><br><span class="line">    this.delegate.onBeforeDownload((webDownloadItem<span class="punctuation">:</span> web_webview.WebDownloadItem) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">      console.log(&#x27;Will start a download&#x27;);</span><br><span class="line">      <span class="comment">// Specify a download path (sandbox path) and start downloading</span></span><br><span class="line">      webDownloadItem.start((getContext(this) as common.UIAbilityContext).filesDir + &#x27;/test.pdf&#x27;);</span><br><span class="line">    <span class="punctuation">&#125;</span>)</span><br><span class="line">    <span class="comment">// Callback during download, providing progress information</span></span><br><span class="line">    this.delegate.onDownloadUpdated((webDownloadItem<span class="punctuation">:</span> web_webview.WebDownloadItem) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">      console.log(&#x27;Download update guid<span class="punctuation">:</span> &#x27; + webDownloadItem.getGuid());</span><br><span class="line">    <span class="punctuation">&#125;</span>)</span><br><span class="line">    <span class="comment">// Notification for download failure</span></span><br><span class="line">    this.delegate.onDownloadFailed((webDownloadItem<span class="punctuation">:</span> web_webview.WebDownloadItem) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">      console.log(&#x27;Download failed guid<span class="punctuation">:</span> &#x27; + webDownloadItem.getGuid());</span><br><span class="line">    <span class="punctuation">&#125;</span>)</span><br><span class="line">    <span class="comment">// Notification for download completion</span></span><br><span class="line">    this.delegate.onDownloadFinish(async (webDownloadItem<span class="punctuation">:</span> web_webview.WebDownloadItem) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">      console.log(&#x27;Download finish guid<span class="punctuation">:</span> &#x27; + webDownloadItem.getGuid());</span><br><span class="line">      let file = fs.statSync((getContext(this) as common.UIAbilityContext).filesDir + &#x27;/test.pdf&#x27;)</span><br><span class="line">      console.log(&#x27;testTag - size<span class="punctuation">:</span> &#x27; + file.size + &#x27;path<span class="punctuation">:</span>&#x27;);</span><br><span class="line">    <span class="punctuation">&#125;</span>)</span><br><span class="line">    let fileuri = &#x27;file<span class="punctuation">:</span><span class="comment">//’ + (getContext(this) as common.UIAbilityContext).filesDir + ‘/test.pdf&#x27;</span></span><br><span class="line">    console.log(&#x27;testTag - &#x27; + fileuri);</span><br><span class="line">    this.controller.setDownloadDelegate(this.delegate);</span><br><span class="line">    web_webview.WebDownloadManager.setDownloadDelegate(this.delegate)</span><br><span class="line">    this.controller.loadUrl(fileuri)</span><br><span class="line">  <span class="punctuation">&#125;</span> catch (error) <span class="punctuation">&#123;</span></span><br><span class="line">    console.log(JSON.stringify(error))</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">If download is unnecessary<span class="punctuation">,</span> create an HTTP task using `http.createHttp()`<span class="punctuation">,</span> then initiate an HTTP request with `request`. Set custom response data in the asynchronous callback<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">let httpRequest = http.createHttp();</span><br><span class="line">let promise = httpRequest.request(url<span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">  method<span class="punctuation">:</span> http.RequestMethod.GET<span class="punctuation">,</span></span><br><span class="line">  connectTimeout<span class="punctuation">:</span> <span class="number">60000</span><span class="punctuation">,</span></span><br><span class="line">  readTimeout<span class="punctuation">:</span> <span class="number">60000</span><span class="punctuation">,</span></span><br><span class="line">  header<span class="punctuation">:</span> headers</span><br><span class="line"><span class="punctuation">&#125;</span>);</span><br><span class="line">promise.then((data<span class="punctuation">:</span> http.HttpResponse) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">  let result = data?.result as ArrayBuffer</span><br><span class="line">  webResponse.setResponseCode(<span class="number">200</span>);</span><br><span class="line">  webResponse.setReasonMessage(&#x27;OK&#x27;);</span><br><span class="line">  webResponse.setResponseData(result);</span><br><span class="line">  webResponse.setResponseEncoding(&#x27;UTF_8&#x27;)</span><br><span class="line"><span class="punctuation">&#125;</span>).catch((err<span class="punctuation">:</span> Error) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">  console.info(&#x27;error<span class="punctuation">:</span>&#x27; + JSON.stringify(err));</span><br><span class="line"><span class="punctuation">&#125;</span>);</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">3.</span> Project Compilation Error<span class="punctuation">:</span> TypeError<span class="punctuation">:</span> Cannot read properties of undefined (reading &#x27;newFileToResourceList&#x27;)  </span><br><span class="line"><span class="number">1.</span> **Enable detailed logging**<span class="punctuation">:</span> Uncomment the `logging` section in `hvigor/hvigor-config.json5` and set `level` to `debug`. Uncomment the `debugging` section and set `stacktrace` to `<span class="literal"><span class="keyword">true</span></span>` to see the specific error location during compilation.  </span><br><span class="line"><span class="number">2.</span> **Modify system file code**<span class="punctuation">:</span> If the error occurs in `collectResourceInFile`<span class="punctuation">,</span> add a log line to the specific error file<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">collectResourceInFile(e<span class="punctuation">,</span> t) <span class="punctuation">&#123;</span></span><br><span class="line">  if (!this.wholeFileInfo<span class="punctuation">[</span>t<span class="punctuation">]</span>) <span class="punctuation">&#123;</span></span><br><span class="line">    console.log(&#x27;info&#x27; + t);</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  this.wholeFileInfo<span class="punctuation">[</span>t<span class="punctuation">]</span>.newFileToResourceList.add(e)</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"><span class="number">3.</span> **Recompile** to view the printed error file location in the build output. Check for yellow warnings in import/export paths (common issues include case sensitivity and missing paths).  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">4.</span> Does Asynchrony Affect the Main Thread?  </span><br><span class="line">**Problem Description**<span class="punctuation">:</span>  </span><br><span class="line"><span class="number">1.</span> Is `setInterval` executed asynchronously? Does frequent timing via `setInterval` affect the main thread and screen refresh rate?  </span><br><span class="line"><span class="number">2.</span> How to independently determine if an interface is asynchronous?  </span><br><span class="line"><span class="number">3.</span> How to check if a task is running on the main thread or another thread?  </span><br><span class="line"></span><br><span class="line">**Solutions**<span class="punctuation">:</span>  </span><br><span class="line"><span class="number">1.</span> **`setInterval` is asynchronous**. Its impact on the main thread depends on the callback logic<span class="punctuation">:</span>  </span><br><span class="line">   - Minor data processing<span class="punctuation">:</span> Minimal impact.  </span><br><span class="line">   - Heavy data processing<span class="punctuation">:</span> Use `worker` or `taskpool`.  </span><br><span class="line">   - Frequent UI data updates<span class="punctuation">:</span> May affect the main thread<span class="punctuation">,</span> as rendering occurs on the main thread.  </span><br><span class="line"><span class="number">2.</span> **Asynchronous interfaces in HarmonyOS** are implemented via `Promise` and `async/await`. Refer to the <span class="punctuation">[</span>Asynchronous Concurrency Overview (Promise and async/await)<span class="punctuation">]</span>(https<span class="punctuation">:</span><span class="comment">//developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/async-concurrency-overview-V5?catalogVersion=V5).  </span></span><br><span class="line"><span class="number">3.</span> **Check thread type** by comparing thread IDs<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">function isMainThread()<span class="punctuation">:</span> boolean <span class="punctuation">&#123;</span></span><br><span class="line">  return process.pid === process.tid;</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">5.</span> How to Switch Root Views in an HSP Module?  </span><br><span class="line">To switch root views in an HSP module<span class="punctuation">,</span> obtain the `WindowStage` of the program entry and use it for switching. Refer to the sample code<span class="punctuation">:</span>  </span><br><span class="line"></span><br><span class="line">**HspPage Index Code**<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">import <span class="punctuation">&#123;</span> window <span class="punctuation">&#125;</span> from &#x27;@kit.ArkUI&#x27;;</span><br><span class="line"></span><br><span class="line">@Entry(<span class="punctuation">&#123;</span> routeName<span class="punctuation">:</span> <span class="string">&quot;HspPage&quot;</span> <span class="punctuation">&#125;</span>)</span><br><span class="line">@Component</span><br><span class="line">struct Index <span class="punctuation">&#123;</span></span><br><span class="line">  @State message<span class="punctuation">:</span> string = &#x27;This is Hsp Page&#x27;;</span><br><span class="line">  @State windowStage<span class="punctuation">:</span> window.WindowStage | undefined = AppStorage.get&lt;window.WindowStage&gt;(<span class="string">&quot;windowStage&quot;</span>)</span><br><span class="line"></span><br><span class="line">  build() <span class="punctuation">&#123;</span></span><br><span class="line">    Row() <span class="punctuation">&#123;</span></span><br><span class="line">      Column() <span class="punctuation">&#123;</span></span><br><span class="line">        Text(this.message)</span><br><span class="line">          .fontSize(<span class="number">50</span>)</span><br><span class="line">          .fontWeight(FontWeight.Bold)</span><br><span class="line">          .onClick(() =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">            if (this.windowStage) <span class="punctuation">&#123;</span></span><br><span class="line">              this.windowStage.getMainWindowSync()</span><br><span class="line">                .getUIContext()</span><br><span class="line">                .getRouter()</span><br><span class="line">                .pushUrl(<span class="punctuation">&#123;</span></span><br><span class="line">                  url<span class="punctuation">:</span> <span class="string">&quot;pages/Page&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span>)</span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">&#125;</span>)</span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">      .width(&#x27;<span class="number">100</span>%&#x27;)</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    .height(&#x27;<span class="number">100</span>%&#x27;)</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">**Root Page <span class="number">1</span>**<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">import <span class="punctuation">&#123;</span> router <span class="punctuation">&#125;</span> from &#x27;@kit.ArkUI&#x27;;</span><br><span class="line"></span><br><span class="line">import(<span class="string">&quot;lib1/src/main/ets/pages/Index&quot;</span>)</span><br><span class="line"></span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line">struct Index <span class="punctuation">&#123;</span></span><br><span class="line">  @State message<span class="punctuation">:</span> string = &#x27;Hello World&#x27;;</span><br><span class="line"></span><br><span class="line">  build() <span class="punctuation">&#123;</span></span><br><span class="line">    RelativeContainer() <span class="punctuation">&#123;</span></span><br><span class="line">      Text(this.message)</span><br><span class="line">        .id(&#x27;HelloWorld&#x27;)</span><br><span class="line">        .fontSize(<span class="number">50</span>)</span><br><span class="line">        .fontWeight(FontWeight.Bold)</span><br><span class="line">        .alignRules(<span class="punctuation">&#123;</span></span><br><span class="line">          center<span class="punctuation">:</span> <span class="punctuation">&#123;</span> anchor<span class="punctuation">:</span> &#x27;container&#x27;<span class="punctuation">,</span> align<span class="punctuation">:</span> VerticalAlign.Center <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          middle<span class="punctuation">:</span> <span class="punctuation">&#123;</span> anchor<span class="punctuation">:</span> &#x27;container&#x27;<span class="punctuation">,</span> align<span class="punctuation">:</span> HorizontalAlign.Center <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span>)</span><br><span class="line">        .onClick(() =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">          console.log(<span class="string">&quot;Clicked&quot;</span>)</span><br><span class="line">          router.pushNamedRoute(<span class="punctuation">&#123;</span></span><br><span class="line">            name<span class="punctuation">:</span> <span class="string">&quot;HspPage&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span>)</span><br><span class="line">        <span class="punctuation">&#125;</span>)</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    .height(&#x27;<span class="number">100</span>%&#x27;)</span><br><span class="line">    .width(&#x27;<span class="number">100</span>%&#x27;)</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">**Root Page <span class="number">2</span>**<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">import <span class="punctuation">&#123;</span> router <span class="punctuation">&#125;</span> from &#x27;@kit.ArkUI&#x27;;</span><br><span class="line"></span><br><span class="line">import(<span class="string">&quot;lib1/src/main/ets/pages/Index&quot;</span>)</span><br><span class="line"></span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line">struct Index <span class="punctuation">&#123;</span></span><br><span class="line">  @State message<span class="punctuation">:</span> string = &#x27;Hello World&#x27;;</span><br><span class="line"></span><br><span class="line">  build() <span class="punctuation">&#123;</span></span><br><span class="line">    RelativeContainer() <span class="punctuation">&#123;</span></span><br><span class="line">      Text(this.message)</span><br><span class="line">        .id(&#x27;HelloWorld&#x27;)</span><br><span class="line">        .fontSize(<span class="number">50</span>)</span><br><span class="line">        .fontWeight(FontWeight.Bold)</span><br><span class="line">        .alignRules(<span class="punctuation">&#123;</span></span><br><span class="line">          center<span class="punctuation">:</span> <span class="punctuation">&#123;</span> anchor<span class="punctuation">:</span> &#x27;container&#x27;<span class="punctuation">,</span> align<span class="punctuation">:</span> VerticalAlign.Center <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          middle<span class="punctuation">:</span> <span class="punctuation">&#123;</span> anchor<span class="punctuation">:</span> &#x27;container&#x27;<span class="punctuation">,</span> align<span class="punctuation">:</span> HorizontalAlign.Center <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span>)</span><br><span class="line">        .onClick(() =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">          console.log(<span class="string">&quot;Clicked&quot;</span>)</span><br><span class="line">          router.pushNamedRoute(<span class="punctuation">&#123;</span></span><br><span class="line">            name<span class="punctuation">:</span> <span class="string">&quot;HspPage&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span>)</span><br><span class="line">        <span class="punctuation">&#125;</span>)</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    .height(&#x27;<span class="number">100</span>%&#x27;)</span><br><span class="line">    .width(&#x27;<span class="number">100</span>%&#x27;)</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4804-Learn-HarmonyOS-Next-Knowledge-Every-Day-Push-and-UI-Layout/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4804-Learn-HarmonyOS-Next-Knowledge-Every-Day-Push-and-UI-Layout/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Every Day] Push and UI Layout</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:10:41 / Modified: 17:38:18" itemprop="dateCreated datePublished" datetime="2025-06-30T17:10:41+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Every-Day-Push-and-UI-Layout"><a href="#Learn-HarmonyOS-Next-Knowledge-Every-Day-Push-and-UI-Layout" class="headerlink" title="[Learn HarmonyOS Next Knowledge Every Day] Push and UI Layout"></a>[Learn HarmonyOS Next Knowledge Every Day] Push and UI Layout</h1><h2 id="1-How-to-avoid-displaying-intermediate-transition-tab-pages-when-switching-Tab-component-pages"><a href="#1-How-to-avoid-displaying-intermediate-transition-tab-pages-when-switching-Tab-component-pages" class="headerlink" title="1. How to avoid displaying intermediate transition tab pages when switching Tab component pages?"></a>1. How to avoid displaying intermediate transition tab pages when switching Tab component pages?</h2><p>Currently, when clicking on a tab page across multiple pages, intermediate transition pages are displayed.  </p>
<p>If animations are required, the specification mandates transitioning through pages 1, 2, 3, 4 sequentially. To hide intermediate transition pages, set <code>.animationDuration(0)</code>.  </p>
<p><strong>Reference Code:</strong>  </p>
<pre><code class="language-typescript">// xxx.ets
@Entry
@Component
struct TabsExample &#123;
  @State fontColor: string = &#39;#182431&#39;
  @State selectedFontColor: string = &#39;#007DFF&#39;
  @State currentIndex: number = 0
  private controller: TabsController = new TabsController()

  @Builder
  tabBuilder(index: number, name: string) &#123;
    Column() &#123;
      Text(name)
        .fontColor(this.currentIndex === index ? this.selectedFontColor : this.fontColor)
        .fontSize(16)
        .fontWeight(this.currentIndex === index ? 500 : 400)
        .lineHeight(22)
        .margin(&#123; top: 17, bottom: 7 &#125;)
      Divider()
        .strokeWidth(2)
        .color(&#39;#007DFF&#39;)
        .opacity(this.currentIndex === index ? 1 : 0)
    &#125;.width(&#39;100%&#39;)
  &#125;

  build() &#123;
    Column() &#123;
      Tabs(&#123; barPosition: BarPosition.Start, index: this.currentIndex, controller: this.controller &#125;) &#123;
        TabContent() &#123;
          Column().width(&#39;100%&#39;).height(&#39;100%&#39;).backgroundColor(&#39;#00CB87&#39;)
        &#125;.tabBar(this.tabBuilder(0, &#39;green&#39;))

        TabContent() &#123;
          Column().width(&#39;100%&#39;).height(&#39;100%&#39;).backgroundColor(&#39;#007DFF&#39;)
        &#125;.tabBar(this.tabBuilder(1, &#39;blue&#39;))

        TabContent() &#123;
          Column().width(&#39;100%&#39;).height(&#39;100%&#39;).backgroundColor(&#39;#FFBF00&#39;)
        &#125;.tabBar(this.tabBuilder(2, &#39;yellow&#39;))

        TabContent() &#123;
          Column().width(&#39;100%&#39;).height(&#39;100%&#39;).backgroundColor(&#39;#E67C92&#39;)
        &#125;.tabBar(this.tabBuilder(3, &#39;pink&#39;))
      &#125;
      .vertical(false)
      .barMode(BarMode.Fixed)
      .barWidth(360)
      .barHeight(56)
      // Set animation duration to 0 to avoid displaying intermediate transition pages
      .animationDuration(0)
      .onChange((index: number) =&gt; &#123;
        this.currentIndex = index
      &#125;)
      .width(360)
      .height(296)
      .margin(&#123; top: 52 &#125;)
      .backgroundColor(&#39;#F1F3F5&#39;)
    &#125;.width(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h2 id="2-How-to-obtain-application-information-and-completely-exit-an-app"><a href="#2-How-to-obtain-application-information-and-completely-exit-an-app" class="headerlink" title="2. How to obtain application information and completely exit an app?"></a>2. How to obtain application information and completely exit an app?</h2><p><strong>Problem Scenarios:</strong>  </p>
<ol>
<li>How to obtain the app’s version name (e.g., the version specified in <code>oh-package.json5</code>)?  </li>
<li>How to completely exit an app? Methods like <code>router.clear()</code> and <code>router.back()</code> do not fully terminate the app, as some background tasks may persist.</li>
</ol>
<p><strong>Solutions:</strong>  </p>
<ol>
<li><strong>Retrieve application information</strong> using <code>bundleManager</code>, which provides access to Ability information, ApplicationInfo, BundleInfo, etc.  </li>
<li><strong>Completely exit the app</strong> by following the normal lifecycle of UIAbility. Use <code>killAllProcesses</code> under <code>ApplicationContext</code> only as a last resort (force-kills all app processes). For scenarios requiring app exit due to privacy policy rejection, use <code>terminateSelf</code> under <code>UIAbilityContext</code>.</li>
</ol>
<p><strong>Sample Code:</strong>  </p>
<pre><code class="language-typescript">import &#123; bundleManager &#125; from &#39;@kit.AbilityKit&#39;;
import &#123; BusinessError &#125; from &#39;@kit.BasicServicesKit&#39;;
import &#123; DateUtil &#125; from &#39;../../utils/DateUtil&#39;;
import &#123; common &#125; from &#39;@kit.AbilityKit&#39;;

@Entry
@Component
struct CloseApp &#123;
  @State message: string = &#39;App Info: &#39;
  @State bundleInfo: bundleManager.BundleInfo | null = null
  private context = getContext(this) as common.UIAbilityContext;

  aboutToAppear(): void &#123;
    this.getAppPackageInfo()
  &#125;

  /* Get app package information */
  getAppPackageInfo() &#123;
    let bundleFlags = bundleManager.BundleFlag.GET_BUNDLE_INFO_WITH_REQUESTED_PERMISSION;
    try &#123;
      this.bundleInfo = bundleManager.getBundleInfoForSelfSync(bundleFlags);
      console.log(&#39;bundle-info&#39;, &#39;getBundleInfoForSelfSync successfully: %&#123;public&#125;s&#39;, JSON.stringify(this.bundleInfo))
    &#125; catch (err) &#123;
      let message = (err as BusinessError).message;
      console.log(&#39;bundle-info&#39;, &#39;getBundleInfoForSelfSync failed: %&#123;public&#125;s&#39;, message);
    &#125;
  &#125;

  closeApp() &#123;
    this.context.terminateSelf()
  &#125;

  build() &#123;
    Scroll() &#123;
      Flex(&#123; direction: FlexDirection.Column, justifyContent: FlexAlign.Start &#125;) &#123;
        Text(this.message)
          .id(&#39;System&#39;)
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .margin(&#123;
            bottom: 5
          &#125;)
          .alignRules(&#123;
            center: &#123; anchor: &#39;__container__&#39;, align: VerticalAlign.Center &#125;,
            middle: &#123; anchor: &#39;__container__&#39;, align: HorizontalAlign.Center &#125;
          &#125;)

        if (this.bundleInfo) &#123;
          Column() &#123;
            Row() &#123;
              Text(&#39;App Package Name: &#39;)
              Text(this.bundleInfo.name)
            &#125;.width(&#39;100%&#39;)

            Row() &#123;
              Text(&#39;App Package Vendor: &#39;)
              Text(this.bundleInfo.vendor)
            &#125;.width(&#39;100%&#39;)

            Row() &#123;
              Text(&#39;App Package Version Code: &#39;)
              Text(this.bundleInfo.versionCode.toString())
            &#125;.width(&#39;100%&#39;)

            Row() &#123;
              Text(&#39;App Package Version Name: &#39;)
              Text(this.bundleInfo.versionName)
            &#125;.width(&#39;100%&#39;)

            Row() &#123;
              Text(&#39;App Target Version: &#39;)
              Text(this.bundleInfo.targetVersion.toString())
            &#125;.width(&#39;100%&#39;)

            Row() &#123;
              Text(&#39;App Target Version: &#39;)
              Text(this.bundleInfo.targetVersion.toString())
            &#125;.width(&#39;100%&#39;)

            Row() &#123;
              Text(&#39;App Installation Time: &#39;)
              Text(`$&#123;this.bundleInfo.installTime.toString()&#125; -- $&#123;DateUtil.getFormatTimeStr(this.bundleInfo.installTime)&#125;`)
                .fontSize(14)
            &#125;.width(&#39;100%&#39;)

            Row() &#123;
              Text(&#39;App Update Time: &#39;)
              Text(`$&#123;this.bundleInfo.updateTime.toString()&#125; -- $&#123;DateUtil.getFormatTimeStr(this.bundleInfo.updateTime)&#125;`)
                .fontSize(14)
            &#125;.width(&#39;100%&#39;)
          &#125;
        &#125;

        Button(&#39;Exit App&#39;).width(&#39;100%&#39;).margin(&#123; top: 10 &#125;).onClick(() =&gt; &#123;
          this.closeApp()
        &#125;)
      &#125;
      .height(&#39;100%&#39;)
      .width(&#39;100%&#39;)

    &#125;
    .padding(10)
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h2 id="3-Push-How-to-resolve-the-issue-where-the-push-image-API-reports-success-but-the-phone-does-not-receive-the-image"><a href="#3-Push-How-to-resolve-the-issue-where-the-push-image-API-reports-success-but-the-phone-does-not-receive-the-image" class="headerlink" title="3. [Push] How to resolve the issue where the push image API reports success but the phone does not receive the image?"></a>3. [Push] How to resolve the issue where the push image API reports success but the phone does not receive the image?</h2><p>The push API has limitations on image size. See <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/push-send-alert-V5#section62011739001">Notification Large Icon - Description</a>. Use images that meet the requirements.  </p>
<p>Even if the cloud successfully sends the message, the device may not receive it due to:  </p>
<ul>
<li><strong>Expired tokens</strong>: Regenerate the token and resend the message.  </li>
<li><strong>Disabled notifications</strong>: Ensure the device’s notification settings are enabled.  </li>
<li><strong>App uninstalled</strong>: Verify the app is installed.  </li>
<li><strong>Message frequency control</strong>: See <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/push-msg-freq-control-V5">Message Frequency Control</a>.</li>
</ul>
<h2 id="4-How-to-implement-click-event-passthrough-in-a-Stack-layout"><a href="#4-How-to-implement-click-event-passthrough-in-a-Stack-layout" class="headerlink" title="4. How to implement click event passthrough in a Stack layout?"></a>4. How to implement click event passthrough in a Stack layout?</h2><p><strong>Problem Scenario:</strong><br>After overlaying Stack layouts, how can a transparent page pass touch events to underlying views so that sibling components can also respond to events?  </p>
<p><strong>Solution:</strong><br>Use the <code>hitTestBehavior</code> property to control event passthrough. Refer to the documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-gesture-events-multi-level-gesture-V5">Multi-level Gesture Handling</a>.  </p>
<p><strong>Reference Code:</strong>  </p>
<pre><code class="language-typescript">@Entry
@Component
struct PageHitTestBehavior &#123;
  @State message: string = &#39;Hello World&#39;;

  build() &#123;
    Stack() &#123;
      Column() &#123;
        Text(&#39;Lower Column&#39;)
      &#125;
      .onTouch(() =&gt; &#123;
        console.log(&#39;Lower onTouch&#39;)
      &#125;)
      .width(&#39;50%&#39;)
      .height(&#39;50%&#39;)
      .backgroundColor(Color.Blue)

      Column() &#123;
        Text(&#39;Upper Column&#39;)
      &#125;
      .onTouch(() =&gt; &#123;
        console.log(&#39;Upper onTouch&#39;)
      &#125;)
      // Set HitTestMode.Transparent to allow touch events to pass through to sibling components
      .hitTestBehavior(HitTestMode.Transparent)
      .width(&#39;50%&#39;)
      .height(&#39;50%&#39;)
    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h2 id="5-How-does-the-client-receive-push-“Alert-Messages-Notification-Messages-”-and-background-messages"><a href="#5-How-does-the-client-receive-push-“Alert-Messages-Notification-Messages-”-and-background-messages" class="headerlink" title="5. How does the client receive push “Alert Messages (Notification Messages)” and background messages?"></a>5. How does the client receive push “Alert Messages (Notification Messages)” and background messages?</h2><ul>
<li><strong>Notification Messages</strong> (<code>push-type</code> 0): Data is accessible only after the user clicks the notification to enter the app. See <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/push-send-alert-V5">Sending Notification Messages</a>.  </li>
<li><strong>Background Messages</strong>: These messages are received only when the app is running. If the app is not running, messages are cached and delivered when the app starts. They do not appear in the notification bar. Verify configuration in the <code>module.json5</code> file’s <code>skills</code> property. See <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/push-background-V5">Sending Background Messages</a>.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4803-Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-related-Knowledge/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4803-Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-related-Knowledge/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Every Day] Network-related Knowledge</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:09:27 / Modified: 17:38:13" itemprop="dateCreated datePublished" datetime="2025-06-30T17:09:27+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-related-Knowledge"><a href="#Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-related-Knowledge" class="headerlink" title="[Learn HarmonyOS Next Knowledge Every Day] Network-related Knowledge"></a>[Learn HarmonyOS Next Knowledge Every Day] Network-related Knowledge</h1><h2 id="1-What-is-the-difference-between-the-HTTP-native-library-and-RCP"><a href="#1-What-is-the-difference-between-the-HTTP-native-library-and-RCP" class="headerlink" title="1. What is the difference between the HTTP native library and RCP?"></a>1. What is the difference between the HTTP native library and RCP?</h2><p>Currently, the RCP capability is recommended, which offers better interface usability, performance, and power consumption compared to the HTTP native network library.<br>The underlying capabilities of the HTTP native network library are implemented via curl, while the underlying capabilities of the RCP module differ from the native HTTP and are mainly developed and closed-source packaged internally.  </p>
<h2 id="2-How-to-handle-error-code-err-number-8-in-the-request-downloadFile-interface"><a href="#2-How-to-handle-error-code-err-number-8-in-the-request-downloadFile-interface" class="headerlink" title="2. How to handle error code err number &#x3D; 8 in the request.downloadFile interface?"></a>2. How to handle error code err number &#x3D; 8 in the request.downloadFile interface?</h2><p>The request.downloadFile often returns err number &#x3D; 8, and the callback err&#x3D;8 in downloadTask.on(‘fail’, (err: number)) represents the unknown error described in the documentation.<br>An err&#x3D;8 in the downloadFile fail callback indicates that the task failed due to an internal error. You can try retrying the task. Alternatively, in version 5.x, use the related interfaces of request.agent to obtain Faults, which will contain more specific information.  </p>
<h2 id="3-How-to-set-the-timeout-period-when-initiating-a-request-with-the-RCP-library"><a href="#3-How-to-set-the-timeout-period-when-initiating-a-request-with-the-RCP-library" class="headerlink" title="3. How to set the timeout period when initiating a request with the RCP library?"></a>3. How to set the timeout period when initiating a request with the RCP library?</h2><p>In the RCP library, relevant capabilities allow setting parameters in SessionConfiguration before establishing a session. For usage, refer to the following:  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">sessionConfig</span>: rcp.<span class="property">SessionConfiguration</span> = &#123;</span><br><span class="line">  <span class="comment">// Used to specify the configuration for HTTP requests associated with the session</span></span><br><span class="line">  <span class="attr">requestConfiguration</span>: &#123;</span><br><span class="line">    <span class="attr">transfer</span>: &#123;</span><br><span class="line">      <span class="comment">// Timeout parameter settings</span></span><br><span class="line">      <span class="attr">timeout</span>: &#123;</span><br><span class="line">        <span class="comment">// Connection timeout</span></span><br><span class="line">        <span class="attr">connectMs</span>: <span class="number">5000</span>,</span><br><span class="line">        <span class="comment">// Transfer timeout</span></span><br><span class="line">        <span class="attr">transferMs</span>: <span class="number">10000</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> session = rcp.<span class="title function_">createSession</span>(sessionConfig);</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 4. Error when using synchronous methods to get network status in a no-network environment?  </span></span><br><span class="line"><span class="string">In a no-network environment, calling synchronous methods to request cannot parse and obtain the corresponding content of nethandle, and an error occurs when the method internally executes getCap. You can use a try-catch approach to get the error information:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> netHandle = connection.<span class="title function_">getDefaultNetSync</span>();</span><br><span class="line">  <span class="keyword">let</span> connectionproperties = connection.<span class="title function_">getConnectionPropertiesSync</span>(netHandle);</span><br><span class="line">&#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;error: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 5. How to monitor and determine VPN-type networks?  </span></span><br><span class="line"><span class="string">The VPN type can be obtained using the getNetCapabilities method to get bearerTypes. When the value of bearerTypes is 4, it indicates that a VPN is used. Sample code:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line">connection.<span class="title function_">getDefaultNet</span>().<span class="title function_">then</span>(<span class="function">(<span class="params"><span class="attr">netHandle</span>: connection.<span class="title class_">NetHandle</span></span>) =&gt;</span> &#123;</span><br><span class="line">  connection.<span class="title function_">getNetCapabilities</span>(netHandle).<span class="title function_">then</span>(<span class="function">(<span class="params"><span class="attr">data</span>: connection.<span class="title class_">NetCapabilities</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">type</span>: <span class="title class_">Number</span> = data.<span class="property">bearerTypes</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">type</span> === <span class="number">4</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;is vpn&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4802-Learn-HarmonyOS-Next-Knowledge-Every-Day-Debug-Certificates-Webview-Version-Numbers-etc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4802-Learn-HarmonyOS-Next-Knowledge-Every-Day-Debug-Certificates-Webview-Version-Numbers-etc/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Every Day] Debug Certificates, Webview, Version Numbers, etc.</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:06:56 / Modified: 17:07:33" itemprop="dateCreated datePublished" datetime="2025-06-30T17:06:56+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Every-Day-Debug-Certificates-Webview-Version-Numbers-etc"><a href="#Learn-HarmonyOS-Next-Knowledge-Every-Day-Debug-Certificates-Webview-Version-Numbers-etc" class="headerlink" title="[Learn HarmonyOS Next Knowledge Every Day] Debug Certificates, Webview, Version Numbers, etc."></a>[Learn HarmonyOS Next Knowledge Every Day] Debug Certificates, Webview, Version Numbers, etc.</h1><h2 id="1-Failed-to-obtain-token-with-error-message-get-token-fail-error-name-Error-error-message-Illegal-application-identity-json-“code”-1000900010"><a href="#1-Failed-to-obtain-token-with-error-message-get-token-fail-error-name-Error-error-message-Illegal-application-identity-json-“code”-1000900010" class="headerlink" title="1. Failed to obtain token with error message: get token fail:, {error.name:Error, error.message:Illegal application identity.}, json:{“code”:1000900010}}?"></a>1. Failed to obtain token with error message: get token fail:, {error.name:Error, error.message:Illegal application identity.}, json:{“code”:1000900010}}?</h2><p>The application has applied for a debug certificate in AppGallery Connect, enabled the push service, configured the debug certificate signature in the app project, and set the client_id. However, token acquisition fails with the error message: get token fail:, {error.name:Error, error.message:Illegal application identity.}, json:{“code”:1000900010}}.  </p>
<p><strong>Possible causes</strong><br>The application may have violated regulations:  </p>
<ul>
<li>The application was created in <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html#/">AppGallery Connect</a> without selecting the HarmonyOS application type.  </li>
<li>The application signature certificate fingerprint configured in <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html#/">AppGallery Connect</a> does not match the actual one. For details, see <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/application-dev-overview-V5#section1726913517284">Add Public Key Fingerprint</a>.  </li>
<li>The client_id is not configured in src&#x2F;main&#x2F;module.json5 at the project module level (e.g., entry&#x2F;src&#x2F;main&#x2F;module.json5). For details, see <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/push-config-setting-V5#section19205719141">Configure Client ID</a>.</li>
</ul>
<h2 id="2-How-to-obtain-the-app-system-version-number"><a href="#2-How-to-obtain-the-app-system-version-number" class="headerlink" title="2. How to obtain the app&#x2F;system version number?"></a>2. How to obtain the app&#x2F;system version number?</h2><p><strong>To obtain the app package version number</strong>, refer to the document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-bundlemanager-bundleinfo-V5#ZH-CN_TOPIC_0000001884917318__bundleinfo-1">BundleInfo</a>.  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; bundleManager &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.AbilityKit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> bundleFlags = bundleManager.<span class="property">BundleFlag</span>.<span class="property">GET_BUNDLE_INFO_WITH_APPLICATION</span> | bundleManager.<span class="property">BundleFlag</span>.<span class="property">GET_BUNDLE_INFO_WITH_METADATA</span>;</span><br><span class="line">bundleManager.<span class="title function_">getBundleInfoForSelf</span>(bundleFlags).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;versionCode: &#x27;</span> + data.<span class="property">versionCode</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;versionName: &#x27;</span> + data.<span class="property">versionName</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**To obtain the system version number**, refer to the document: [deviceInfo](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-device-info-V5).  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">import</span> &#123; deviceInfo &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;displayVersion: &#x27;</span> + deviceInfo.<span class="property">displayVersion</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;osFullName: &#x27;</span> + deviceInfo.<span class="property">osFullName</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;versionId: &#x27;</span> + deviceInfo.<span class="property">versionId</span>);</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 3. Can a phone call be initiated directly via location.href in a webview?  </span></span><br><span class="line"><span class="string">No. The phone subsystem module must be introduced on the application side. The Android implementation principle is the same—calling functionality requires introducing the corresponding module in ArkTS first.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Reference code:**  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="comment">// xxx.ets</span></span><br><span class="line"><span class="keyword">import</span> web_webview <span class="keyword">from</span> <span class="string">&#x27;@ohos.web.webview&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> call <span class="keyword">from</span> <span class="string">&#x27;@ohos.telephony.call&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">  <span class="attr">webviewController</span>: web_webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> web_webview.<span class="title class_">WebviewController</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: $rawfile(<span class="string">&#x27;call.html&#x27;</span>), <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webviewController</span> &#125;)</span><br><span class="line">        .<span class="title function_">onLoadIntercept</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (event) &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="attr">url</span>: <span class="built_in">string</span> = event.<span class="property">data</span>.<span class="title function_">getRequestUrl</span>();</span><br><span class="line">            <span class="comment">// Check if the link is a dialing link</span></span><br><span class="line">            <span class="keyword">if</span> (url.<span class="title function_">indexOf</span>(<span class="string">&#x27;tel://&#x27;</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="comment">// Navigate to the dialing interface</span></span><br><span class="line">              call.<span class="title function_">makeCall</span>(url.<span class="title function_">substring</span>(<span class="number">6</span>), <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;make call succeeded.&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;make call fail, err is:&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 4. How to implement different code logic by judging function parameter types?  </span></span><br><span class="line"><span class="string">- **Prototype detection via instanceof**  </span></span><br><span class="line"><span class="string">- **Judgment via constructor string**  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Game</span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Solve</span>(<span class="params"><span class="attr">message</span>:<span class="built_in">number</span> | <span class="built_in">string</span> | <span class="built_in">boolean</span> | <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="built_in">number</span>&gt; | <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">number</span>&gt; | <span class="title class_">Game</span></span>)&#123;</span><br><span class="line">  <span class="comment">// Game type judgment</span></span><br><span class="line">  <span class="keyword">if</span>(message <span class="keyword">instanceof</span> <span class="title class_">Game</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;Game&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="attr">typeStr</span>:<span class="built_in">string</span> = message.<span class="property">constructor</span>.<span class="title function_">toString</span>().<span class="title function_">substring</span>(<span class="number">9</span>,<span class="number">12</span>)</span><br><span class="line">  <span class="keyword">switch</span> (typeStr)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;Num&#x27;</span>:<span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;number&#x27;</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;Str&#x27;</span>:<span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;string&#x27;</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;Boo&#x27;</span>:<span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;boolean&#x27;</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;Map&#x27;</span>:<span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;Map&#x27;</span>);<span class="keyword">break</span>;  <span class="comment">// Map type judgment</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;Obj&#x27;</span>:<span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;Record&#x27;</span>);<span class="keyword">break</span>;  <span class="comment">// Record type judgment</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 5. How to cancel the selection state when closing the bindSelection custom menu in a Text component?  </span></span><br><span class="line"><span class="string">When a Text component binds a bindSelectionMenu custom menu, long-pressing triggers the custom menu. Using closeSelectionMenu to close the custom menu does not cancel the text selection state.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To cancel the selection state in this scenario, reset the selection area using `</span>selection<span class="string">`. When calling closeSelectionMenu to close the custom menu, reset the `</span>start<span class="string">` and `</span>end<span class="string">` of the selection to cancel the selection state.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Reference code:**  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Demo</span> &#123;</span><br><span class="line">  <span class="attr">controller</span>: <span class="title class_">TextController</span> = <span class="keyword">new</span> <span class="title class_">TextController</span>();</span><br><span class="line">  <span class="attr">options</span>: <span class="title class_">TextOptions</span> = &#123; <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">controller</span> &#125;;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">start</span>: <span class="built_in">number</span> = -<span class="number">1</span></span><br><span class="line">  <span class="meta">@State</span> <span class="attr">end</span>: <span class="built_in">number</span> = -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="literal">undefined</span>, <span class="variable language_">this</span>.<span class="property">options</span>) &#123;</span><br><span class="line">          <span class="title class_">Span</span>(<span class="string">&#x27;Hello World&#x27;</span>)</span><br><span class="line">          <span class="title class_">ImageSpan</span>($r(<span class="string">&#x27;app.media.dog&#x27;</span>))</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100px&#x27;</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100px&#x27;</span>)</span><br><span class="line">            .<span class="title function_">objectFit</span>(<span class="title class_">ImageFit</span>.<span class="property">Fill</span>)</span><br><span class="line">            .<span class="title function_">verticalAlign</span>(<span class="title class_">ImageSpanAlignment</span>.<span class="property">CENTER</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="title function_">selection</span>(<span class="variable language_">this</span>.<span class="property">start</span>, <span class="variable language_">this</span>.<span class="property">end</span>)</span><br><span class="line">        .<span class="title function_">copyOption</span>(<span class="title class_">CopyOptions</span>.<span class="property">InApp</span>)</span><br><span class="line">        <span class="comment">// Long-press to trigger the custom menu</span></span><br><span class="line">        .<span class="title function_">bindSelectionMenu</span>(<span class="title class_">TextSpanType</span>.<span class="property">TEXT</span>, <span class="variable language_">this</span>.<span class="property">LongPressImageCustomMenu</span>, <span class="title class_">TextResponseType</span>.<span class="property">LONG_PRESS</span>, &#123;</span><br><span class="line">          <span class="attr">onDisappear</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`Callback when the custom selection menu closes`</span>);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">onAppear</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`Callback when the custom selection menu appears`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// Callback when the selection area changes to update the start and end indices of the selection area</span></span><br><span class="line">        .<span class="title function_">onTextSelectionChange</span>(<span class="function">(<span class="params"><span class="attr">selectionStart</span>: <span class="built_in">number</span>, <span class="attr">selectionEnd</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">start</span> = selectionStart</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">end</span> = selectionEnd</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`Callback for text selection area change, selectionStart: <span class="subst">$&#123;selectionStart&#125;</span>, selectionEnd: <span class="subst">$&#123;selectionEnd&#125;</span>`</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">borderWidth</span>(<span class="number">1</span>)</span><br><span class="line">        .<span class="title function_">borderColor</span>(<span class="title class_">Color</span>.<span class="property">Red</span>)</span><br><span class="line">        .<span class="title function_">width</span>(<span class="number">200</span>)</span><br><span class="line">        .<span class="title function_">height</span>(<span class="number">100</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Start</span>)</span><br><span class="line">      .<span class="title function_">padding</span>(<span class="number">25</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Builder</span></span><br><span class="line">  <span class="title class_">LongPressImageCustomMenu</span>() &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Menu</span>() &#123;</span><br><span class="line">        <span class="title class_">MenuItemGroup</span>() &#123;</span><br><span class="line">          <span class="title class_">MenuItem</span>(&#123;</span><br><span class="line">            <span class="attr">startIcon</span>: $r(<span class="string">&#x27;app.media.app_icon&#x27;</span>),</span><br><span class="line">            <span class="attr">content</span>: <span class="string">&quot;Right Click Menu 1&quot;</span>,</span><br><span class="line">            <span class="attr">labelInfo</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">          &#125;)<span class="comment">// When clicking the custom menu, reset the start and end indices of the selection area</span></span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">start</span> = -<span class="number">1</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">end</span> = -<span class="number">1</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">controller</span>.<span class="title function_">closeSelectionMenu</span>();</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">          <span class="title class_">MenuItem</span>(&#123; <span class="attr">startIcon</span>: $r(<span class="string">&#x27;app.media.app_icon&#x27;</span>), <span class="attr">content</span>: <span class="string">&quot;Select Mixed Menu 2&quot;</span>, <span class="attr">labelInfo</span>: <span class="string">&quot;&quot;</span> &#125;)</span><br><span class="line">          <span class="title class_">MenuItem</span>(&#123; <span class="attr">startIcon</span>: $r(<span class="string">&#x27;app.media.app_icon&#x27;</span>), <span class="attr">content</span>: <span class="string">&quot;Select Mixed Menu 3&quot;</span>, <span class="attr">labelInfo</span>: <span class="string">&quot;&quot;</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title class_">MenuStyles</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Extend</span>(<span class="title class_">Menu</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">MenuStyles</span>(<span class="params"></span>) &#123;</span><br><span class="line">  .<span class="title function_">radius</span>($r(<span class="string">&#x27;sys.float.ohos_id_corner_radius_card&#x27;</span>))</span><br><span class="line">  .<span class="title function_">clip</span>(<span class="literal">true</span>)</span><br><span class="line">  .<span class="title function_">backgroundColor</span>(<span class="string">&#x27;#F0F0F0&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4801-Learn-HarmonyOS-Next-Knowledge-Every-Day-Security-and-Network-Requests/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4801-Learn-HarmonyOS-Next-Knowledge-Every-Day-Security-and-Network-Requests/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Every Day] Security and Network Requests</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:05:31 / Modified: 17:38:07" itemprop="dateCreated datePublished" datetime="2025-06-30T17:05:31+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Every-Day-Security-and-Network-Requests"><a href="#Learn-HarmonyOS-Next-Knowledge-Every-Day-Security-and-Network-Requests" class="headerlink" title="[Learn HarmonyOS Next Knowledge Every Day] Security and Network Requests"></a>[Learn HarmonyOS Next Knowledge Every Day] Security and Network Requests</h1><h2 id="1-What-information-is-required-to-obtain-a-JWT-Token-using-an-online-generation-tool"><a href="#1-What-information-is-required-to-obtain-a-JWT-Token-using-an-online-generation-tool" class="headerlink" title="1. What information is required to obtain a JWT Token using an online generation tool?"></a>1. What information is required to obtain a JWT Token using an online generation tool?</h2><p>A Service Account is an account that enables interface authentication between servers. You can create a service account on the <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/console/api/credentials/dev388421841222205506/0">API Console</a> of the Huawei Developer Alliance. Based on the returned public and private keys, you can generate an authentication token in your business application to call Huawei’s public APIs that support this authentication method.  </p>
<p>The service account token is a JWT (JSON Web Token) formatted string, which consists of three parts:  </p>
<ul>
<li>Header  </li>
<li>Payload  </li>
<li>Signature</li>
</ul>
<p>These three parts are connected by “.”, where the Signature is generated by signing the concatenated string of Header and Payload using the SHA256withRSA&#x2F;PSS algorithm.<br>Reference document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/push-jwt-token-V5#section16173145352">Generate Authentication Tokens Based on Service Accounts - Development Steps</a>  </p>
<h2 id="2-What-is-the-purpose-of-the-material-directory-generated-after-signing"><a href="#2-What-is-the-purpose-of-the-material-directory-generated-after-signing" class="headerlink" title="2. What is the purpose of the material directory generated after signing?"></a>2. What is the purpose of the material directory generated after signing?</h2><p>The material directory is generated by the IDE and is used to encrypt users’ plaintext passwords.  </p>
<h2 id="3-Does-the-ArkWeb-component-support-deep-copying"><a href="#3-Does-the-ArkWeb-component-support-deep-copying" class="headerlink" title="3. Does the ArkWeb component support deep copying?"></a>3. Does the ArkWeb component support deep copying?</h2><p>Does the ArkWeb component support deep copying, where ArkWeb component A is copied to ArkWeb component B, allowing B to continue using the resources of A after A is closed or exited from the routing stack?  </p>
<p>This capability is currently unavailable. The only approach is to dynamically create a pool of web components, from which you can directly retrieve and display components by attaching them to the node tree as needed.<br>Reference document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/web-page-loading-with-web-components-V5">Loading Pages with Web Components</a>  </p>
<h2 id="4-Why-does-an-HTTP-request-for-a-file-larger-than-5MB-return-an-error-code-2300023"><a href="#4-Why-does-an-HTTP-request-for-a-file-larger-than-5MB-return-an-error-code-2300023" class="headerlink" title="4. Why does an HTTP request for a file larger than 5MB return an error code 2300023?"></a>4. Why does an HTTP request for a file larger than 5MB return an error code 2300023?</h2><p>The default specification for HTTP requests allows a maximum transmission of 5MB data files. If the file exceeds this limit, use the <code>http.requestInstream</code> capability instead.<br>For usage, refer to the document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-http-V5#requestinstream10">requestInStream</a>  </p>
<h2 id="5-Can-paths-starting-with-“internal”-be-replaced-with-other-paths"><a href="#5-Can-paths-starting-with-“internal”-be-replaced-with-other-paths" class="headerlink" title="5. Can paths starting with “internal” be replaced with other paths?"></a>5. Can paths starting with “internal” be replaced with other paths?</h2><p>In the example at <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-request-V5#requestuploadfile9">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-request-V5#requestuploadfile9</a>, what is the purpose of paths starting with “internal,” and can they be replaced with other paths or user file URIs?  </p>
<p>In version 5.x, uploading user files is supported. You can pass in user paths that the application has permission to access or application sandbox paths.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4731-Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-Performance-and-Player-related/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4731-Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-Performance-and-Player-related/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Every Day] Network, Performance, and Player-related</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:04:08 / Modified: 17:04:26" itemprop="dateCreated datePublished" datetime="2025-06-30T17:04:08+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-Performance-and-Player-related"><a href="#Learn-HarmonyOS-Next-Knowledge-Every-Day-Network-Performance-and-Player-related" class="headerlink" title="[Learn HarmonyOS Next Knowledge Every Day] Network, Performance, and Player-related"></a>[Learn HarmonyOS Next Knowledge Every Day] Network, Performance, and Player-related</h1><h2 id="1-How-to-handle-the-error-code-request-agent-State-FAILED-when-there-is-an-exception-in-request-file-download"><a href="#1-How-to-handle-the-error-code-request-agent-State-FAILED-when-there-is-an-exception-in-request-file-download" class="headerlink" title="1. How to handle the error code request.agent.State.FAILED when there is an exception in request file download?"></a>1. How to handle the error code request.agent.State.FAILED when there is an exception in request file download?</h2><p>When using the request.agent.create method to download files, the error code in the callback Progress is request.agent.State.FAILED. Currently, other devices can download normally, but only one device fails to download and reports an error.  </p>
<p>A State of FAILED indicates that the task has failed. You can consider restarting the task or removing the file and starting a new task.  </p>
<h2 id="2-How-to-determine-whether-the-current-network-can-access-the-internet"><a href="#2-How-to-determine-whether-the-current-network-can-access-the-internet" class="headerlink" title="2. How to determine whether the current network can access the internet?"></a>2. How to determine whether the current network can access the internet?</h2><p>You can use the capabilities of <code>@ohos.net.connection</code> to determine whether the current network can access the internet each time the network connection changes, and then store the judgment result in AppStorage. When you need to determine whether you can access the internet, you can directly obtain the result from AppStorage. The sample code is as follows:  </p>
<pre><code class="language-typescript">import &#123; connection &#125; from &#39;@kit.NetworkKit&#39;;
import &#123; BusinessError &#125; from &#39;@kit.BasicServicesKit&#39;;

export class NetJudge &#123;
  public static conn: connection.NetConnection | undefined = undefined;

  private static JUDGE_NET_TAG: string = &#39;NetJudge.currNet.isUseful&#39;;

  public static netFlag: string = &#39;false&#39;

  private static init() &#123;
    NetJudge.conn = connection.createNetConnection();
    NetJudge.conn.register(() =&gt; &#123;
      console.info(&#39;connection register success&#39;)
    &#125;)

    NetJudge.conn.on(&#39;netAvailable&#39;, (data) =&gt; &#123;
      console.info(&#39;NetJudge  netAvailable &#39;)
      AppStorage.setOrCreate(NetJudge.JUDGE_NET_TAG, NetJudge.judgeHasNet())
    &#125;)

    NetJudge.conn.on(&#39;netUnavailable&#39;, () =&gt; &#123;
      console.info(&#39;NetJudge  netUnavailable &#39;)
      AppStorage.setOrCreate(NetJudge.JUDGE_NET_TAG, NetJudge.judgeHasNet())
    &#125;)

    NetJudge.conn.on(&#39;netCapabilitiesChange&#39;, (data: connection.NetCapabilityInfo) =&gt; &#123;
      AppStorage.setOrCreate(NetJudge.JUDGE_NET_TAG, NetJudge.judgeHasNet())
    &#125;)

    // Subscribe to events of changes in network connection information. This event notification can only be received after calling register
    NetJudge.conn.on(&#39;netConnectionPropertiesChange&#39;, (data: connection.NetConnectionPropertyInfo) =&gt; &#123;
      AppStorage.setOrCreate(NetJudge.JUDGE_NET_TAG, NetJudge.judgeHasNet())
    &#125;);

    NetJudge.conn.on(&#39;netLost&#39;, () =&gt; &#123;
      AppStorage.setOrCreate(NetJudge.JUDGE_NET_TAG, NetJudge.judgeHasNet())
    &#125;)

  &#125;

  public static regist() &#123;
    if (NetJudge.conn == undefined) &#123;
      NetJudge.init()
    &#125;
  &#125;

  public static judgeHasNet(): boolean &#123;
    try &#123; // Get the current network connection
      let netHandle = connection.getDefaultNetSync()

      // 0-100 are reserved connections of the system
      if (!netHandle || netHandle.netId &lt; 100) &#123;
        return false;
      &#125;

      // Get the properties of the connection
      let netCapa = connection.getNetCapabilitiesSync(netHandle);
      let cap = netCapa.networkCap;
      if (!cap) &#123;
        return false;
      &#125;

      for (let em of cap) &#123;
        if (connection.NetCap.NET_CAPABILITY_VALIDATED == em) &#123;
          return true;
        &#125;
      &#125;
    &#125; catch (e) &#123;
      let err = e as BusinessError
      console.info(&#39;get netInfo error ：&#39; + JSON.stringify(err))
    &#125;
    return false;
  &#125;
&#125;
</code></pre>
<h2 id="3-How-to-solve-the卡顿-problem-caused-by-frequently-calling-createModuleContext-to-read-cross-package-resources"><a href="#3-How-to-solve-the卡顿-problem-caused-by-frequently-calling-createModuleContext-to-read-cross-package-resources" class="headerlink" title="3. How to solve the卡顿 problem caused by frequently calling createModuleContext to read cross-package resources?"></a>3. How to solve the卡顿 problem caused by frequently calling createModuleContext to read cross-package resources?</h2><p>Frequent calls to createModuleContext to load resources of specified modules cause functional卡顿.  </p>
<p>createModuleContext involves multiple package information queries and loading all resources of the specified module, which is an interface with relatively large delay. If it needs to be used multiple times, it is best to cache the context to avoid repeated creation.  </p>
<p>It is recommended that users save the context during the first initialization and directly use the saved context to obtain the corresponding resources.  </p>
<h2 id="4-How-to-handle-the卡顿-problem-caused-by-the-long-time-spent-generating-key-values-in-the-third-parameter-of-ForEach"><a href="#4-How-to-handle-the卡顿-problem-caused-by-the-long-time-spent-generating-key-values-in-the-third-parameter-of-ForEach" class="headerlink" title="4. How to handle the卡顿 problem caused by the long time spent generating key-values in the third parameter of ForEach?"></a>4. How to handle the卡顿 problem caused by the long time spent generating key-values in the third parameter of ForEach?</h2><p>For the performance impact of ForEach’s time consumption, pay attention to the rules for generating keys.  </p>
<p>When using ForEach for rendering, if the third parameter KeyGenerator function is in the default state, the ArkUI framework will use the default key-value generation function, that is, <code>(item: any, index: number) =&gt; &#123; return index + &#39;_&#39; + JSON.stringify(item); &#125;</code>. In complex object collections and complex interactions, this will affect rendering performance.  </p>
<p>To ensure the uniqueness of key-values, for object data types, it is recommended to use the unique id in the object data as the key-value. It is not recommended to leave the third parameter KeyGenerator function in the default state or include the data item index index in the key-value generation rules.  </p>
<p>For more ForEach key-value rules, refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-rendering-control-foreach-V5#%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-rendering-control-foreach-V5#%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE</a>  </p>
<h2 id="5-Questions-about-the-specifications-of-the-system-player-AVplayer"><a href="#5-Questions-about-the-specifications-of-the-system-player-AVplayer" class="headerlink" title="5. Questions about the specifications of the system player AVplayer?"></a>5. Questions about the specifications of the system player AVplayer?</h2><ol>
<li>Does the system player AVplayer support these streaming media protocols: HLS-TS&#x2F;HLS-FMP4&#x2F;HTTP-MP4&#x2F;HTTPS?  </li>
<li>Does the system player AVplayer support encoding formats: H264&#x2F;H265&#x2F;AAC?  </li>
<li>Does the system player AVPlayer support functions such as play, pause, seek, episode switching, and full screen?</li>
</ol>
<p>Answers:  </p>
<ol>
<li>Supports HLS&#x2F;HTTP&#x2F;HTTPS.  </li>
<li>Supports H264&#x2F;H265&#x2F;AAC.  </li>
<li>Supports functions such as play, pause, and seek. Episode switching and full-screen functions need to be implemented by users themselves.</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/30/4730-Learn-HarmonyOS-Knowledge-Every-Day-About-Performance-SO-etc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/30/4730-Learn-HarmonyOS-Knowledge-Every-Day-About-Performance-SO-etc/" class="post-title-link" itemprop="url">[Learn HarmonyOS Next Knowledge Every Day]  About Performance, SO, etc.</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-30 17:02:34 / Modified: 17:37:58" itemprop="dateCreated datePublished" datetime="2025-06-30T17:02:34+08:00">2025-06-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Learn-HarmonyOS-Next-Knowledge-Every-Day-About-Performance-SO-etc"><a href="#Learn-HarmonyOS-Next-Knowledge-Every-Day-About-Performance-SO-etc" class="headerlink" title="[Learn HarmonyOS Next Knowledge Every Day] About Performance, SO, etc."></a>[Learn HarmonyOS Next Knowledge Every Day] About Performance, SO, etc.</h1><h2 id="1-How-to-Compile-Only-Specified-SO-Libraries-in-the-HAP-Package-During-Compilation-and-Packaging"><a href="#1-How-to-Compile-Only-Specified-SO-Libraries-in-the-HAP-Package-During-Compilation-and-Packaging" class="headerlink" title="1. How to Compile Only Specified SO Libraries in the HAP Package During Compilation and Packaging?"></a>1. How to Compile Only Specified SO Libraries in the HAP Package During Compilation and Packaging?</h2><p>To compile only specified SO libraries in the HAP package during compilation and packaging, configure in <code>build-profile.json5</code>:  </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Configure filtering rules for .so resource files in HAR dependencies</span></span><br><span class="line"><span class="attr">&quot;nativeLib&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;filter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// Package the highest-priority .so files by priority order</span></span><br><span class="line">    <span class="attr">&quot;pickFirsts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;**/1.so&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// Package the lowest-priority .so files by priority order</span></span><br><span class="line">    <span class="attr">&quot;pickLasts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;**/2.so&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// Excluded .so files</span></span><br><span class="line">    <span class="attr">&quot;excludes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;**/3.so&quot;</span><span class="punctuation">,</span> <span class="comment">// Exclude all .so files named &quot;3&quot;</span></span><br><span class="line">      <span class="string">&quot;**/x86_64/*.so&quot;</span> <span class="comment">// Exclude all .so files for x86_64 architecture</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// Allow overriding lower-priority .so files with higher-priority ones when name conflicts occur</span></span><br><span class="line">    <span class="attr">&quot;enableOverride&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">2.</span> How to Convert a File into a String?  </span><br><span class="line">Convert files under `rawfile` into strings or Base64-formatted data for transmission<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">getContext().resourceManager.getRawFileContent(&#x27;MyStr.txt&#x27;).then((value<span class="punctuation">:</span> Uint8Array) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">  let textDecoder<span class="punctuation">:</span> util.TextDecoder = util.TextDecoder.create(); <span class="comment">// Call the TextDecoder class from the util module</span></span><br><span class="line">  let retStr<span class="punctuation">:</span> string = textDecoder.decodeWithStream(value); <span class="comment">// Decode the Uint8Array</span></span><br><span class="line">  let strBase64 = new util.Base64Helper().encodeToStringSync(value);</span><br><span class="line">  console.info(retStr);</span><br><span class="line">  console.info(strBase64);</span><br><span class="line"><span class="punctuation">&#125;</span>).catch((error<span class="punctuation">:</span> BusinessError) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">  console.info(&#x27;getRawFileContent promise error is &#x27; + error);</span><br><span class="line"><span class="punctuation">&#125;</span>);</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">3.</span> How to Analyze Component Performance?  </span><br><span class="line">How to know the time consumption of custom components in layout<span class="punctuation">,</span> rendering<span class="punctuation">,</span> and other stages to analyze component performance?  </span><br><span class="line"></span><br><span class="line">### Performance Analysis Method <span class="number">1</span><span class="punctuation">:</span>  </span><br><span class="line"><span class="number">1.</span> Use the following script to capture the trace<span class="punctuation">:</span>  </span><br><span class="line">```bash</span><br><span class="line">hdc shell <span class="string">&quot;mkdir -p /data/local/tmp&quot;</span></span><br><span class="line">hdc shell <span class="string">&quot;bytrace -t 8 -b 32000 --overwrite sched ace app disk ohos graphic sync workq ability &gt;/data/local/tmp/mynewtrace.ftrace&quot;</span></span><br><span class="line">hdc shell <span class="string">&quot;sed -i &#x27;1,2d&#x27; /data/local/tmp/mynewtrace.ftrace&quot;</span></span><br><span class="line">hdc file recv /data/local/tmp/mynewtrace.ftrace .</span><br><span class="line">```  </span><br><span class="line"><span class="number">2.</span> Open the trace using the website <span class="punctuation">[</span>https<span class="punctuation">:</span><span class="comment">//ui.perfetto.dev/](https://ui.perfetto.dev/).  </span></span><br><span class="line"><span class="number">3.</span> Analysis steps<span class="punctuation">:</span>  </span><br><span class="line">   <span class="number">1.</span> First locate the corresponding process.  </span><br><span class="line">   <span class="number">2.</span> The image loading process is usually found on the bg thread<span class="punctuation">,</span> while the UI thread is the main thread where ArkUI&#x27;s pipeline runs.  </span><br><span class="line"></span><br><span class="line">### Performance Analysis Method <span class="number">2</span><span class="punctuation">:</span> DevEco Profiler Tuning Tool  </span><br><span class="line"><span class="number">1.</span> In the Profiler main interface<span class="punctuation">,</span> select the <span class="string">&quot;Frame&quot;</span> task type in the new task area and click <span class="string">&quot;Create Session&quot;</span>.  </span><br><span class="line"><span class="number">2.</span> Operate the APP on the tuning device<span class="punctuation">,</span> perform the operation to be verified<span class="punctuation">,</span> reproduce the performance issue<span class="punctuation">,</span> start task recording<span class="punctuation">,</span> and capture the trace for analysis.  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## <span class="number">4.</span> How to Obtain the URI Address of a `$rawfile` in the Local Machine?  </span><br><span class="line">Reference code<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line"><span class="comment">// Alternative solution: Use code to move the rawfile to be operated into the sandbox path, then execute related operations.</span></span><br><span class="line">async function resourceFile(resourcePath<span class="punctuation">:</span> string) <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">// 1. Read the file</span></span><br><span class="line">  let uint8Array<span class="punctuation">:</span> Uint8Array = getContext()</span><br><span class="line">    .createModuleContext(<span class="string">&quot;library&quot;</span>)</span><br><span class="line">    .resourceManager</span><br><span class="line">    .getRawFileContentSync(resourcePath);</span><br><span class="line">  let fileName = resourcePath.substring(resourcePath.lastIndexOf(&#x27;/&#x27;) + <span class="number">1</span>);</span><br><span class="line">  console.log(<span class="string">&quot;$&#123;tag&#125; fileName:$&#123;fileName&#125;&quot;</span>);</span><br><span class="line">  <span class="comment">// 2. Create a sandbox file</span></span><br><span class="line">  let filePath = getContext().createModuleContext(<span class="string">&quot;library&quot;</span>).filesDir + &#x27;/&#x27; + fileName;</span><br><span class="line">  if (fs.accessSync(filePath)) <span class="punctuation">&#123;</span></span><br><span class="line">    fs.unlinkSync(filePath)</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  let file<span class="punctuation">:</span> fs.File = fs.openSync(filePath<span class="punctuation">,</span> fs.OpenMode.READ_WRITE | fs.OpenMode.CREATE);</span><br><span class="line">  <span class="comment">// 3. Write the resource file to the sandbox file</span></span><br><span class="line">  fs.writeSync(file.fd<span class="punctuation">,</span> uint8Array.buffer);</span><br><span class="line">  <span class="comment">// 4. Close the file</span></span><br><span class="line">  fs.closeSync(file);</span><br><span class="line">  console.log(<span class="string">&quot;$&#123;tag&#125; filePath:$&#123;filePath&#125;&quot;</span>);</span><br><span class="line">  return filePath;</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## How to Handle Gesture Binding Conflicts with System Components That Have Default Built-in Gestures?  </span><br><span class="line">Currently<span class="punctuation">,</span> many system components with built-in gestures (such as List<span class="punctuation">,</span> Scroll<span class="punctuation">,</span> Menu<span class="punctuation">,</span> etc.) may experience conflicts after binding gesture events. Here are some related problem scenarios<span class="punctuation">:</span>  </span><br><span class="line"><span class="number">1.</span> When a Scroll component and a Gesture coexist<span class="punctuation">,</span> the Gesture becomes invalid.  </span><br><span class="line"><span class="number">2.</span> After binding a right-click menu to a component (triggered by long-press<span class="punctuation">,</span> `ResponseType.LongPress`)<span class="punctuation">,</span> binding a `LongPressGesture` simultaneously prevents the right-click menu from being triggered.  </span><br><span class="line"></span><br><span class="line">For system components with default gesture events<span class="punctuation">,</span> binding new gestures can cause conflicts. This can be resolved by using the parallel gesture binding method (`parallelGesture`).  </span><br><span class="line">Reference code<span class="punctuation">:</span>  </span><br><span class="line">```typescript</span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line">struct ScrollExample <span class="punctuation">&#123;</span></span><br><span class="line">  scroller<span class="punctuation">:</span> Scroller = new Scroller()</span><br><span class="line">  private arr<span class="punctuation">:</span> number<span class="punctuation">[</span><span class="punctuation">]</span> = <span class="punctuation">[</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">,</span> <span class="number">9</span><span class="punctuation">]</span></span><br><span class="line">  private panOption<span class="punctuation">:</span> PanGestureOptions = new PanGestureOptions(<span class="punctuation">&#123;</span> direction<span class="punctuation">:</span> PanDirection.Up | PanDirection.Down <span class="punctuation">&#125;</span>)</span><br><span class="line"></span><br><span class="line">  build() <span class="punctuation">&#123;</span></span><br><span class="line">    Stack(<span class="punctuation">&#123;</span> alignContent<span class="punctuation">:</span> Alignment.TopStart <span class="punctuation">&#125;</span>) <span class="punctuation">&#123;</span></span><br><span class="line">      Scroll(this.scroller) <span class="punctuation">&#123;</span></span><br><span class="line">        Column() <span class="punctuation">&#123;</span></span><br><span class="line">          ForEach(this.arr<span class="punctuation">,</span> (item<span class="punctuation">:</span> number) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">            Text(item.toString())</span><br><span class="line">              .width(&#x27;<span class="number">90</span>%&#x27;)</span><br><span class="line">              .height(<span class="number">150</span>)</span><br><span class="line">              .backgroundColor(<span class="number">0xFFFFFF</span>)</span><br><span class="line">              .borderRadius(<span class="number">15</span>)</span><br><span class="line">              .fontSize(<span class="number">16</span>)</span><br><span class="line">              .textAlign(TextAlign.Center)</span><br><span class="line">              .margin(<span class="punctuation">&#123;</span> top<span class="punctuation">:</span> <span class="number">10</span> <span class="punctuation">&#125;</span>)</span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span> (item<span class="punctuation">:</span> string) =&gt; item)</span><br><span class="line">        <span class="punctuation">&#125;</span>.width(&#x27;<span class="number">100</span>%&#x27;)</span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">      .scrollable(ScrollDirection.Vertical) <span class="comment">// Vertical scrolling direction</span></span><br><span class="line">      .scrollBar(BarState.On) <span class="comment">// Scrollbar always visible</span></span><br><span class="line">      .scrollBarColor(Color.Gray) <span class="comment">// Scrollbar color</span></span><br><span class="line">      .scrollBarWidth(<span class="number">10</span>) <span class="comment">// Scrollbar width</span></span><br><span class="line">      .friction(<span class="number">0.6</span>)</span><br><span class="line">      .edgeEffect(EdgeEffect.None)</span><br><span class="line">      .onScroll((xOffset<span class="punctuation">:</span> number<span class="punctuation">,</span> yOffset<span class="punctuation">:</span> number) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">        console.info(xOffset + &#x27; &#x27; + yOffset)</span><br><span class="line">      <span class="punctuation">&#125;</span>)</span><br><span class="line">      .onScrollEdge((side<span class="punctuation">:</span> Edge) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">        console.info(&#x27;To the edge&#x27;)</span><br><span class="line">      <span class="punctuation">&#125;</span>)</span><br><span class="line">      .onScrollStop(() =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">        console.info(&#x27;Scroll Stop&#x27;)</span><br><span class="line">      <span class="punctuation">&#125;</span>)</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="comment">// Use parallel gesture binding (parallelGesture) to avoid conflicts with built-in gestures</span></span><br><span class="line">    .parallelGesture(</span><br><span class="line">      PanGesture(this.panOption)</span><br><span class="line">        .onActionStart((event?<span class="punctuation">:</span> GestureEvent) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">          console.info(&#x27;Pan start&#x27;<span class="punctuation">,</span> event)</span><br><span class="line">        <span class="punctuation">&#125;</span>)</span><br><span class="line">        .onActionUpdate((event?<span class="punctuation">:</span> GestureEvent) =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">          if (event) <span class="punctuation">&#123;</span></span><br><span class="line">            console.info(&#x27;Pan event&#x27;<span class="punctuation">,</span> event)</span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span>)</span><br><span class="line">        .onActionEnd(() =&gt; <span class="punctuation">&#123;</span></span><br><span class="line">          console.info(&#x27;Pan end&#x27;)</span><br><span class="line">        <span class="punctuation">&#125;</span>)</span><br><span class="line">    )</span><br><span class="line">    .width(&#x27;<span class="number">100</span>%&#x27;).height(&#x27;<span class="number">100</span>%&#x27;).backgroundColor(<span class="number">0xDCDCDC</span>)</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Qingkouwei</p>
  <div class="site-description" itemprop="description">Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">347</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingkouwei</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>

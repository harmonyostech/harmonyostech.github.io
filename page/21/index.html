<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harmonyostech.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:type" content="website">
<meta property="og:title" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:url" content="https://harmonyostech.github.io/page/21/index.html">
<meta property="og:site_name" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Qingkouwei">
<meta property="article:tag" content="HarmonyOSNext, HarmonyOS NEXT, HarmonyOS, Cangjie">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://harmonyostech.github.io/page/21/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>HarmonyOS NEXT Knowledge Charging Station</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HarmonyOS NEXT Knowledge Charging Station</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Analysis of Core Technologies and Application Scenarios of HarmonyOS NEXT</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/322-Daily-HarmonyOS-Next-Knowledge-Image-Caching-chainMode-Custom-Dialog-State-Manager-Relative-Position-Setting/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/322-Daily-HarmonyOS-Next-Knowledge-Image-Caching-chainMode-Custom-Dialog-State-Manager-Relative-Position-Setting/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Image Caching, chainMode, Custom Dialog, State Manager, Relative Position Setting</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:28:39 / Modified: 22:28:56" itemprop="dateCreated datePublished" datetime="2025-06-26T22:28:39+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Image-Caching-chainMode-Custom-Dialog-State-Manager-Relative-Position-Setting"><a href="#Daily-HarmonyOS-Next-Knowledge-Image-Caching-chainMode-Custom-Dialog-State-Manager-Relative-Position-Setting" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Image Caching, chainMode, Custom Dialog, State Manager, Relative Position Setting"></a>[Daily HarmonyOS Next Knowledge] Image Caching, chainMode, Custom Dialog, State Manager, Relative Position Setting</h3><h4 id="1-Can-the-image-component-in-HarmonyOS-cache-network-images"><a href="#1-Can-the-image-component-in-HarmonyOS-cache-network-images" class="headerlink" title="1. Can the image component in HarmonyOS cache network images?"></a>1. Can the image component in HarmonyOS cache network images?</h4><p>When loading network images, the Image component reads resources from the network for the first time, and subsequent loads are read from the cache. For specific image caching details, refer to the documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-system-app-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-system-app-V5</a>  </p>
<p><strong>static setImageCacheCount(value: number): void</strong><br>Sets the upper limit of decoded images cached in memory to improve loading speed for the same source. The default is 0 (no caching). The cache uses a built-in LRU strategy: if the limit is exceeded, the least recently used cache is removed. Set a reasonable value based on memory requirements to avoid high memory usage.  </p>
<ul>
<li>This method takes effect when set in <code>onPageShow</code> or <code>aboutToAppear</code> of an <code>@Entry</code>-marked page.  </li>
<li><code>setImageCacheCount</code>, <code>setImageRawDataCacheSize</code>, and <code>setImageFileCacheSize</code> have limited flexibility. For complex scenarios, use ImageKnife instead.</li>
</ul>
<pre><code class="language-typescript">// xxx.ets
import app, &#123; AppResponse &#125; from &#39;@system.app&#39;

@Entry
@Component
struct Index &#123;
  onPageShow() &#123;
    // Set the memory cache limit for decoded images to 100
    app.setImageCacheCount(100) 
    console.info(&#39;Application onPageShow&#39;)
  &#125;
  onDestroy() &#123;
    console.info(&#39;Application onDestroy&#39;)
  &#125;

  build() &#123;
    Row()&#123;
      // xxxxxxxxxxxxx is the image URL
      Image(&#39;xxxxxxxxxxxxx&#39;)
        .width(200)
        .height(50)
    &#125;.width(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<p><strong>static setImageRawDataCacheSize(value: number): void</strong><br>Sets the upper limit (in bytes) for raw image data cached in memory before decoding. The default is 0 (no caching). The LRU strategy applies: if the limit is exceeded, the least recently used raw data is removed. Adjust the value to balance memory usage.  </p>
<pre><code class="language-typescript">// xxx.ets
import app, &#123; AppResponse &#125; from &#39;@system.app&#39;

@Entry
@Component
struct Index &#123;
  onPageShow() &#123;
    // Set the memory cache limit for raw image data to 100MB (100MB = 100*1024*1024B = 104857600B)
    app.setImageRawDataCacheSize(104857600) 
    console.info(&#39;Application onPageShow&#39;)
  &#125;
  onDestroy() &#123;
    console.info(&#39;Application onDestroy&#39;)
  &#125;

  build() &#123;
    Row()&#123;
      // xxxxxxxxxxxxx is the image URL
      Image(&#39;xxxxxxxxxxxxx&#39;)
        .width(200)
        .height(50)
    &#125;.width(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h4 id="2-Why-does-chainMode-not-work-in-the-vertical-direction-for-HarmonyOS-api-RelativeContainer"><a href="#2-Why-does-chainMode-not-work-in-the-vertical-direction-for-HarmonyOS-api-RelativeContainer" class="headerlink" title="2. Why does chainMode not work in the vertical direction for HarmonyOS api RelativeContainer?"></a>2. Why does chainMode not work in the vertical direction for HarmonyOS api RelativeContainer?</h4><p>When using horizontal chainMode for three components (A, B, C), it works, but vertical chainMode for two components (A, B) fails.  </p>
<p>For vertical chainMode, set the chain direction to <code>Axis.Vertical</code> and ensure the layout links to the parent container with connected anchors. Refer to dependency rules: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-relativecontainer-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-relativecontainer-V5</a>  </p>
<pre><code class="language-typescript">@Entry
@Component
struct Index &#123;
  build() &#123;
    Row() &#123;
      RelativeContainer() &#123;
        Stack()&#123;
          Image(&quot;Any image&quot;).width(80).aspectRatio(1).objectFit(ImageFit.Cover)
            .alt($r(&#39;app.media.background&#39;))
        &#125;.borderRadius(&#39;11vp&#39;).clip(true)
        .id(&#39;image&#39;)
        .alignRules(&#123;
          top: &#123;anchor: &quot;__container__&quot;, align: VerticalAlign.Top&#125;,
          bottom:&#123; anchor: &#39;a&#39;, align: VerticalAlign.Top&#125;,
          middle: &#123;anchor: &quot;__container__&quot;, align: HorizontalAlign.Center&#125;
        &#125;)
        .id(&quot;row1&quot;)
        .chainMode(Axis.Vertical, ChainStyle.SPREAD)
        Row().width(80).height(80)
          .backgroundColor(&quot;#FFCC00&quot;)
          .alignRules(&#123;
            top: &#123;anchor: &quot;row1&quot;, align: VerticalAlign.Bottom&#125;,
            bottom: &#123;anchor: &quot;b&quot;, align: VerticalAlign.Top&#125;,
            left: &#123;anchor: &quot;row1&quot;, align: HorizontalAlign.Start&#125;
          &#125;)
          .id(&quot;a&quot;)
        Row().width(80).height(80)
          .backgroundColor(&quot;#FF6633&quot;)
          .alignRules(&#123;
            top: &#123;anchor: &quot;a&quot;, align: VerticalAlign.Bottom&#125;,
            bottom: &#123;anchor: &quot;__container__&quot;, align : VerticalAlign.Bottom&#125;,
            left: &#123;anchor: &quot;row1&quot;, align: HorizontalAlign.Start&#125;
          &#125;)
          .id(&quot;b&quot;)
      &#125;
      .id(&#39;test&#39;)
      .width(300).height(300)
      .margin(&#123;left: 50&#125;)
      .border(&#123;width:2, color: &quot;#6699FF&quot;&#125;)
    &#125;
    .height(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h4 id="3-When-using-CustomDialog-to-decorate-a-pop-up-using-ObjectLink-causes-an-error-Can-it-be-decorated-with-Component-simultaneously"><a href="#3-When-using-CustomDialog-to-decorate-a-pop-up-using-ObjectLink-causes-an-error-Can-it-be-decorated-with-Component-simultaneously" class="headerlink" title="3. When using @CustomDialog to decorate a pop-up, using @ObjectLink causes an error. Can it be decorated with @Component simultaneously?"></a>3. When using @CustomDialog to decorate a pop-up, using @ObjectLink causes an error. Can it be decorated with @Component simultaneously?</h4><p>Yes, @Component can decorate a @CustomDialog pop-up component, and decorators work normally. Here’s a sample using @ObjectLink in a dialog:  </p>
<pre><code class="language-typescript">@Observed
class Person &#123;
  name: string = &quot;Jerry&quot;
  age: number = 0
&#125;

@CustomDialog
@Component
struct CustomDialogExample &#123;
  @ObjectLink curPerson: Person
  controller?: CustomDialogController
  build() &#123;
    Column() &#123;
      TextInput(&#123;text: this.curPerson.name&#125;)
        .onChange((input: string) =&gt; &#123;
          this.curPerson.name = input
        &#125;)
        .width(&quot;100%&quot;)
        .height(100)
    &#125;
    .width(&quot;100%&quot;)
    .backgroundColor(Color.White)
    .borderRadius(&#123;topLeft: 32, topRight: 32&#125;)
  &#125;
&#125;
@Entry
@Component
struct CustomDialogTest &#123;
  @State person: Person = new Person()
  dialogController: CustomDialogController = new CustomDialogController(&#123;
    builder: CustomDialogExample(&#123;curPerson: this.person&#125;),
    alignment: DialogAlignment.Bottom,
    customStyle: true
  &#125;)
  build() &#123;
    RelativeContainer() &#123;
      Text(this.person.name)
        .id(&#39;HelloWorld&#39;)
        .fontSize(50)
        .fontWeight(FontWeight.Bold)
        .alignRules(&#123;
          center: &#123; anchor: &#39;container&#39;, align: VerticalAlign.Center &#125;,
          middle: &#123; anchor: &#39;container&#39;, align: HorizontalAlign.Center &#125;
        &#125;)
        .onClick(() =&gt; &#123;
          this.dialogController.open()
        &#125;)
    &#125;
    .height(&#39;100%&#39;)
    .width(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h4 id="4-Does-HarmonyOS-have-a-state-manager-similar-to-Flutter’s-provider"><a href="#4-Does-HarmonyOS-have-a-state-manager-similar-to-Flutter’s-provider" class="headerlink" title="4. Does HarmonyOS have a state manager similar to Flutter’s provider?"></a>4. Does HarmonyOS have a state manager similar to Flutter’s provider?</h4><p>Refer to the state management documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-state-management-overview-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-state-management-overview-V5</a>  </p>
<p>In declarative UI frameworks, the UI is a function of the program’s state. When state parameters change, the UI updates accordingly. This mechanism in ArkUI is called state management.  </p>
<p>Custom components use variables decorated by decorators to become state variables. Changes to state variables trigger UI re-rendering. Without state variables, the UI only renders once during initialization.  </p>
<h4 id="5-How-to-set-relative-positions-for-child-controls-in-a-HarmonyOS-Stack"><a href="#5-How-to-set-relative-positions-for-child-controls-in-a-HarmonyOS-Stack" class="headerlink" title="5. How to set relative positions for child controls in a HarmonyOS Stack?"></a>5. How to set relative positions for child controls in a HarmonyOS Stack?</h4><p>Setting <code>align(Alignment.End)</code> fails to place a close button on the far right. Use the following approach:  </p>
<pre><code class="language-typescript">.alignRules(&#123;
  top: &#123;anchor: &quot;__container__&quot;, align: VerticalAlign.Top&#125;,
  left: &#123;anchor: &quot;__container__&quot;, align: HorizontalAlign.Start&#125;
&#125;)
</code></pre>
<p>For specific examples, refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-relativecontainer-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-relativecontainer-V5</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/321-Daily-HarmonyOS-Next-Knowledge-Dark-Mode-App-Management-Window-Callback-Manual-Refresh-Trigger-Image-Caching-Sandbox-Access/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/321-Daily-HarmonyOS-Next-Knowledge-Dark-Mode-App-Management-Window-Callback-Manual-Refresh-Trigger-Image-Caching-Sandbox-Access/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Dark Mode, App Management Window Callback, Manual Refresh Trigger, Image Caching, Sandbox Access</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:25:39 / Modified: 22:26:51" itemprop="dateCreated datePublished" datetime="2025-06-26T22:25:39+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Dark-Mode-App-Management-Window-Callback-Manual-Refresh-Trigger-Image-Caching-Sandbox-Access"><a href="#Daily-HarmonyOS-Next-Knowledge-Dark-Mode-App-Management-Window-Callback-Manual-Refresh-Trigger-Image-Caching-Sandbox-Access" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Dark Mode, App Management Window Callback, Manual Refresh Trigger, Image Caching, Sandbox Access"></a>[Daily HarmonyOS Next Knowledge] Dark Mode, App Management Window Callback, Manual Refresh Trigger, Image Caching, Sandbox Access</h3><h4 id="1-Can-the-App-style-be-set-to-dark-mode-in-HarmonyOS"><a href="#1-Can-the-App-style-be-set-to-dark-mode-in-HarmonyOS" class="headerlink" title="1. Can the App style be set to dark mode in HarmonyOS?"></a>1. Can the App style be set to dark mode in HarmonyOS?</h4><p>Can the App style be set to dark mode?  </p>
<p>For setting dark mode, refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-dark-mode-adaptation">https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-dark-mode-adaptation</a>  </p>
<p><strong>Dark Mode</strong> (also known as暗色模式) is a UI theme that contrasts with the light mode commonly used in daily applications. Originating from human-computer interaction research and practice, dark mode is not merely changing the background to black and text to white but provides a comprehensive color theme adapted to dark environments. Compared to light mode, dark mode is gentler, reducing eye strain and fatigue from brightness. Additionally, it can lower application power consumption and improve battery life.  </p>
<p>To adapt to dark mode, applications should follow basic UX design principles to ensure readability, comfort, and consistency of page content, as detailed in the dark mode design principles. The adaptation process mainly includes:  </p>
<ul>
<li>Adapting color resources (font colors, element background colors).  </li>
<li>Adapting media resources (images, icons).  </li>
<li>Adapting the system status bar.  </li>
<li>Handling special cases (e.g., Web pages loaded by Web components).</li>
</ul>
<p><strong>Implementation Principle</strong>:<br>When the system switches to dark mode, some in-app elements (e.g., status bar, pop-up backgrounds, system controls) may automatically switch to dark themes, potentially causing layout inconsistencies. To address this, content adaptation for dark mode relies primarily on resource directories. When system settings change (e.g., language, light&#x2F;dark mode), the app automatically loads resources from the corresponding directory.  </p>
<p>The system reserves a <code>dark</code> directory for dark mode (not created by default). Developers must manually create <code>src/main/resources/dark</code> and place dark-mode resources there, while light-mode resources go into the default <code>src/main/resources/base</code> directory.  </p>
<p>Typically, light&#x2F;dark mode switching maintains page structure but changes theme colors and images to ensure aesthetic consistency. Below is a UX example of dark mode adaptation:<br><img src="/../images/66%E3%80%81Vue.js%20%E4%B8%8E%20RESTful%20API%20%E9%9B%86%E6%88%90%20%E4%B9%8B%20%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8.png"></p>
<p>Key adaptation items for dark mode include:  </p>
<ul>
<li>Color resource adaptation  </li>
<li>Media resource adaptation  </li>
<li>Status bar adaptation  </li>
<li>Web page adaptation (if using Web components)</li>
</ul>
<p>Common methods for enabling light&#x2F;dark mode switching:  </p>
<ul>
<li><strong>Follow system mode</strong>: Use <code>setColorMode(COLOR_MODE_NOT_SET)</code> to allow the app to automatically detect system mode changes and switch accordingly.  </li>
<li><strong>Manual in-app control</strong>: Call <code>setColorMode(COLOR_MODE_DARK)</code> for dark mode or <code>COLOR_MODE_LIGHT</code> for light mode.</li>
</ul>
<h4 id="2-Does-HarmonyOS-provide-an-event-callback-when-an-App-is-swiped-to-the-app-management-window"><a href="#2-Does-HarmonyOS-provide-an-event-callback-when-an-App-is-swiped-to-the-app-management-window" class="headerlink" title="2. Does HarmonyOS provide an event callback when an App is swiped to the app management window?"></a>2. Does HarmonyOS provide an event callback when an App is swiped to the app management window?</h4><p>When playing a video and swiping the App to the app management window, the video continues playing. Is there an event to listen for this swipe?  </p>
<p>Refer to window event listening: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-window-V5#offwindowevent10">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-window-V5#offwindowevent10</a>  </p>
<p><strong>Demo</strong>:  </p>
<pre><code class="language-typescript">curWindow: window.Window | undefined = undefined;
context: common.UIAbilityContext = getContext(this) as common.UIAbilityContext
async aboutToAppear(): Promise&lt;void&gt; &#123;
  if (this.context) &#123;
  window.getLastWindow(getContext(this), (err, data) =&gt; &#123;
  this.curWindow = data
  if (this.curWindow) &#123;
  this.curWindow.on(&#39;windowEvent&#39;, (data) =&gt; &#123;
  console.info(&#39;Window event happened. Event:&#39; + JSON.stringify(data));
  if (data.toString() == &#39;6&#39;) &#123;
  this.videoPlayerModel.controller.pause();
&#125;
</code></pre>
<h4 id="3-Can-HarmonyOS-Refresh-trigger-pull-to-refresh-via-a-method-call"><a href="#3-Can-HarmonyOS-Refresh-trigger-pull-to-refresh-via-a-method-call" class="headerlink" title="3. Can HarmonyOS Refresh trigger pull-to-refresh via a method call?"></a>3. Can HarmonyOS Refresh trigger pull-to-refresh via a method call?</h4><p>Refresh can be triggered by controlling the <code>refreshing</code> parameter, which indicates whether the component is refreshing.  </p>
<p>Refer to the documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-refresh-V5#ZH-CN_TOPIC_0000001930756929__refreshoptions%E5%AF%B9%E8%B1%A1%E8%AF%B4%E6%98%8E">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-refresh-V5#ZH-CN_TOPIC_0000001930756929__refreshoptions%E5%AF%B9%E8%B1%A1%E8%AF%B4%E6%98%8E</a>  </p>
<p><strong>Demo</strong>:  </p>
<pre><code class="language-typescript">// xxx.ets
@Entry
@Component
struct RefreshExample &#123;
  @State isRefreshing: boolean = false
  @State arr: String[] = [&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;,&#39;10&#39;]

  build() &#123;
    Column() &#123;
      Button(&#39;Refresh&#39;).onClick(()=&gt;&#123;
        this.isRefreshing = true
      &#125;)
      Refresh(&#123; refreshing: $$this.isRefreshing&#125;) &#123;
        List() &#123;
          ForEach(this.arr, (item: string) =&gt; &#123;
            ListItem() &#123;
              Text(&#39;&#39; + item)
                .width(&#39;100%&#39;).height(100).fontSize(16)
                .textAlign(TextAlign.Center).borderRadius(10).backgroundColor(0xFFFFFF)
            &#125;
          &#125;, (item: string) =&gt; item)
        &#125;
        .onScrollIndex((first: number) =&gt; &#123;
          console.info(first.toString())
        &#125;)
        .width(&#39;100%&#39;)
        .height(&#39;100%&#39;)
        .divider(&#123;strokeWidth:1,color:Color.Yellow,startMargin:10,endMargin:10&#125;)
        .scrollBar(BarState.Off)
      &#125;
      .onStateChange((refreshStatus: RefreshStatus) =&gt; &#123;
        console.info(&#39;Refresh onStatueChange state is &#39; + refreshStatus)
      &#125;)
      .onOffsetChange((value: number) =&gt; &#123;
        console.info(&#39;Refresh onOffsetChange offset:&#39; + value)
      &#125;)
      .onRefreshing(() =&gt; &#123;
        setTimeout(() =&gt; &#123;
          this.isRefreshing = false
        &#125;, 2000)
        console.log(&#39;onRefreshing test&#39;)
      &#125;)
      .backgroundColor(0x89CFF0)
      .refreshOffset(64)
      .pullToRefresh(true)
    &#125;
  &#125;
&#125;
</code></pre>
<h4 id="4-Does-the-HarmonyOS-Image-component-support-cache-loading"><a href="#4-Does-the-HarmonyOS-Image-component-support-cache-loading" class="headerlink" title="4. Does the HarmonyOS Image component support cache loading?"></a>4. Does the HarmonyOS Image component support cache loading?</h4><p>Does the official Image component support loading cached images when there is no network? For example, can an image be loaded from cache if a URL is set but no network is available?  </p>
<p>The Image component supports caching via <code>setImageRawDataCacheSize</code> and <code>setImageCacheCount</code>, using a built-in LRU strategy. When caching is enabled:  </p>
<ul>
<li>The first load reads the network image.  </li>
<li>Subsequent loads read from the cache.</li>
</ul>
<p>Refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-system-app-V5#setimagecachecount7">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-system-app-V5#setimagecachecount7</a>  </p>
<h4 id="5-How-to-access-sandbox-paths-in-HarmonyOS-ArkTS"><a href="#5-How-to-access-sandbox-paths-in-HarmonyOS-ArkTS" class="headerlink" title="5. How to access sandbox paths in HarmonyOS ArkTS?"></a>5. How to access sandbox paths in HarmonyOS ArkTS?</h4><p>Local paths of sent image messages may be sandbox paths, but the Image control cannot display them directly.  </p>
<p><strong>Solution</strong>:<br>The Image component requires a sandbox URI instead of a path. Convert the sandbox path to a URI using <code>@ohos.file.fileuri.getUriFromPath(file.path)</code>:  </p>
<pre><code class="language-typescript">this.ImageUri = fileUri.getUriFromPath(ImagePath);
</code></pre>
<p>Refer to the API documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-file-fileuri-V5#ZH-CN_TOPIC_0000001884918402__fileurigeturifrompath">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-file-fileuri-V5#ZH-CN_TOPIC_0000001884918402__fileurigeturifrompath</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/320-Daily-HarmonyOS-Next-Knowledge-Asynchronous-Interface-Judgment-Event-Bubbling-Split-Screen-Disable-Long-Screenshot-Screenshot-Prevention/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/320-Daily-HarmonyOS-Next-Knowledge-Asynchronous-Interface-Judgment-Event-Bubbling-Split-Screen-Disable-Long-Screenshot-Screenshot-Prevention/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Asynchronous Interface Judgment, Event Bubbling, Split-Screen Disable, Long Screenshot, Screenshot Prevention</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:24:29 / Modified: 22:24:51" itemprop="dateCreated datePublished" datetime="2025-06-26T22:24:29+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Asynchronous-Interface-Judgment-Event-Bubbling-Split-Screen-Disable-Long-Screenshot-Screenshot-Prevention"><a href="#Daily-HarmonyOS-Next-Knowledge-Asynchronous-Interface-Judgment-Event-Bubbling-Split-Screen-Disable-Long-Screenshot-Screenshot-Prevention" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Asynchronous Interface Judgment, Event Bubbling, Split-Screen Disable, Long Screenshot, Screenshot Prevention"></a>[Daily HarmonyOS Next Knowledge] Asynchronous Interface Judgment, Event Bubbling, Split-Screen Disable, Long Screenshot, Screenshot Prevention</h3><h4 id="1-How-do-HarmonyOS-developers-independently-determine-if-an-interface-is-asynchronous"><a href="#1-How-do-HarmonyOS-developers-independently-determine-if-an-interface-is-asynchronous" class="headerlink" title="1. How do HarmonyOS developers independently determine if an interface is asynchronous?"></a>1. How do HarmonyOS developers independently determine if an interface is asynchronous?</h4><p><strong>How to independently determine an asynchronous interface?</strong>  </p>
<p>Asynchronous concurrency is implemented via Promise and async&#x2F;await. Interfaces using these implementations can be considered asynchronous. For details, refer to the documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/async-concurrency-overview-V5?catalogVersion=V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/async-concurrency-overview-V5?catalogVersion=V5</a>  </p>
<p>Promise and async&#x2F;await provide asynchronous concurrency capabilities and follow standard JS asynchronous syntax. Asynchronous code is suspended and resumed later, with only one code segment executing at a time. This suits single I&#x2F;O tasks like network requests or file read&#x2F;write operations, eliminating the need for additional threads.  </p>
<p>Asynchronous syntax is a programming language feature allowing programs to execute other operations without waiting for certain tasks to complete.  </p>
<p><strong>Promise</strong>: An object for handling asynchronous operations, converting them into a synchronous-like style for easier coding and maintenance. It uses a state mechanism to manage asynchronous phases and provides methods to register callbacks for successful or failed outcomes.  </p>
<ul>
<li><strong>Promise states</strong>: pending (in progress), fulfilled (completed), rejected (failed).  </li>
<li><strong>Basic usage</strong>: Instantiate via a constructor with an executor function taking <code>resolve</code> (success callback) and <code>reject</code> (failure callback). Example:</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">promise</span>: <span class="title class_">Promise</span>&lt;<span class="built_in">number</span>&gt; = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params"><span class="attr">resolve</span>: <span class="title class_">Function</span>, <span class="attr">reject</span>: <span class="title class_">Function</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">randomNumber</span>: <span class="built_in">number</span> = <span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line">    <span class="keyword">if</span> (randomNumber &gt; <span class="number">0.5</span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(randomNumber);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Random number is too small&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**async/await**: A Promise syntax sugar for handling asynchronous operations, simplifying and enhancing readability. Declare a function as asynchronous with `</span><span class="keyword">async</span><span class="string">` and use `</span><span class="keyword">await</span><span class="string">` to wait for Promise resolution.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- An `</span><span class="keyword">async</span><span class="string">` function returns a Promise, representing an asynchronous operation. `</span><span class="keyword">await</span><span class="string">` waits for Promise resolution and returns its value. If an exception is thrown, the returned Promise is rejected.  </span></span><br><span class="line"><span class="string">- Example simulating a synchronous-style asynchronous operation:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">myAsyncFunction</span>(<span class="params"></span>): <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">result</span>: <span class="built_in">string</span> = <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params"><span class="attr">resolve</span>: <span class="title class_">Function</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="string">&#x27;Hello, world!&#x27;</span>);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">info</span>(result); <span class="comment">// Output: Hello, world!</span></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">message</span>: <span class="built_in">string</span> = <span class="string">&#x27;Hello World&#x27;</span>;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">message</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">            <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="title function_">myAsyncFunction</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;res is: &quot;</span> + res);</span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 2. How are event bubbling and event delegation implemented in HarmonyOS NEXT?  </span></span><br><span class="line"><span class="string">For event bubbling, refer to the documentation: https://gitee.com/sunfei2021/ace-test-source/blob/master/specs/event_spec.md#%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E6%B5%81%E7%A8%8B  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Touch events include three complete phases:  </span></span><br><span class="line"><span class="string">- **Event touch test**: Triggered on touch down (TouchDown). Starting from the root node, a hit test finds the event distribution path via touch coordinates.  </span></span><br><span class="line"><span class="string">- **Event distribution**: Distributes events sequentially along the path generated by the touch test (gesture recognition occurs here).  </span></span><br><span class="line"><span class="string">- **Event response bubbling**: When reaching a leaf node, if the node can respond, the event triggers and bubbles up to parent nodes for response.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>mermaid</span><br><span class="line">graph <span class="variable constant_">TD</span></span><br><span class="line">    S[<span class="title class_">Start</span> <span class="keyword">from</span> root node] --&gt; A</span><br><span class="line">    A[<span class="title class_">Acquire</span> node] --&gt; B[<span class="title class_">Get</span> current touch point coordinates]</span><br><span class="line">    B --&gt; C[<span class="title class_">Process</span> affine transformation <span class="keyword">of</span> current node]</span><br><span class="line">    C --&gt; <span class="variable constant_">ENABLE</span>&#123;<span class="title class_">Is</span> event disabled?&#125;</span><br><span class="line">    <span class="variable constant_">ENABLE</span> --<span class="variable constant_">NO</span>--&gt; I&#123;<span class="title class_">HitTestMode</span> is <span class="title class_">None</span>?&#125;</span><br><span class="line">    <span class="variable constant_">ENABLE</span> -- <span class="variable constant_">YES</span> --&gt; G&#123;<span class="title class_">Is</span> there a next sibling?&#125;</span><br><span class="line">    I --<span class="variable constant_">YES</span>--&gt; H[<span class="title class_">Convert</span> touch point to child node coordinate system]</span><br><span class="line">    I --<span class="variable constant_">NO</span>--&gt; E&#123;<span class="title class_">Is</span> touch point within current node<span class="string">&#x27;s hit area?&#125;</span></span><br><span class="line"><span class="string">    E -- YES --&gt; F[Add current node to event distribution list]</span></span><br><span class="line"><span class="string">    E -- NO --&gt; G</span></span><br><span class="line"><span class="string">    F --&gt; H</span></span><br><span class="line"><span class="string">    H --&gt; D&#123;HitTestMode is Block?&#125;</span></span><br><span class="line"><span class="string">    D --YES--&gt; L</span></span><br><span class="line"><span class="string">    D --NO--&gt; K&#123;Are there child nodes?&#125;</span></span><br><span class="line"><span class="string">    G --YES--&gt; A</span></span><br><span class="line"><span class="string">    G --NO--&gt; L&#123;Is there a parent node?&#125;</span></span><br><span class="line"><span class="string">    K --YES--&gt; A</span></span><br><span class="line"><span class="string">    K --NO--&gt; L</span></span><br><span class="line"><span class="string">    L --YES--&gt; M&#123;Parent node HitTestMode is None or Transparent?&#125;</span></span><br><span class="line"><span class="string">    L --NO--&gt; J[End]</span></span><br><span class="line"><span class="string">    M --YES--&gt; G</span></span><br><span class="line"><span class="string">    M --NO--&gt; L</span></span><br><span class="line"><span class="string">```  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Touch test process specifications**:  </span></span><br><span class="line"><span class="string">- Touch testing is required only for single-point touch down (TouchDown).  </span></span><br><span class="line"><span class="string">- The starting node is the window root, with coordinates relative to the window.  </span></span><br><span class="line"><span class="string">- Subsequent tests use coordinates relative to the parent node.  </span></span><br><span class="line"><span class="string">- Check if the touch point falls within the node&#x27;</span>s hit <span class="title function_">area</span> (set by <span class="string">`responseRegion`</span>, defaulting to the display area).  </span><br><span class="line">- <span class="title class_">The</span> <span class="keyword">default</span> hit area includes the border.  </span><br><span class="line">- <span class="title class_">Consider</span> the node<span class="string">&#x27;s graphic transformations relative to the parent.  </span></span><br><span class="line"><span class="string">- Account for `hitTestBehavior` (general attribute) and `enabled` (blocks self-testing, not siblings).  </span></span><br><span class="line"><span class="string">- Siblings are traversed in descending order of `zIndex` (or reverse order if no `zIndex`).  </span></span><br><span class="line"><span class="string">- Nodes meeting test conditions form a distribution tree for subsequent event distribution.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 3. How to disable app split-screen or floating window display in HarmonyOS?  </span></span><br><span class="line"><span class="string">**Disable split-screen or floating window display by setting `supportWindowMode`**: Identifies the window modes supported by the UIAbility component. Values include:  </span></span><br><span class="line"><span class="string">- `fullscreen`: Full-screen mode.  </span></span><br><span class="line"><span class="string">- `split`: Split-screen mode.  </span></span><br><span class="line"><span class="string">- `floating`: Floating window mode.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/module-configuration-file-V5#abilities%E6%A0%87%E7%AD%BE  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To disable split-screen/floating window, set `supportWindowMode` to `[&quot;fullscreen&quot;]`.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 4. When taking a long screenshot in HarmonyOS, why does the underlying page get captured if multiple pages reuse the same ID?  </span></span><br><span class="line"><span class="string">When using the screenshot component, ensure unique component IDs. Reusing IDs will reference the first component.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 5. How to prevent screenshots in HarmonyOS?  </span></span><br><span class="line"><span class="string">To enable screenshot prevention on a specific page, follow these steps and refer to the demo:  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. **Declare permission in module.json5**:  </span></span><br><span class="line"><span class="string">```json</span></span><br><span class="line"><span class="string">&quot;requestPermissions&quot;: [</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    &quot;name&quot;: &quot;ohos.permission.PRIVACY_WINDOW&quot;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">```  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. **Sample code**:  </span></span><br><span class="line"><span class="string">```typescript</span></span><br><span class="line"><span class="string">// windowUtils.ets</span></span><br><span class="line"><span class="string">import window from &#x27;</span><span class="meta">@ohos</span>.<span class="property">window</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string">import common from &#x27;</span><span class="meta">@ohos</span>.<span class="property">app</span>.<span class="property">ability</span>.<span class="property">common</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string">export class windowUtils &#123;</span></span><br><span class="line"><span class="string">  static setWindowPrivacyModeInPage(context: common.UIAbilityContext, isFlag: boolean) &#123;</span></span><br><span class="line"><span class="string">    window.getLastWindow(context).then((lastWindow)=&gt;&#123;</span></span><br><span class="line"><span class="string">      lastWindow.setWindowPrivacyMode(isFlag);</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// Page</span></span><br><span class="line"><span class="string">import common from &#x27;</span><span class="meta">@ohos</span>.<span class="property">app</span>.<span class="property">ability</span>.<span class="property">common</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string">import &#123; windowUtils &#125; from &#x27;</span>../common/windowUtils<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">@Entry</span></span><br><span class="line"><span class="string">@Component</span></span><br><span class="line"><span class="string">struct Index3 &#123;</span></span><br><span class="line"><span class="string">  @State message: string = &#x27;</span><span class="title class_">Hello</span> <span class="title class_">World</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string">  onPageShow(): void &#123;</span></span><br><span class="line"><span class="string">    windowUtils.setWindowPrivacyModeInPage(getContext(this) as common.UIAbilityContext, true);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  onPageHide() &#123;</span></span><br><span class="line"><span class="string">    windowUtils.setWindowPrivacyModeInPage(getContext(this) as common.UIAbilityContext, false);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  build() &#123;</span></span><br><span class="line"><span class="string">    Row() &#123;</span></span><br><span class="line"><span class="string">      Column() &#123;</span></span><br><span class="line"><span class="string">        Text(this.message)</span></span><br><span class="line"><span class="string">          .fontSize(50)</span></span><br><span class="line"><span class="string">          .fontWeight(FontWeight.Bold)</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">      .width(&#x27;</span><span class="number">100</span>%<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    .height(&#x27;</span><span class="number">100</span>%<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/319-Daily-HarmonyOS-Next-Knowledge-Text-Height-Calculation-Control-Background-Animation-Dotted-Line-Functionality-Screenshot-Prevention-Entry-Home-Page-Replacement/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/319-Daily-HarmonyOS-Next-Knowledge-Text-Height-Calculation-Control-Background-Animation-Dotted-Line-Functionality-Screenshot-Prevention-Entry-Home-Page-Replacement/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Text Height Calculation, Control Background Animation, Dotted Line Functionality, Screenshot Prevention, Entry Home Page Replacement</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:23:08 / Modified: 22:29:04" itemprop="dateCreated datePublished" datetime="2025-06-26T22:23:08+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Text-Height-Calculation-Control-Background-Animation-Dotted-Line-Functionality-Screenshot-Prevention-Entry-Home-Page-Replacement"><a href="#Daily-HarmonyOS-Next-Knowledge-Text-Height-Calculation-Control-Background-Animation-Dotted-Line-Functionality-Screenshot-Prevention-Entry-Home-Page-Replacement" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Text Height Calculation, Control Background Animation, Dotted Line Functionality, Screenshot Prevention, Entry Home Page Replacement"></a>[Daily HarmonyOS Next Knowledge] Text Height Calculation, Control Background Animation, Dotted Line Functionality, Screenshot Prevention, Entry Home Page Replacement</h3><h4 id="1-How-to-calculate-the-height-of-a-HarmonyOS-Text-component"><a href="#1-How-to-calculate-the-height-of-a-HarmonyOS-Text-component" class="headerlink" title="1. How to calculate the height of a HarmonyOS Text component?"></a>1. How to calculate the height of a HarmonyOS Text component?</h4><p>When the backend returns copy, the height of the displayed text needs to be calculated based on its width.  </p>
<p>Use <code>measure.measureTextSize</code> to calculate text height. Reference documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-measure-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-measure-V5</a>  </p>
<p>The <code>@ohos.measure</code> module provides text width and height calculations:  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MeasureText</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="attr">textSize</span>: <span class="title class_">SizeOptions</span> = <span class="title class_">MeasureText</span>.<span class="title function_">measureTextSize</span>(&#123;</span><br><span class="line">    <span class="comment">// It is recommended to use this.getUIContext().getMeasureUtils().measureText()</span></span><br><span class="line">    <span class="attr">textContent</span>: <span class="string">&quot;Hello World&quot;</span>,</span><br><span class="line">    <span class="attr">fontSize</span>: <span class="string">&#x27;50px&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`The width of &#x27;Hello World&#x27;: <span class="subst">$&#123;<span class="variable language_">this</span>.textSize.width&#125;</span>`</span>)</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">`The height of &#x27;Hello World&#x27;: <span class="subst">$&#123;<span class="variable language_">this</span>.textSize.height&#125;</span>`</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 2. How to animate a control&#x27;s background using linearGradient and animation when a Column appears in HarmonyOS?  </span></span><br><span class="line"><span class="string">The following animation approach is ineffective:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="title class_">Row</span>()</span><br><span class="line">  .<span class="title function_">alignItems</span>(<span class="title class_">VerticalAlign</span>.<span class="property">Center</span>)</span><br><span class="line">  .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  .<span class="title function_">height</span>(<span class="string">&#x27;32lpx&#x27;</span>)</span><br><span class="line">  .<span class="title function_">animatableBgColor</span>(<span class="variable language_">this</span>.<span class="title function_">bgColor</span>(item.<span class="property">type</span>), <span class="variable language_">this</span>.<span class="property">animationVal</span>)</span><br><span class="line">  .<span class="title function_">onAppear</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (index === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="title function_">animateTo</span>(&#123;</span><br><span class="line">        <span class="attr">delay</span>: <span class="number">200</span>, <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">animationVal</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">animationVal</span> = <span class="number">1</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@AnimatableExtend</span>(<span class="title class_">Row</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">animatableBgColor</span>(<span class="params"><span class="attr">colors</span>: <span class="built_in">string</span>[], <span class="attr">position</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  .<span class="title function_">linearGradient</span>(position === <span class="number">0</span> ? &#123;</span><br><span class="line">    <span class="attr">colors</span>: [</span><br><span class="line">      [<span class="string">&#x27;#00000000&#x27;</span>, <span class="number">0.0</span>],</span><br><span class="line">      [<span class="string">&#x27;#00000000&#x27;</span>, <span class="number">1.0</span>],</span><br><span class="line">    ]</span><br><span class="line">  &#125; : &#123;</span><br><span class="line">    <span class="attr">angle</span>: <span class="number">90</span>,</span><br><span class="line">    <span class="attr">colors</span>: [</span><br><span class="line">      [colors[<span class="number">0</span>], <span class="number">0.0</span>],</span><br><span class="line">      [colors[<span class="number">1</span>], position],</span><br><span class="line">      [colors[<span class="number">2</span>], <span class="number">1.0</span>],</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Refer to the demo below:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Page2</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">linearGradientParam</span>: <span class="built_in">number</span> = <span class="number">0.1</span></span><br><span class="line">  <span class="meta">@State</span> <span class="attr">animationVal</span>: <span class="built_in">number</span> = <span class="number">1</span></span><br><span class="line">  <span class="meta">@State</span> <span class="attr">flage</span>: <span class="built_in">boolean</span> = <span class="literal">false</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;Test&#x27;</span>).<span class="title function_">fontSize</span>(<span class="string">&#x27;32lpx&#x27;</span>).<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Medium</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;228lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">height</span>(<span class="string">&#x27;88lpx&#x27;</span>)</span><br><span class="line">      .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">      .<span class="title function_">alignItems</span>(<span class="title class_">HorizontalAlign</span>.<span class="property">Center</span>)</span><br><span class="line">      <span class="comment">// Set the color to transparent</span></span><br><span class="line">      .<span class="title function_">linearGradient</span>(&#123;</span><br><span class="line">        <span class="attr">angle</span>: <span class="string">&#x27;109.26deg&#x27;</span>,</span><br><span class="line">        <span class="attr">colors</span>: [</span><br><span class="line">          [<span class="variable language_">this</span>.<span class="property">animationVal</span> === <span class="number">0</span> ? <span class="title class_">Color</span>.<span class="property">Transparent</span> : (<span class="variable language_">this</span>.<span class="property">flage</span> ? <span class="title class_">Color</span>.<span class="property">Transparent</span> : <span class="string">&#x27;#008c8c&#x27;</span>), <span class="number">0.1</span>],</span><br><span class="line">          [<span class="variable language_">this</span>.<span class="property">animationVal</span> === <span class="number">0</span> ? <span class="title class_">Color</span>.<span class="property">Transparent</span> : (<span class="variable language_">this</span>.<span class="property">flage</span> ? <span class="title class_">Color</span>.<span class="property">Transparent</span> : <span class="string">&#x27;rgba(255, 255, 255, 0.4)&#x27;</span>), <span class="number">0.5</span>],</span><br><span class="line">        ]</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">onAppear</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;console&#x27;</span>, <span class="variable language_">this</span>.<span class="property">animationVal</span>);</span><br><span class="line">        <span class="title function_">animateTo</span>(&#123;</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">2000</span>, <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;animation finish&quot;</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">animationVal</span> = <span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;click&#x27;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;console&#x27;</span>, <span class="variable language_">this</span>.<span class="property">animationVal</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;aboutToAppear&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">animationVal</span> === <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">flage</span> = <span class="literal">false</span></span><br><span class="line">          <span class="title function_">animateTo</span>(&#123;</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">2000</span>, <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;animation finish&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">animationVal</span> = <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="title function_">animateTo</span>(&#123;</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">2000</span>, <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;animation finish&quot;</span>)</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">flage</span> = !<span class="variable language_">this</span>.<span class="property">flage</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">animationVal</span> = <span class="number">1</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 3. How to implement dotted lines in HarmonyOS?  </span></span><br><span class="line"><span class="string">Refer to the demo:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="title class_">Divider</span>().<span class="title function_">height</span>(<span class="number">0</span>).<span class="title function_">border</span>(&#123; <span class="attr">width</span>: &#123;<span class="attr">left</span>:<span class="number">0</span>,<span class="attr">right</span>:<span class="number">0</span>,<span class="attr">top</span>:<span class="number">0</span>,<span class="attr">bottom</span>:<span class="number">2</span>&#125;,<span class="attr">color</span>:<span class="title class_">Color</span>.<span class="property">Grey</span>, <span class="attr">style</span>: <span class="title class_">BorderStyle</span>.<span class="property">Dashed</span> &#125;)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 4. Why can screenshots still be taken after setting setWindowPrivacyMode in HarmonyOS?  </span></span><br><span class="line"><span class="string">Check if the following code is added to module.json5. `</span>setWindowPrivacyMode<span class="string">` requires the `</span>ohos.<span class="property">permission</span>.<span class="property">PRIVACY_WINDOW</span><span class="string">` permission:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>json</span><br><span class="line">&#123;<span class="string">&quot;name&quot;</span> : <span class="string">&quot;ohos.permission.PRIVACY_WINDOW&quot;</span>&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 5. How to replace the home page in an entry in HarmonyOS?  </span></span><br><span class="line"><span class="string">Using `</span>router.<span class="title function_">replaceUrl</span>(&#123;<span class="attr">url</span>: <span class="string">&#x27;pages/Home&#x27;</span>&#125;)<span class="string">` in the entry can only find routes within the entry&#x27;s HSP. To navigate to pages in shared packages (HAR/HSP), use named routes.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Reference documentation: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-routing-V5#%E5%91%BD%E5%90%8D%E8%B7%AF%E7%94%B1  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Steps for shared package routing**:  </span></span><br><span class="line"><span class="string">1. In the shared package (HAR/HSP) page to which you want to navigate, name the @Entry-decorated component:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="comment">// library/src/main/ets/pages/Index.ets</span></span><br><span class="line"><span class="meta">@Entry</span>(&#123; <span class="attr">routeName</span>: <span class="string">&#x27;myPage&#x27;</span> &#125;)</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">export</span> struct <span class="title class_">MyComponent</span> &#123;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&#x27;Library Page&#x27;</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2. Import the named route in the source page and use `</span>pushNamedRoute<span class="string">`:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BusinessError</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@ohos/library/src/main/ets/pages/Index&#x27;</span>; <span class="comment">// Import the named route page in the shared package</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Flex</span>(&#123; <span class="attr">direction</span>: <span class="title class_">FlexDirection</span>.<span class="property">Column</span>, <span class="attr">alignItems</span>: <span class="title class_">ItemAlign</span>.<span class="property">Center</span>, <span class="attr">justifyContent</span>: <span class="title class_">FlexAlign</span>.<span class="property">Center</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;Hello World&#x27;</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">        .<span class="title function_">margin</span>(&#123; <span class="attr">top</span>: <span class="number">20</span> &#125;)</span><br><span class="line">        .<span class="title function_">backgroundColor</span>(<span class="string">&#x27;#ccc&#x27;</span>)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">getUIContext</span>().<span class="title function_">getRouter</span>().<span class="title function_">pushNamedRoute</span>(&#123;</span><br><span class="line">              <span class="attr">name</span>: <span class="string">&#x27;myPage&#x27;</span>,</span><br><span class="line">              <span class="attr">params</span>: &#123;</span><br><span class="line">                <span class="attr">data1</span>: <span class="string">&#x27;message&#x27;</span>,</span><br><span class="line">                <span class="attr">data2</span>: &#123;</span><br><span class="line">                  <span class="attr">data3</span>: [<span class="number">123</span>, <span class="number">456</span>, <span class="number">789</span>]</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">let</span> message = (err <span class="keyword">as</span> <span class="title class_">BusinessError</span>).<span class="property">message</span></span><br><span class="line">            <span class="keyword">let</span> code = (err <span class="keyword">as</span> <span class="title class_">BusinessError</span>).<span class="property">code</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`pushNamedRoute failed, code is <span class="subst">$&#123;code&#125;</span>, message is <span class="subst">$&#123;message&#125;</span>`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/318-Daily-HarmonyOS-Next-Knowledge-Popup-Issues-Transparent-Background-Setting-any-Type-Problem-Combination-Gestures-for-Swipe-and-Drag-Desktop-Icon-Specifications/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/318-Daily-HarmonyOS-Next-Knowledge-Popup-Issues-Transparent-Background-Setting-any-Type-Problem-Combination-Gestures-for-Swipe-and-Drag-Desktop-Icon-Specifications/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Popup Issues, Transparent Background Setting, any Type Problem, Combination Gestures for Swipe and Drag, Desktop Icon Specifications</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:21:31 / Modified: 22:22:20" itemprop="dateCreated datePublished" datetime="2025-06-26T22:21:31+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Popup-Issues-Transparent-Background-Setting-any-Type-Problem-Combination-Gestures-for-Swipe-and-Drag-Desktop-Icon-Specifications"><a href="#Daily-HarmonyOS-Next-Knowledge-Popup-Issues-Transparent-Background-Setting-any-Type-Problem-Combination-Gestures-for-Swipe-and-Drag-Desktop-Icon-Specifications" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Popup Issues, Transparent Background Setting, any Type Problem, Combination Gestures for Swipe and Drag, Desktop Icon Specifications"></a>[Daily HarmonyOS Next Knowledge] Popup Issues, Transparent Background Setting, any Type Problem, Combination Gestures for Swipe and Drag, Desktop Icon Specifications</h3><h4 id="1-Problems-with-HarmonyOS-bindPopup"><a href="#1-Problems-with-HarmonyOS-bindPopup" class="headerlink" title="1. Problems with HarmonyOS bindPopup?"></a>1. Problems with HarmonyOS bindPopup?</h4><p>Added a Popup for long-pressing each ListItem.  </p>
<p><strong>Problem 1</strong>: When using a @state variable at the outer level, long-pressing triggers multiple Popups. How to listen and display the Popup for the specific item pressed?  </p>
<p><strong>Problem 2</strong>: After clicking a Popup to delete the current item, how to listen for Popup clicks and make the Popup disappear after deletion?  </p>
<p>Refer to the following demo:  </p>
<pre><code class="language-typescript">import &#123; router &#125; from &#39;@kit.ArkUI&#39;
import &#123; BusinessError &#125; from &#39;@kit.BasicServicesKit&#39;

@Entry
@Component
export struct Index &#123;
  @State list: stockListData = new stockListData([])

  aboutToAppear(): void &#123;
    const list: ItemInfo[] = []
    for (let i = 0; i &lt; 50; ++i) &#123;
      let stockName = &quot;item&quot; + i
      let bgState = 0
      list.push(new ItemInfo(stockName, bgState))
    &#125;
    this.list.modifyAllData(list)

  &#125;

  build() &#123;
    Column() &#123;
      Text(&quot;Start&quot;).height(&#39;50&#39;)
        .width(&#39;100%&#39;).onClick(() =&gt; &#123;
      &#125;)
      List(&#123; space: 10 &#125;) &#123;
        LazyForEach(this.list, (info: ItemInfo, index: number) =&gt; &#123;
          ListItem() &#123;
            ItemView(&#123;
              info: info, itemFun: (name) =&gt; &#123;
                let itemIndex = 0
                for (let im of this.list.getAllData()) &#123;
                  if (im.stockName === name) &#123;
                    break
                  &#125;
                  itemIndex++
                &#125;
                console.info(&quot;animate--ItemView--aboutToReuse---delete Name=&quot; + name)
                this.list.getAllData().splice(itemIndex, 1)
                this.list.notifyDataDelete(itemIndex)
              &#125;
            &#125;)
              .onClick(() =&gt; &#123;
              &#125;)
          &#125;.height(&#39;80&#39;)
        &#125;, (info: ItemInfo, index: number) =&gt; info.stockName + &quot;type&quot; + index)
      &#125;
      .height(&#39;100%&#39;)
      .width(&#39;100%&#39;)
    &#125;
    .height(&#39;100%&#39;)
    .width(&#39;100%&#39;)
  &#125;
&#125;

@Reusable
@Component
struct ItemView &#123;
  @Prop info: ItemInfo
  private lastName: string = &quot;&quot;

  aboutToAppear(): void &#123;
    this.lastName = this.info.stockName
  &#125;

  aboutToReuse(params: Record&lt;string, Object&gt;): void &#123;
    console.info(&quot;animate--ItemView--aboutToReuse---name=&quot; + this.info.stockName + &quot;,lastName=&quot; + this.lastName)

    this.lastName = this.info.stockName
  &#125;

  @State customPopup: boolean = false
  itemFun: (name: string) =&gt; void = (name) =&gt; &#123;
  &#125;

  @Builder
  popItemsView() &#123;
    Text(&quot;qipao pop&quot;).onClick(() =&gt; &#123;
      this.customPopup = !this.customPopup
      this.itemFun(this.info.stockName)
    &#125;)
  &#125;

  build() &#123;
    Column() &#123;
      Flex(&#123; justifyContent: FlexAlign.Center, alignItems: ItemAlign.Center &#125;) &#123;
        Column() &#123;
          Text(this.info.stockName)
            .maxFontSize(&#39;16&#39;)
            .minFontSize(&#39;8&#39;)
            .maxLines(1)
            .margin(&#123; bottom: 2 &#125;)
        &#125;
        .width(&#39;36.27%&#39;)
        .alignItems(HorizontalAlign.Start)
        .padding(&#123; left: &#39;16&#39;, right: 8 &#125;)
      &#125;
      .backgroundColor(&quot;#00ffea&quot;)
      .height(&#39;100%&#39;)
    &#125;
    .bindPopup(this.customPopup, &#123;
      builder: this.popItemsView, // Popup content
      placement: Placement.Top, // Popup position
      offset: &#123; x: 0, y: 30 &#125;,
      radius: 12,
      popupColor: Color.Pink, // Popup background color
      onStateChange: (e) =&gt; &#123;
        console.info(&#39;tag&#39;, JSON.stringify(e.isVisible))
        if (!e.isVisible) &#123;
          this.customPopup = false
          // this.bgColor = this.info.topStatus == 1 ? $r(&#39;app.color.dialog_background&#39;) : $r(&#39;app.color.start_window_background&#39;)
        &#125; else &#123;
          this.customPopup = true
          // this.bgColor = $r(&#39;app.color.dialog_button&#39;)
        &#125;
      &#125;
    &#125;)
    .gesture(
      LongPressGesture(&#123; repeat: false &#125;)// Setting repeat to true triggers continuous long-press events at intervals of duration (default 500ms)
        .onAction((event?: GestureEvent) =&gt; &#123;
          console.log(&quot;tag&quot;, &quot;LongPressGesture start event--customPopup=&quot; + this.customPopup)
          if (event) &#123;
            this.customPopup = !this.customPopup
          &#125;
          // if (event &amp;&amp; event.repeat) &#123;
          // &#125;
        &#125;)// Triggers when the long-press action ends
        .onActionEnd((event?: GestureEvent) =&gt; &#123;
          if (event) &#123;
          &#125;
        &#125;)
    )
  &#125;
&#125;

@Observed
class ItemInfo &#123;
  @Track
  stockName: string = &quot;--&quot;
  @Track
  bgState: number = 0

  constructor(name: string, bg: number) &#123;
    this.stockName = name
    this.bgState = bg
  &#125;
&#125;


class BasicDataSource implements IDataSource &#123;
  private listeners: DataChangeListener[] = [];

  public totalCount(): number &#123;
    return 0;
  &#125;

  public getData(index: number): ItemInfo | undefined &#123;
    return undefined;
  &#125;

  registerDataChangeListener(listener: DataChangeListener): void &#123;
    if (this.listeners.indexOf(listener) &lt; 0) &#123;
      this.listeners.push(listener);
    &#125;
  &#125;

  unregisterDataChangeListener(listener: DataChangeListener): void &#123;
    const position = this.listeners.indexOf(listener);
    if (position &gt;= 0) &#123;
      this.listeners.splice(position, 1);
    &#125;
  &#125;

  notifyDataReload(): void &#123;
    this.listeners.forEach((listener: DataChangeListener) =&gt; &#123;
      listener.onDataReloaded();
    &#125;)
  &#125;

  notifyDataAdd(index: number): void &#123;
    this.listeners.forEach((listener: DataChangeListener) =&gt; &#123;
      listener.onDataAdd(index);
    &#125;)
  &#125;

  notifyDataChange(index: number): void &#123;
    this.listeners.forEach((listener: DataChangeListener) =&gt; &#123;
      listener.onDataChange(index);
    &#125;)
  &#125;

  notifyDataDelete(index: number): void &#123;
    this.listeners.forEach((listener: DataChangeListener) =&gt; &#123;
      listener.onDataDelete(index);
    &#125;)
  &#125;

  notifyDataMove(from: number, to: number): void &#123;
    this.listeners.forEach((listener: DataChangeListener) =&gt; &#123;
      listener.onDataMove(from, to);
    &#125;)
  &#125;
&#125;

export class stockListData extends BasicDataSource &#123;
  private listData: ItemInfo[] = [];

  constructor(dataArray: ItemInfo[]) &#123;
    super()
    this.listData = dataArray;
  &#125;

  public totalCount(): number &#123;
    return this.listData.length;
  &#125;

  public getAllData(): ItemInfo[] &#123;
    return this.listData;
  &#125;

  public getData(index: number): ItemInfo &#123;
    return this.listData[index];
  &#125;

  public modifyAllData(data: ItemInfo[]): void &#123;
    this.listData = data
    this.notifyDataReload()
  &#125;
&#125;
</code></pre>
<h4 id="2-How-to-set-a-transparent-background-for-a-HarmonyOS-Entry-page"><a href="#2-How-to-set-a-transparent-background-for-a-HarmonyOS-Entry-page" class="headerlink" title="2. How to set a transparent background for a HarmonyOS @Entry page?"></a>2. How to set a transparent background for a HarmonyOS @Entry page?</h4><p>For the router routing mode, refer to the following demo:  </p>
<pre><code class="language-typescript">// Page1.ets
import window from &#39;@ohos.window&#39;;

@Entry
@Component
struct Page2 &#123;
  @State message: string = &#39;page Page2&#39;;

  onPageHide() &#123;
    console.log(&quot;pageHide&quot;)
  &#125;

  build() &#123;
    Row() &#123;
      Column() &#123;
        Text(this.message)
          .fontSize(50)
          .fontWeight(FontWeight.Bold)
        Button(&quot;pageB&quot;).onClick(() =&gt; &#123;
          let windowStege: window.WindowStage = AppStorage.get(&quot;windowStage&quot;) as window.WindowStage;
          windowStege.createSubWindow(&quot;hello&quot;, (err, win) =&gt; &#123;
            win.setUIContent(&#39;pages/Page2&#39;);
            win.showWindow();
          &#125;)
        &#125;)
      &#125;
      .width(&#39;100%&#39;)
    &#125;
    .height(&#39;100%&#39;)
    .backgroundColor(Color.Pink)
  &#125;
&#125;

// Page2.ets
import window from &#39;@ohos.window&#39;;

@Entry
@Component
struct Index &#123;
  @State message: string = &#39;page Index&#39;;

  aboutToAppear() &#123;
    window.findWindow(&quot;hello&quot;).setWindowBackgroundColor(&quot;#00000000&quot;)
  &#125;

  onBackPress() &#123;
    window.findWindow(&quot;hello&quot;).destroyWindow().then((res) =&gt; &#123;
      console.log(&quot;destroyWindow success&quot;)
    &#125;).catch(() =&gt; &#123;
      console.log(&quot;destroyWindow fail&quot;)
    &#125;)
    return true
  &#125;

  build() &#123;
    Row() &#123;
      Column() &#123;
        Text(this.message)
          .fontSize(50)
          .fontWeight(FontWeight.Bold)
      &#125;
      .width(&#39;100%&#39;)
      .backgroundColor(Color.Red)
    &#125;
    .alignItems(VerticalAlign.Top)
    .height(&#39;100%&#39;)
    .backgroundColor(&quot;#80ffffff&quot;)
  &#125;
&#125;

// Note: Add the key code in EntryAbility
onWindowStageCreate(windowStage: window.WindowStage): void &#123;
  // Main window is created, set main page for this ability
  hilog.info(0x0000, &#39;testTag&#39;, &#39;%&#123;public&#125;s&#39;, &#39;Ability onWindowStageCreate&#39;);

  windowStage.loadContent(&#39;pages/Page231206095213071&#39;, (err, data) =&gt; &#123;
  if (err.code) &#123;
  hilog.error(0x0000, &#39;testTag&#39;, &#39;Failed to load the content. Cause: %&#123;public&#125;s&#39;, JSON.stringify(err) ?? &#39;&#39;);
  return;
&#125;
AppStorage.setAndLink(&quot;windowStage&quot;, windowStage);// Key code
hilog.info(0x0000, &#39;testTag&#39;, &#39;Succeeded in loading the content. Data: %&#123;public&#125;s&#39;, JSON.stringify(data) ?? &#39;&#39;);
&#125;);
&#125;
</code></pre>
<p>AppStorage.setAndLink(“windowStage”, windowStage);&#x2F;&#x2F; This key code configures windowStage.loadContent(‘pages&#x2F;page1’). The demo shows Page1 jumping to Page2, where Page2 has a transparent effect.  </p>
<h4 id="3-In-HarmonyOS-ArkTS-ArkUI-how-to-define-generics-when-any-null-etc-cannot-be-used-and-parameters-may-be-arrays-objects-or-multi-level-structures"><a href="#3-In-HarmonyOS-ArkTS-ArkUI-how-to-define-generics-when-any-null-etc-cannot-be-used-and-parameters-may-be-arrays-objects-or-multi-level-structures" class="headerlink" title="3. In HarmonyOS ArkTS ArkUI, how to define generics when any, null, etc., cannot be used, and parameters may be arrays, objects, or multi-level structures?"></a>3. In HarmonyOS ArkTS ArkUI, how to define generics when any, null, etc., cannot be used, and parameters may be arrays, objects, or multi-level structures?</h4><p>ArkTS does not support <code>any</code>, <code>undefined</code>, or <code>unknown</code> types. Explicitly specify specific types.  </p>
<p><strong>Modification solutions</strong>:  </p>
<ol>
<li>All variables should explicitly specify their specific types.  </li>
<li>For literals, use <code>Record&lt;&gt;</code> with <code>as</code> to specify types.</li>
</ol>
<p><strong>How to define generics for component parameters</strong>:<br>Refer to the demo:  </p>
<pre><code class="language-typescript">let strArr: string[] = [&quot;java&quot;, &quot;python&quot;, &quot;C++&quot;] 
let intArr: number[] = [1, 2, 3]
@Entry
@Component struct Index &#123;
  build() &#123;
    Row() &#123;
      Column() &#123;
        this.printArray(strArr) 
        Text(&#39;Divider&#39;)
          .fontSize(50)
          .fontWeight(FontWeight.Bold)
          .fontColor(Color.Green) 
        this.printArray(intArr)
      &#125;
      .width(&#39;100%&#39;) 
    &#125;
    .height(&#39;100%&#39;) 
  &#125;
  @Builder printArray&lt;T&gt;(arr: T[]) &#123;
    Column() &#123; 
      ForEach(arr, (item: T) =&gt; &#123;
        Text(String(item)) 
          .fontSize(50)
          .fontWeight(FontWeight.Bold) 
      &#125;, (item: string) =&gt; item) 
    &#125; 
  &#125; 
&#125;
</code></pre>
<h4 id="4-How-to-write-combination-gestures-for-a-control-to-recognize-swipe-and-drag-in-HarmonyOS-and-how-to-determine-the-swipe-direction"><a href="#4-How-to-write-combination-gestures-for-a-control-to-recognize-swipe-and-drag-in-HarmonyOS-and-how-to-determine-the-swipe-direction" class="headerlink" title="4. How to write combination gestures for a control to recognize swipe and drag in HarmonyOS, and how to determine the swipe direction?"></a>4. How to write combination gestures for a control to recognize swipe and drag in HarmonyOS, and how to determine the swipe direction?</h4><p>A control listens for gestures, directly operating on swipe and moving according to the drag distance on drag.  </p>
<p>Refer to the following demo:  </p>
<pre><code class="language-typescript">// xxx.ets
@Entry
@Component
struct Index &#123;
  @State offsetX: number = 0;
  @State offsetY: number = 0;
  @State count: number = 0;
  @State positionX: number = 0;
  @State positionY: number = 0;
  @State borderStyles: BorderStyle = BorderStyle.Solid
  build() &#123;
    Column() &#123;
      Text(&#39;sequence gesture\n&#39; + &#39;LongPress onAction:&#39; + this.count + &#39;\nPanGesture offset:\nX: &#39; + this.offsetX + &#39;\n&#39; + &#39;Y: &#39; + this.offsetY)
        .fontSize(28)
    &#125;
    // Binding the translate property enables component position movement
    .translate(&#123; x: this.offsetX, y: this.offsetY, z: 0 &#125;)
    .height(250)
    .width(300)
    // The following combination gestures are recognized in sequence; drag gestures will not trigger if long-press events do not fire normally
    .gesture(
      // Declare the combination gesture type as Sequence
      GestureGroup(GestureMode.Sequence,
        // The first trigger in the combination gesture is a long-press gesture, which can respond multiple times
        LongPressGesture(&#123; repeat: true &#125;)
          // When the long-press gesture is recognized, increment the count displayed on the Text component
          .onAction((event: GestureEvent|undefined) =&gt; &#123;
            if(event)&#123;
              if (event.repeat) &#123;
                this.count++;
              &#125;
            &#125;
            console.info(&#39;LongPress onAction&#39;);
          &#125;)
          .onActionEnd(() =&gt; &#123;
            console.info(&#39;LongPress end&#39;);
          &#125;),
        // When dragging after a long-press, the PanGesture is triggered
        PanGesture()
          .onActionStart(() =&gt; &#123;
            this.borderStyles = BorderStyle.Dashed;
            console.info(&#39;pan start&#39;);
          &#125;)
            // When the gesture is triggered, modify the component&#39;s displacement based on the drag distance from the callback
          .onActionUpdate((event: GestureEvent|undefined) =&gt; &#123;
            if(event)&#123;
              this.offsetX = this.positionX + event.offsetX;
              this.offsetY = this.positionY + event.offsetY;
            &#125;
            console.info(&#39;pan update&#39;);
          &#125;)
          .onActionEnd(() =&gt; &#123;
            this.positionX = this.offsetX;
            this.positionY = this.offsetY;
            this.borderStyles = BorderStyle.Solid;
          &#125;)
      )
    )
  &#125;
&#125;
</code></pre>
<h4 id="5-Are-there-specifications-or-documentation-for-HarmonyOS-desktop-icons"><a href="#5-Are-there-specifications-or-documentation-for-HarmonyOS-desktop-icons" class="headerlink" title="5. Are there specifications or documentation for HarmonyOS desktop icons?"></a>5. Are there specifications or documentation for HarmonyOS desktop icons?</h4><p>For desktop icon and launch page icon resolution specifications, refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/design-guides-V1/app-icon-0000001188065088-V1">https://developer.huawei.com/consumer/cn/doc/design-guides-V1/app-icon-0000001188065088-V1</a>  </p>
<p>HarmonyOS app icon design aims to return to basics, accurately conveying functions, services, and branding through modern semantic expression. Visually, it balances aesthetics and recognizability; formally, it is inclusive and harmonious yet distinct.  </p>
<p><img src="/../images/%E3%80%90%E6%AF%8F%E6%97%A5%E5%AD%A6%E7%82%B9HarmonyOS%20Next%E7%9F%A5%E8%AF%86%E3%80%9125.03.18.png"></p>
<p>HarmonyOS app icons follow these design principles:  </p>
<ol>
<li><strong>Conciseness and Elegance</strong>: Simple element icons with elegant line expressions convey design aesthetics.  </li>
<li><strong>Rapid Meaning Conveyance</strong>: Icon graphics accurately communicate functions, services, and branding, with readability and recognizability.  </li>
<li><strong>Emotional Expression</strong>: Summarize emotional expression through graphics and colors to convey brand visual identity.</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/317-Daily-HarmonyOS-Next-Knowledge-Remove-Popup-Background-Color-Navigation-Usage-Scenarios-Dialog-Page-Relationship-Custom-Struct-Shrinking-Issue-Code-Hidden-Menu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/317-Daily-HarmonyOS-Next-Knowledge-Remove-Popup-Background-Color-Navigation-Usage-Scenarios-Dialog-Page-Relationship-Custom-Struct-Shrinking-Issue-Code-Hidden-Menu/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Remove Popup Background Color, Navigation Usage Scenarios, Dialog-Page Relationship, Custom Struct Shrinking Issue, Code-Hidden Menu</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:20:00 / Modified: 22:20:25" itemprop="dateCreated datePublished" datetime="2025-06-26T22:20:00+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Remove-Popup-Background-Color-Navigation-Usage-Scenarios-Dialog-Page-Relationship-Custom-Struct-Shrinking-Issue-Code-Hidden-Menu"><a href="#Daily-HarmonyOS-Next-Knowledge-Remove-Popup-Background-Color-Navigation-Usage-Scenarios-Dialog-Page-Relationship-Custom-Struct-Shrinking-Issue-Code-Hidden-Menu" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Remove Popup Background Color, Navigation Usage Scenarios, Dialog-Page Relationship, Custom Struct Shrinking Issue, Code-Hidden Menu"></a>[Daily HarmonyOS Next Knowledge] Remove Popup Background Color, Navigation Usage Scenarios, Dialog-Page Relationship, Custom Struct Shrinking Issue, Code-Hidden Menu</h3><h4 id="1-How-to-remove-the-background-color-of-a-HarmonyOS-Popup"><a href="#1-How-to-remove-the-background-color-of-a-HarmonyOS-Popup" class="headerlink" title="1. How to remove the background color of a HarmonyOS Popup?"></a>1. How to remove the background color of a HarmonyOS Popup?</h4><p>Main configuration: <code>shadow:&#123;radius:0&#125;</code>  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">customPopup</span>: <span class="built_in">boolean</span> = <span class="literal">false</span></span><br><span class="line">  <span class="comment">// Popup builder defines the content</span></span><br><span class="line">  <span class="meta">@Builder</span></span><br><span class="line">  <span class="title function_">popupBuilder</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>(&#123; <span class="attr">space</span>: <span class="number">2</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;This is Custom Popup&#x27;</span>).<span class="title function_">fontSize</span>(<span class="number">15</span>)</span><br><span class="line">    &#125;.<span class="title function_">width</span>(<span class="number">200</span>).<span class="title function_">height</span>(<span class="number">50</span>).<span class="title function_">padding</span>(<span class="number">5</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;CustomPopupOptions&#x27;</span>)</span><br><span class="line">        .<span class="title function_">position</span>(&#123; <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">200</span> &#125;)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">customPopup</span> = !<span class="variable language_">this</span>.<span class="property">customPopup</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">bindPopup</span>(<span class="variable language_">this</span>.<span class="property">customPopup</span>, &#123;</span><br><span class="line">          <span class="attr">builder</span>: <span class="variable language_">this</span>.<span class="property">popupBuilder</span>, <span class="comment">// Popup content</span></span><br><span class="line">          <span class="attr">placement</span>: <span class="title class_">Placement</span>.<span class="property">Bottom</span>, <span class="comment">// Popup position</span></span><br><span class="line">          <span class="attr">popupColor</span>: <span class="title class_">Color</span>.<span class="property">Transparent</span>, <span class="comment">// Background color</span></span><br><span class="line">          <span class="attr">backgroundBlurStyle</span>: <span class="title class_">BlurStyle</span>.<span class="property">NONE</span>,</span><br><span class="line">          <span class="attr">shadow</span>: &#123; <span class="attr">radius</span>: <span class="number">0</span> &#125;,</span><br><span class="line">          <span class="comment">// shadow:ShadowStyle.OUTER_DEFAULT_XS,</span></span><br><span class="line">          <span class="attr">onStateChange</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(e.<span class="property">isVisible</span>))</span><br><span class="line">            <span class="keyword">if</span> (!e.<span class="property">isVisible</span>) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">customPopup</span> = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Pink</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 2. When should Navigator, Navigation, and Router be used in HarmonyOS?  </span></span><br><span class="line"><span class="string">There are three routing APIs: Navigator, Navigation, and Router. What are their differences and application scenarios?  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- **Navigator**: A routing container component for page navigation, used as part of the page layout.  </span></span><br><span class="line"><span class="string">- **Navigation**: The root view container for routing, recommended as the root container for Page components. It offers:  </span></span><br><span class="line"><span class="string">  - Built-in联动 of title, content, and back button (no need for custom implementation).  </span></span><br><span class="line"><span class="string">  - Unlimited routing stack size (Router is limited to 32).  </span></span><br><span class="line"><span class="string">  - Access to the routing stack (`</span><span class="title class_">NavPathStack</span><span class="string">`) for direct manipulation.  </span></span><br><span class="line"><span class="string">  - Full customization of components, animations, and properties (e.g., background, blur).  </span></span><br><span class="line"><span class="string">- **Router**: Basic routing API with limitations (e.g., fixed page structure, stack size).  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Documentation**:  </span></span><br><span class="line"><span class="string">- [Navigator](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-navigator-V5)  </span></span><br><span class="line"><span class="string">- [Navigation](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-basic-components-navigation-V5)  </span></span><br><span class="line"><span class="string">- [Router](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-router-V5#routerpushurl9)  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 3. What is the relationship between CustomDialog and Page in HarmonyOS?  </span></span><br><span class="line"><span class="string">If a `</span><span class="title class_">CustomDialog</span><span class="string">` is declared in a Page, can it still be displayed after the Page exits? What is its lifecycle?  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Check if the `</span>showInSubWindow<span class="string">` property is set to `</span><span class="literal">true</span><span class="string">` in the dialog. If enabled, the dialog will persist in a separate window even after the Page exits.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Reference**:  </span></span><br><span class="line"><span class="string">[CustomDialog Documentation](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-methods-custom-dialog-box-V5)  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 4. Custom struct shrinking issue in HarmonyOS?  </span></span><br><span class="line"><span class="string">**Reference code**:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="title class_">Column</span>() &#123;</span><br><span class="line">  <span class="title class_">Text</span>(<span class="string">&#x27;Custom struct shrinking issue&#x27;</span>)</span><br><span class="line">  <span class="title class_">Flex</span>(&#123; <span class="attr">justifyContent</span>: <span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>, <span class="attr">alignItems</span>: <span class="title class_">ItemAlign</span>.<span class="property">Center</span> &#125;) &#123;</span><br><span class="line">    <span class="title class_">SubView</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;Left&#x27;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="variable language_">this</span>.<span class="property">leftContent</span>,</span><br><span class="line">      <span class="attr">color</span>: <span class="title class_">Color</span>.<span class="property">Green</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="title class_">SubView</span>(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;Right&#x27;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="variable language_">this</span>.<span class="property">rightContent</span>,</span><br><span class="line">      <span class="attr">color</span>: <span class="title class_">Color</span>.<span class="property">Red</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  .<span class="title function_">width</span>(<span class="number">200</span>).<span class="title function_">height</span>(<span class="number">40</span>)</span><br><span class="line">  .<span class="title function_">borderWidth</span>(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom struct:</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">export</span> struct <span class="title class_">SubView</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">title</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="meta">@State</span> <span class="attr">desc</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="meta">@State</span> <span class="attr">color</span>: <span class="title class_">Color</span> = <span class="title class_">Color</span>.<span class="property">White</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="comment">// Omitted code</span></span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">flexShrink</span>(<span class="number">1</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="variable language_">this</span>.<span class="property">color</span>)</span><br><span class="line">    .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">desc</span>.<span class="property">length</span> &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">desc</span> = <span class="variable language_">this</span>.<span class="property">desc</span>.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">desc</span> = <span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.desc&#125;</span> becomes longer`</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="5-How-to-hide-a-HarmonyOS-menu-programmatically"><a href="#5-How-to-hide-a-HarmonyOS-menu-programmatically" class="headerlink" title="5. How to hide a HarmonyOS menu programmatically?"></a>5. How to hide a HarmonyOS menu programmatically?</h4><p>Hide the entire menu when an item is clicked.  </p>
<p>Use <code>bindContextMenu</code> to attach a menu to a component and control visibility via <code>isShown</code>:  </p>
<pre><code class="language-typescript">class classComponent &#123;
  content: string = &#39;&#39;;
  labelInfo: string = &#39;&#39;;
&#125;

@Entry
@Component
struct TestMenuPage &#123;
  @State list1: Array&lt;classComponent&gt; = [&#123; content: &#39;Copy&#39;, labelInfo: &quot;Ctrl+C&quot; &#125;, &#123;
    content: &quot;Paste&quot;,
    labelInfo: &quot;Ctrl+V&quot;
  &#125;];
  @State menuIsShow: boolean = false;
  @State menuBackGroundColor: Color = Color.White;
  @State menuIsDelete: boolean = false;

  @Builder
  MyMenu() &#123;
    Menu() &#123;
      ForEach(this.list1, (item: classComponent) =&gt; &#123;
        MenuItem(&#123; content: `$&#123;item.content&#125;`, labelInfo: `$&#123;item.labelInfo&#125;` &#125;)
      &#125;)
    &#125;.visibility(this.menuIsDelete ? Visibility.None : Visibility.Visible)
  &#125;

  build() &#123;
    Column() &#123;
      Column() &#123;
        Button(&#39;Click&#39;).onClick(() =&gt; &#123;
          this.menuIsShow = !this.menuIsShow;
        &#125;)
        Button(&#39;Delete Menu&#39;).onClick(() =&gt; &#123;
          this.list1 = []
          this.menuIsDelete = true
        &#125;)
      &#125;
      .width(&#39;100%&#39;)
      .padding(20)
      .bindMenu(this.MyMenu)
      .bindContextMenu(this.menuIsShow, this.MyMenu(), &#123;
        backgroundColor: this.menuIsDelete ? Color.Transparent : Color.White,
        backgroundColor: Color.White,
        backgroundBlurStyle: BlurStyle.NONE
      &#125;)
      .alignItems(HorizontalAlign.Start)
    &#125;.height(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<p><strong>Documentation</strong>:<br><a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-attributes-menu-V5#bindcontextmenu8">bindContextMenu</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/316-Daily-HarmonyOS-Next-Knowledge-Text-Height-Issue-Active-Focus-Acquisition-Screen-off-Lifecycle-Component-Switch-Button-Data-Replacement-Return-to-System-Desktop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/316-Daily-HarmonyOS-Next-Knowledge-Text-Height-Issue-Active-Focus-Acquisition-Screen-off-Lifecycle-Component-Switch-Button-Data-Replacement-Return-to-System-Desktop/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Text Height Issue, Active Focus Acquisition, Screen-off Lifecycle, Component Switch Button Data Replacement, Return to System Desktop</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:18:26 / Modified: 22:19:03" itemprop="dateCreated datePublished" datetime="2025-06-26T22:18:26+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Text-Height-Issue-Active-Focus-Acquisition-Screen-off-Lifecycle-Component-Switch-Button-Data-Replacement-Return-to-System-Desktop"><a href="#Daily-HarmonyOS-Next-Knowledge-Text-Height-Issue-Active-Focus-Acquisition-Screen-off-Lifecycle-Component-Switch-Button-Data-Replacement-Return-to-System-Desktop" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Text Height Issue, Active Focus Acquisition, Screen-off Lifecycle, Component Switch Button Data Replacement, Return to System Desktop"></a>[Daily HarmonyOS Next Knowledge] Text Height Issue, Active Focus Acquisition, Screen-off Lifecycle, Component Switch Button Data Replacement, Return to System Desktop</h3><h4 id="1-When-setting-Height-for-a-HarmonyOS-Text-component-does-the-overflow-content-display"><a href="#1-When-setting-Height-for-a-HarmonyOS-Text-component-does-the-overflow-content-display" class="headerlink" title="1. When setting Height for a HarmonyOS Text component, does the overflow content display?"></a>1. When setting Height for a HarmonyOS Text component, does the overflow content display?</h4><p>For the Text component, when setting a height and inputting excessive text, the overflowing content will display by default.  </p>
<p>The <code>clip</code> property of the Text component defaults to <code>false</code>, meaning content exceeding the component area is not truncated. To truncate content, add the <code>.clip(true)</code> property.  </p>
<h4 id="2-How-to-actively-acquire-component-focus-in-HarmonyOS"><a href="#2-How-to-actively-acquire-component-focus-in-HarmonyOS" class="headerlink" title="2. How to actively acquire component focus in HarmonyOS?"></a>2. How to actively acquire component focus in HarmonyOS?</h4><p>With two input fields (one for the account and one for the password), the goal is to move focus to the password input field via code after completing the account input.  </p>
<p>Dynamic focus control for components can be achieved using <code>focusControl.requestFocus()</code>. Refer to the documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-attributes-focus-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-attributes-focus-V5</a>  </p>
<p>For custom component focus effects, set whether the component can receive focus and the specific focus order for tab or direction key navigation:  </p>
<ul>
<li><code>focusable(value: boolean)</code>: Sets whether the current component can acquire focus.</li>
</ul>
<table>
<thead>
<tr>
<th align="left">Parameter Name</th>
<th align="left">Type</th>
<th align="left">Required</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">value</td>
<td align="left">boolean</td>
<td align="left">Yes</td>
<td align="left">Sets whether the current component can acquire focus.<br><br><strong>Note:</strong> Components with default interaction logic (e.g., Button, TextInput) are focusable by default, while components like Text and Image are not. Focus events cannot be triggered when focus is disabled.</td>
</tr>
</tbody></table>
<h4 id="3-Why-don’t-the-screen-off-and-activation-lifecycles-of-a-HarmonyOS-navigation-page-execute"><a href="#3-Why-don’t-the-screen-off-and-activation-lifecycles-of-a-HarmonyOS-navigation-page-execute" class="headerlink" title="3. Why don’t the screen-off and activation lifecycles of a HarmonyOS navigation page execute?"></a>3. Why don’t the screen-off and activation lifecycles of a HarmonyOS navigation page execute?</h4><p><code>onHidden</code> and <code>onShown</code> of NavDestination are called when the component is hidden or shown in a full modal. For screen-off and screen-on events, listen to <code>onPageShow</code> and <code>onPageHide</code>. Refer to the screen-off listening documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-display-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-display-V5</a>  </p>
<p>The screen properties provide basic capabilities for managing display devices, including obtaining information about the default display device, all display devices, and listening for display device plugging&#x2F;unplugging events.<br>Import the module:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import &#123; display &#125; from &#x27;@kit.ArkUI&#x27;;</span><br><span class="line">```  </span><br><span class="line">Use `getAllDisplays()` or `getDefaultDisplaySync()` to obtain a Display instance, then call corresponding methods via this instance.  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">| Name                 | Type                                  | Read-only | Optional | Description                                                                                                                                                                                                                                                                                                                                                                                                                                   |</span><br><span class="line">| :----------------- | :---------------------------------- | :---- | :---- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |</span><br><span class="line">| id                 | number                              | Yes   | No    | The ID of the display device, which should be an integer.&lt;br&gt;&lt;br&gt;**元服务API (MetaService API):** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                                 |</span><br><span class="line">| name               | string                              | Yes   | No    | The name of the display device.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                                                  |</span><br><span class="line">| alive              | boolean                             | Yes   | No    | Whether the display device is active.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                                             |</span><br><span class="line">| state              | DisplayState                        | Yes   | No    | The state of the display device.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                                                  |</span><br><span class="line">| refreshRate        | number                              | Yes   | No    | The refresh rate of the display device, in Hz (integer).&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                               |</span><br><span class="line">| rotation           | number                              | Yes   | No    | The clockwise rotation angle of the display device screen.&lt;br&gt;&lt;br&gt;0: 0° clockwise rotation;&lt;br&gt;1: 90° clockwise rotation;&lt;br&gt;2: 180° clockwise rotation;&lt;br&gt;3: 270° clockwise rotation.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 11.                                                                                                                                                                                                                                                                                          |</span><br><span class="line">| width              | number                              | Yes   | No    | The screen width of the display device in px (integer).&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 11.                                                                                                                                                                                                                                                                                                                                                            |</span><br><span class="line">| height             | number                              | Yes   | No    | The screen height of the display device in px (integer).&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 11.                                                                                                                                                                                                                                                                                                                                                            |</span><br><span class="line">| densityDPI         | number                              | Yes   | No    | The physical pixel density of the display device screen (expressed as pixels per inch). This parameter is a floating-point number in px, ranging from [80.0, 640.0]. Common values include 160.0 and 480.0, with actual values depending on the options provided by different devices.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                              |</span><br><span class="line">| orientation10+     | Orientation                         | Yes   | No    | Represents the current display orientation of the screen.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                            |</span><br><span class="line">| densityPixels      | number                              | Yes   | No    | The logical pixel density of the display device, representing the scaling factor between physical and logical pixels, calculated as: ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20250312154627.72227489366415104050346098974263:50001231000000:2800:EEEA4F97D0EE3C2ED8549778E14AFC83E0C74BA5DB9F37DF926C800A3142CAFE.jpg)&lt;br&gt;&lt;br&gt;This parameter is a floating-point number restricted by the densityDPI range, ranging from [0.5, 4.0]. Common values include 1.0 and 3.0, with actual values depending on the densityDPI provided by different devices.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 11. |</span><br><span class="line">| scaledDensity      | number                              | Yes   | No    | The display font scaling factor of the display device. This parameter is a floating-point number, typically the same as densityPixels.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                              |</span><br><span class="line">| xDPI               | number                              | Yes   | No    | The exact physical pixel value per inch on the x-axis of the screen (floating-point number).&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                                                        |</span><br><span class="line">| yDPI               | number                              | Yes   | No    | The exact physical pixel value per inch on the y-axis of the screen (floating-point number).&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                                                        |</span><br><span class="line">| colorSpaces11+     | Array&lt;colorSpaceManager.ColorSpace&gt; | Yes   | No    | All color gamut types supported by the display device.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                              |</span><br><span class="line">| hdrFormats11+      | Array&lt;hdrCapability.HDRFormat&gt;      | Yes   | No    | All HDR formats supported by the display device.&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                                 |</span><br><span class="line">| availableWidth12+  | number                              | Yes   | No    | The available area width of the screen on 2-in-1 devices, in px (integer &gt; 0).&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                |</span><br><span class="line">| availableHeight12+ | number                              | Yes   | No    | The available area height of the screen on 2-in-1 devices, in px (integer &gt; 0).&lt;br&gt;&lt;br&gt;**元服务API:** This interface supports use in MetaServices starting from API version 12.                                                                                                                                                                                                                                                                                                                                                |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 4. How to implement data replacement for a @Component toggle button in HarmonyOS?  </span><br><span class="line">There is a @Component containing a bean class with three QuoteUiEntity variables. It nests another @Component that receives one of the three QuoteUiEntity variables. With three buttons, how can the nested @Component receive the corresponding QuoteUiEntity when a button is clicked?  </span><br><span class="line"></span><br><span class="line">Refer to the demo:  </span><br></pre></td></tr></table></figure>
<p>class Model {<br>  public value: string<br>  constructor(value: string) {<br>    this.value &#x3D; value<br>  }<br>}<br>@Entry<br>@Component<br>struct EntryComponent {<br>  build() {<br>    Column() {<br>      MyComponent({ count: 1, increaseBy: 2 })<br>        .width(300)<br>      MyComponent({ title: new Model(‘Hello World 2’), count: 7 })<br>    }<br>  }<br>}<br>@Component<br>struct MyComponent {<br>  @State title: Model &#x3D; new Model(‘Hello World’)<br>  @State count: number &#x3D; 0<br>  private increaseBy: number &#x3D; 1<br>  build() {<br>    Column() {<br>      Text(<code>$&#123;this.title.value&#125;</code>)<br>        .margin(10)<br>      Button(<code>Click to change title</code>)<br>        .onClick(() &#x3D;&gt; {<br>          this.title.value &#x3D; this.title.value &#x3D;&#x3D;&#x3D; ‘Hello ArkUI’ ? ‘Hello World’ : ‘Hello ArkUI’<br>        })<br>        .width(300)<br>        .margin(10)<br>      Button(<code>Click to increase count = $&#123;this.count&#125;</code>)<br>        .onClick(() &#x3D;&gt; {<br>          this.count +&#x3D; this.increaseBy<br>        })<br>        .width(300)<br>        .margin(10)<br>    }<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### 5. How to return to the system desktop in HarmonyOS?  </span><br><span class="line">When overriding the `onBackPress` method on the home page, how to minimize the app to the background (i.e., return to the system desktop)?  </span><br><span class="line"></span><br><span class="line">In the page&#x27;s `onBackPress`, obtain the main window object via `windowStage` and use `minimize` to minimize the main window. Refer to the documentation: https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-window-V5#minimize11  </span><br><span class="line"></span><br><span class="line">`minimize(callback: AsyncCallback&lt;void&gt;): void`  </span><br><span class="line"></span><br><span class="line">This interface has different functionalities based on the calling object:  </span><br><span class="line">- For the main window, it minimizes the window, which can be restored from the Dock.  </span><br><span class="line">- For sub-windows, it hides the window, which cannot be restored from the Dock (use `showWindow()` to restore). Calling this interface on a floating window will return an error code of 1300002.  </span><br><span class="line"></span><br><span class="line">Refer to the demo:  </span><br></pre></td></tr></table></figure>
<p>import window from ‘@ohos.window’<br>import { BusinessError } from ‘@ohos.base’;<br>@Entry<br>@Component<br>struct Page240605161307072 {<br>  @State message: string &#x3D; ‘Hello World’;<br>  onBackPress() {<br>    const context &#x3D; getContext(this)<br>    window.getLastWindow(getContext()).then((data) &#x3D;&gt; {<br>      &#x2F;&#x2F; Get the window object<br>      let windowClass &#x3D; data;<br>      windowClass.minimize((err: BusinessError) &#x3D;&gt; {<br>        const errCode: number &#x3D; err.code;<br>        if (errCode) {<br>          console.error(‘Failed to minimize the window. Cause: ‘ + JSON.stringify(err));<br>          return;<br>        }<br>        console.info(‘Succeeded in minimizing the window.’);<br>      });<br>      console.info(‘Succeeded in obtaining the top window. Data: ‘ + JSON.stringify(data));<br>    });<br>    return true;<br>  }<br>  build() {<br>    Row() {<br>      Column() {<br>        Text(this.message)<br>          .fontSize(50)<br>          .fontWeight(FontWeight.Bold)<br>        TextInput()<br>      }<br>      .width(‘100%’)<br>    }<br>    .height(‘100%’)<br>  }<br>}<br>&#96;&#96;&#96;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/315-Daily-HarmonyOS-Next-Knowledge-Watermark-Addition-List-UI-Refresh-Scroll-Component-Overlay-Worker-Network-Requests-Click-Events/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/315-Daily-HarmonyOS-Next-Knowledge-Watermark-Addition-List-UI-Refresh-Scroll-Component-Overlay-Worker-Network-Requests-Click-Events/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Watermark Addition, List UI Refresh, Scroll Component Overlay, Worker Network Requests, Click Events</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:15:50 / Modified: 22:17:26" itemprop="dateCreated datePublished" datetime="2025-06-26T22:15:50+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Watermark-Addition-List-UI-Refresh-Scroll-Component-Overlay-Worker-Network-Requests-Click-Events"><a href="#Daily-HarmonyOS-Next-Knowledge-Watermark-Addition-List-UI-Refresh-Scroll-Component-Overlay-Worker-Network-Requests-Click-Events" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Watermark Addition, List UI Refresh, Scroll Component Overlay, Worker Network Requests, Click Events"></a>[Daily HarmonyOS Next Knowledge] Watermark Addition, List UI Refresh, Scroll Component Overlay, Worker Network Requests, Click Events</h3><h4 id="1-Is-there-a-method-to-add-watermarks-to-UI-in-HarmonyOS"><a href="#1-Is-there-a-method-to-add-watermarks-to-UI-in-HarmonyOS" class="headerlink" title="1. Is there a method to add watermarks to UI in HarmonyOS?"></a>1. Is there a method to add watermarks to UI in HarmonyOS?</h4><p>Refer to the demo:  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">PageWatermark</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">settings</span>: <span class="title class_">RenderingContextSettings</span> = <span class="keyword">new</span> <span class="title class_">RenderingContextSettings</span>(<span class="literal">true</span>)</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">context</span>: <span class="title class_">CanvasRenderingContext2D</span> = <span class="keyword">new</span> <span class="title class_">CanvasRenderingContext2D</span>(<span class="variable language_">this</span>.<span class="property">settings</span>)</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Builder</span> <span class="title class_">Watermark</span>() &#123;</span><br><span class="line">    <span class="title class_">Canvas</span>(<span class="variable language_">this</span>.<span class="property">context</span>)</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>) .<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">      .<span class="title function_">hitTestBehavior</span>(<span class="title class_">HitTestMode</span>.<span class="property">Transparent</span>)</span><br><span class="line">      .<span class="title function_">onReady</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">fillStyle</span> = <span class="string">&#x27;#10000000&#x27;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">font</span> = <span class="string">&quot;16vp&quot;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">textAlign</span> = <span class="string">&quot;center&quot;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">textBaseline</span> = <span class="string">&quot;middle&quot;</span></span><br><span class="line">        <span class="comment">// Draw text watermarks here; image watermarks are also possible</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">width</span> / <span class="number">120</span>; i++) &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">context</span>.<span class="title function_">translate</span>(<span class="number">120</span>, <span class="number">0</span>)</span><br><span class="line">          <span class="keyword">let</span> j = <span class="number">0</span></span><br><span class="line">          <span class="keyword">for</span> (; j &lt; <span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">height</span> / <span class="number">120</span>; j++) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">context</span>.<span class="title function_">rotate</span>(-<span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">180</span> * <span class="number">30</span>)</span><br><span class="line">            <span class="comment">// The watermark data here is hardcoded; replace it with your own watermark</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">context</span>.<span class="title function_">fillText</span>(<span class="string">&quot;Watermark Watermark Watermark&quot;</span>, -<span class="number">60</span>, -<span class="number">60</span>)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">context</span>.<span class="title function_">rotate</span>(<span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">180</span> * <span class="number">30</span>)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">context</span>.<span class="title function_">translate</span>(<span class="number">0</span>, <span class="number">120</span>) &#125;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">context</span>.<span class="title function_">translate</span>(<span class="number">0</span>, -<span class="number">120</span> * j)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&quot;No data&quot;</span>).<span class="title function_">fontColor</span>(<span class="string">&quot;#495057&quot;</span>)</span><br><span class="line">      <span class="title class_">Image</span>($r(<span class="string">&quot;app.media.startIcon&quot;</span>))</span><br><span class="line">        .<span class="title function_">width</span>(<span class="number">300</span>)</span><br><span class="line">        .<span class="title function_">layoutWeight</span>(<span class="number">1</span>)</span><br><span class="line">        .<span class="title function_">overlay</span>(<span class="variable language_">this</span>.<span class="title class_">Watermark</span>())</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 2. In HarmonyOS, when clicking a list item, how to modify the property status of the current item and refresh the UI based on property changes?  </span></span><br><span class="line"><span class="string">Refer to the demo:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">ListModel</span> &#123;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">content</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">isComplete</span>: <span class="built_in">boolean</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">title</span>: <span class="built_in">string</span>, <span class="attr">content</span>: <span class="built_in">string</span>, <span class="attr">isComplete</span>: <span class="built_in">boolean</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">title</span> = title;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">content</span> = content;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">isComplete</span> = isComplete;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">SyncPage</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="title class_">ListData</span>: <span class="title class_">Array</span>&lt;<span class="title class_">ListModel</span>&gt; = [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ListModel</span>(<span class="string">&#x27;Title 1&#x27;</span>, <span class="string">&#x27;Content 1&#x27;</span>, <span class="literal">true</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ListModel</span>(<span class="string">&#x27;Title 2&#x27;</span>, <span class="string">&#x27;Content 2&#x27;</span>, <span class="literal">false</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ListModel</span>(<span class="string">&#x27;Title 3&#x27;</span>, <span class="string">&#x27;Content 3&#x27;</span>, <span class="literal">false</span>),</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">List</span>() &#123;</span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">ListData</span>, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="title class_">ListModel</span>, <span class="attr">index</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">ListItem</span>() &#123;</span><br><span class="line">            <span class="title class_">Row</span>() &#123;</span><br><span class="line">              <span class="title class_">Row</span>() &#123;</span><br><span class="line">                <span class="title class_">Text</span>(item.<span class="property">title</span>)</span><br><span class="line">                <span class="title class_">Text</span>(item.<span class="property">content</span>).<span class="title function_">fontColor</span>(<span class="string">&#x27;#999999&#x27;</span>).<span class="title function_">fontSize</span>(<span class="number">13</span>)</span><br><span class="line">              &#125;</span><br><span class="line"></span><br><span class="line">              <span class="title class_">Image</span>(item.<span class="property">isComplete</span> ? $r(<span class="string">&#x27;app.media.ic_personal_focus&#x27;</span>) : $r(<span class="string">&#x27;app.media.ic_personal_normal&#x27;</span>))</span><br><span class="line">                .<span class="title function_">width</span>(<span class="number">20</span>)</span><br><span class="line">                .<span class="title function_">height</span>(<span class="number">20</span>)</span><br><span class="line">                .<span class="title function_">margin</span>(<span class="number">10</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">SpaceBetween</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">            .<span class="title function_">alignItems</span>(<span class="title class_">VerticalAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">80</span>)</span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">let</span> status = !item.<span class="property">isComplete</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">ListData</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">el, itemIndex</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (itemIndex !== index) &#123;</span><br><span class="line">                  el.<span class="property">isComplete</span> = <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;)</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">ListData</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>, <span class="keyword">new</span> <span class="title class_">ListModel</span>(item.<span class="property">title</span>, item.<span class="property">content</span>, status))</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;Confirm&#x27;</span>, &#123; <span class="attr">type</span>: <span class="title class_">ButtonType</span>.<span class="property">Normal</span> &#125;)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Print selected data in listData&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 3. When overlaying a component on a Scroll, how to set margins, width, and height?  </span></span><br><span class="line"><span class="string">Refer to the demo:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">NestedScroll</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">listPosition</span>: <span class="built_in">number</span> = <span class="number">0</span>; <span class="comment">// 0 for scrolling to the top of the List, 1 for the middle, 2 for the bottom.</span></span><br><span class="line">  <span class="keyword">private</span> <span class="attr">arr</span>: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">scrollerForScroll</span>: <span class="title class_">Scroller</span> = <span class="keyword">new</span> <span class="title class_">Scroller</span>()</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">scrollerForList</span>: <span class="title class_">Scroller</span> = <span class="keyword">new</span> <span class="title class_">Scroller</span>()</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Flex</span>() &#123;</span><br><span class="line">      <span class="title class_">Scroll</span>(<span class="variable language_">this</span>.<span class="property">scrollerForScroll</span>) &#123;</span><br><span class="line">        <span class="title class_">Column</span>() &#123;</span><br><span class="line">          <span class="title class_">List</span>(&#123; <span class="attr">space</span>: <span class="number">20</span>, <span class="attr">scroller</span>: <span class="variable language_">this</span>.<span class="property">scrollerForList</span> &#125;) &#123;</span><br><span class="line">            <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">arr</span>, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="title class_">ListItem</span>() &#123;</span><br><span class="line">                <span class="title class_">Text</span>(<span class="string">&quot;ListItem&quot;</span> + item)</span><br><span class="line">                  .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">                  .<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">                  .<span class="title function_">borderRadius</span>(<span class="number">15</span>)</span><br><span class="line">                  .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">                  .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">                  .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">              &#125;.<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>).<span class="title function_">height</span>(<span class="number">100</span>)</span><br><span class="line">            &#125;, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="built_in">string</span></span>) =&gt;</span> item)</span><br><span class="line">          &#125;</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="string">&quot;50%&quot;</span>)</span><br><span class="line">          .<span class="title function_">edgeEffect</span>(<span class="title class_">EdgeEffect</span>.<span class="property">None</span>)</span><br><span class="line">          .<span class="title function_">friction</span>(<span class="number">0.6</span>)</span><br><span class="line">          .<span class="title function_">onReachStart</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">listPosition</span> = <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">onReachEnd</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">listPosition</span> = <span class="number">2</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">onScrollFrameBegin</span>(<span class="function">(<span class="params"><span class="attr">offset</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> ((<span class="variable language_">this</span>.<span class="property">listPosition</span> == <span class="number">0</span> &amp;&amp; offset &lt;= <span class="number">0</span>) || (<span class="variable language_">this</span>.<span class="property">listPosition</span> == <span class="number">2</span> &amp;&amp; offset &gt;= <span class="number">0</span>)) &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">scrollerForScroll</span>.<span class="title function_">scrollBy</span>(<span class="number">0</span>, offset)</span><br><span class="line">              <span class="keyword">return</span> &#123; <span class="attr">offsetRemain</span>: <span class="number">0</span> &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">listPosition</span> = <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> &#123; <span class="attr">offsetRemain</span>: offset &#125;;</span><br><span class="line">          &#125;)</span><br><span class="line">          <span class="title class_">AreaTest</span>()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>).<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">    &#125;.<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>).<span class="title function_">backgroundColor</span>(<span class="number">0xDCDCDC</span>).<span class="title function_">padding</span>(<span class="number">20</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span> struct <span class="title class_">AreaTest</span> &#123;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Text</span>(<span class="string">&quot;Scroll Area&quot;</span>)</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">      .<span class="title function_">height</span>(<span class="string">&quot;40%&quot;</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="number">0X330000FF</span>)</span><br><span class="line">      .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">      .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">      .<span class="title function_">margin</span>(<span class="number">90</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 4. In HarmonyOS, how to process all network requests through multi-threading using workers?  </span></span><br><span class="line"><span class="string">For frequent network requests and database storage—operations that are time-consuming and have logical sequences—use workers. Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/worker-introduction-V5  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Main role of Worker**: Provides a multi-threading runtime environment for applications, allowing scripts to run in background threads separately from the host thread. This avoids blocking the host thread with compute-intensive or high-latency tasks. For specific interface information and usage, see Worker.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Worker operation mechanism diagram**  </span></span><br><span class="line"><span class="string">![](../images/【每日学点HarmonyOS%20Next知识】25.03.15.png)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- The thread creating the Worker is the host thread (not necessarily the main thread; worker threads can also create Worker child threads). The Worker&#x27;s own thread is the Worker child thread (or Actor thread/worker thread).  </span></span><br><span class="line"><span class="string">- Each Worker child thread and host thread have independent instances (infrastructure, objects, code segments, etc.), so starting each Worker incurs memory overhead. Limit the number of Worker child threads.  </span></span><br><span class="line"><span class="string">- Communication between Worker child threads and the host thread is message-based, using serialization for command and data interaction.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Precautions**:  </span></span><br><span class="line"><span class="string">- When creating a Worker, there are manual and automatic methods. Manual creation requires configuring the Worker thread directory and files.  </span></span><br><span class="line"><span class="string">- The path rules for Worker thread files in the constructor vary by version.  </span></span><br><span class="line"><span class="string">- Manually manage the Worker lifecycle. A maximum of 64 Worker child threads can run simultaneously.  </span></span><br><span class="line"><span class="string">- Worker threads can only use thread-safe libraries (e.g., non-thread-safe UI libraries are unsupported).  </span></span><br><span class="line"><span class="string">- Serialized data is limited to 16MB.  </span></span><br><span class="line"><span class="string">- Register the `</span>onerror<span class="string">` interface in the host thread to avoid jscrash on Worker thread exceptions.  </span></span><br><span class="line"><span class="string">- Cross-HAP Worker thread file usage is unsupported.  </span></span><br><span class="line"><span class="string">- Configure dependencies for HAR/HSP before referencing them.  </span></span><br><span class="line"><span class="string">- `</span><span class="title class_">AppStorage</span><span class="string">` is unsupported in Worker threads.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 5. In HarmonyOS, how to better capture single-click events?  </span></span><br><span class="line"><span class="string">Using `</span><span class="title class_">TapGesture</span>(&#123;<span class="attr">count</span>: <span class="number">1</span>&#125;).<span class="title function_">onAction</span>(<span class="function">(<span class="params"><span class="attr">event</span>: <span class="title class_">GestureEvent</span></span>) =&gt;</span> &#123; <span class="title class_">Code</span> segment A &#125;)<span class="string">` may trigger Code segment A even if the finger is lifted after a delay or after sliding. For typical single-clicks requiring quick lifts, use a `</span><span class="title class_">GestureGroup</span><span class="string">` with exclusive recognition mode, adding empty long-press and pan gestures.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Sample code:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="title class_">Button</span>(<span class="string">&#x27;Gesture Verification&#x27;</span>)</span><br><span class="line">  .<span class="title function_">gesture</span>(<span class="title class_">GestureGroup</span>(<span class="title class_">GestureMode</span>.<span class="property">Exclusive</span>,</span><br><span class="line">    <span class="title class_">TapGesture</span>(&#123;<span class="attr">count</span>: <span class="number">1</span>&#125;).<span class="title function_">onAction</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// Code segment A</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title class_">LongPressGesture</span>(),</span><br><span class="line">    <span class="title class_">PanGesture</span>()</span><br><span class="line">  ))</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/314-Daily-HarmonyOS-Next-Knowledge-Introducing-V8-Engine-Tab-Scrolling-Cold-Start-Statistics-Basic-Component-Parameter-Passing-Video-Playlist-Dropdown-Pagination/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/314-Daily-HarmonyOS-Next-Knowledge-Introducing-V8-Engine-Tab-Scrolling-Cold-Start-Statistics-Basic-Component-Parameter-Passing-Video-Playlist-Dropdown-Pagination/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Introducing V8 Engine, Tab Scrolling, Cold Start Statistics, Basic Component Parameter Passing, Video Playlist Dropdown Pagination</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:14:35 / Modified: 22:18:28" itemprop="dateCreated datePublished" datetime="2025-06-26T22:14:35+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Introducing-V8-Engine-Tab-Scrolling-Cold-Start-Statistics-Basic-Component-Parameter-Passing-Video-Playlist-Dropdown-Pagination"><a href="#Daily-HarmonyOS-Next-Knowledge-Introducing-V8-Engine-Tab-Scrolling-Cold-Start-Statistics-Basic-Component-Parameter-Passing-Video-Playlist-Dropdown-Pagination" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Introducing V8 Engine, Tab Scrolling, Cold Start Statistics, Basic Component Parameter Passing, Video Playlist Dropdown Pagination"></a>[Daily HarmonyOS Next Knowledge] Introducing V8 Engine, Tab Scrolling, Cold Start Statistics, Basic Component Parameter Passing, Video Playlist Dropdown Pagination</h3><h4 id="1-How-to-introduce-the-V8-engine-in-HarmonyOS"><a href="#1-How-to-introduce-the-V8-engine-in-HarmonyOS" class="headerlink" title="1. How to introduce the V8 engine in HarmonyOS?"></a>1. How to introduce the V8 engine in HarmonyOS?</h4><p>Reference: <a target="_blank" rel="noopener" href="https://gitee.com/openharmony/docs/blob/master/zh-cn/application-dev/napi/use-jsvm-runtime-task.md">https://gitee.com/openharmony/docs/blob/master/zh-cn/application-dev/napi/use-jsvm-runtime-task.md</a>  </p>
<p>Developers create a new JS basic runtime environment through the <code>createJsCore</code> method and obtain a CoreID. They use the <code>evaluateJS</code> method with the CoreID to run JS code, create promises in the JS code to asynchronously execute functions, and finally release the runtime environment corresponding to the CoreID using the <code>releaseJsCore</code> method.  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// Define a map to manage each independent vm environment</span></span><br><span class="line"><span class="type">static</span> map&lt;<span class="type">int</span>, JSVM_VM *&gt; g_vmMap;</span><br><span class="line"><span class="type">static</span> map&lt;<span class="type">int</span>, JSVM_Env *&gt; g_envMap;</span><br><span class="line"><span class="type">static</span> map&lt;<span class="type">int</span>, JSVM_CallbackStruct *&gt; g_callBackStructMap;</span><br><span class="line"><span class="type">static</span> <span class="type">uint32_t</span> ENVTAG_NUMBER = <span class="number">0</span>;</span><br><span class="line"><span class="type">static</span> std::mutex envMapLock;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CHECK_COND(cond)                                                                                               \</span></span><br><span class="line"><span class="meta">  do &#123;                                                                                                               \</span></span><br><span class="line"><span class="meta">      <span class="keyword">if</span> (!(cond)) &#123;                                                                                                 \</span></span><br><span class="line"><span class="meta">          OH_LOG_ERROR(LOG_APP, <span class="string">&quot;jsvm fail file: %&#123;public&#125;s line: %&#123;public&#125;d ret = false&quot;</span>, __FILE__, __LINE__);      \</span></span><br><span class="line"><span class="meta">          return -1;                                                                                                 \</span></span><br><span class="line"><span class="meta">      &#125;                                                                                                              \</span></span><br><span class="line"><span class="meta">  &#125; while (0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="keyword">virtual</span> ~<span class="built_in">Task</span>() = <span class="keyword">default</span>;</span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">Run</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">static</span> map&lt;<span class="type">int</span>, deque&lt;Task *&gt;&gt; g_taskQueueMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom Consoleinfo method</span></span><br><span class="line"><span class="function"><span class="type">static</span> JSVM_Value <span class="title">Consoleinfo</span><span class="params">(JSVM_Env env, JSVM_CallbackInfo info)</span> </span>&#123;</span><br><span class="line">  <span class="type">size_t</span> argc = <span class="number">1</span>;</span><br><span class="line">  JSVM_Value args[<span class="number">1</span>];</span><br><span class="line">  <span class="type">char</span> log[<span class="number">256</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="type">size_t</span> log_length;</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_GetCbInfo</span>(env, info, &amp;argc, args, <span class="literal">NULL</span>, <span class="literal">NULL</span>));</span><br><span class="line"></span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_GetValueStringUtf8</span>(env, args[<span class="number">0</span>], log, <span class="number">255</span>, &amp;log_length));</span><br><span class="line">  log[<span class="number">255</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM API TEST: %&#123;public&#125;s&quot;</span>, log);</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom method to create a Promise for use in JS code</span></span><br><span class="line"><span class="function"><span class="type">static</span> JSVM_Value <span class="title">CreatePromise</span><span class="params">(JSVM_Env env, JSVM_CallbackInfo info)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM API TEST: CreatePromise start&quot;</span>);</span><br><span class="line">  <span class="type">int</span> envID = <span class="number">-1</span>;</span><br><span class="line">  <span class="comment">// Get envID through the current env</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it = g_envMap.<span class="built_in">begin</span>(); it != g_envMap.<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">      <span class="keyword">if</span> (*it-&gt;second == env) &#123;</span><br><span class="line">          envID = it-&gt;first;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (envID == <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="built_in">OH_LOG_ERROR</span>(LOG_APP, <span class="string">&quot;JSVM API TEST: CreatePromise envID failed&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  JSVM_Value promise;</span><br><span class="line">  JSVM_Deferred deferred;</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_CreatePromise</span>(env, &amp;deferred, &amp;promise));</span><br><span class="line">  <span class="comment">// Design the ReadTask class to add the deferred object of the promise to the execution queue</span></span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">ReadTask</span> : <span class="keyword">public</span> Task &#123;</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">      <span class="built_in">ReadTask</span>(JSVM_Env env, JSVM_Deferred deferred, <span class="type">int</span> envNum) : <span class="built_in">env_</span>(env), <span class="built_in">envID_</span>(envNum), <span class="built_in">deferred_</span>(deferred) &#123;&#125;</span><br><span class="line">      <span class="function"><span class="type">void</span> <span class="title">Run</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">          <span class="comment">// string str = &quot;TEST RUN OH_JSVM_ResolveDeferred&quot;;</span></span><br><span class="line">          <span class="type">int</span> envID = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">auto</span> it = g_envMap.<span class="built_in">begin</span>(); it != g_envMap.<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">              <span class="keyword">if</span> (*it-&gt;second == env_) &#123;</span><br><span class="line">                  envID = it-&gt;first;</span><br><span class="line">                  <span class="keyword">break</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM API TEST: CreatePromise %&#123;public&#125;d&quot;</span>, envID);</span><br><span class="line">          JSVM_Value result;</span><br><span class="line">          <span class="keyword">if</span> (<span class="built_in">OH_JSVM_CreateInt32</span>(env_, envID, &amp;result) != JSVM_OK) &#123;</span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (<span class="built_in">OH_JSVM_ResolveDeferred</span>(env_, deferred_, result) != JSVM_OK) &#123;</span><br><span class="line">              <span class="keyword">return</span>;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">      JSVM_Env env_;</span><br><span class="line">      <span class="type">int</span> envID_;</span><br><span class="line">      JSVM_Deferred deferred_;</span><br><span class="line">  &#125;;</span><br><span class="line">  g_taskQueueMap[envID].<span class="built_in">push_back</span>(<span class="keyword">new</span> <span class="built_in">ReadTask</span>(env, deferred, envID));</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM API TEST: CreatePromise end&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom Add method</span></span><br><span class="line"><span class="function"><span class="type">static</span> JSVM_Value <span class="title">Add</span><span class="params">(JSVM_Env env, JSVM_CallbackInfo info)</span> </span>&#123;</span><br><span class="line">  <span class="type">size_t</span> argc = <span class="number">2</span>;</span><br><span class="line">  JSVM_Value args[<span class="number">2</span>];</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_GetCbInfo</span>(env, info, &amp;argc, args, <span class="literal">NULL</span>, <span class="literal">NULL</span>));</span><br><span class="line">  <span class="type">double</span> num1, num2;</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_GetValueDouble</span>(env, args[<span class="number">0</span>], &amp;num1));</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_GetValueDouble</span>(env, args[<span class="number">1</span>], &amp;num2));</span><br><span class="line">  JSVM_Value sum = <span class="literal">nullptr</span>;</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_CreateDouble</span>(env, num1 + num2, &amp;sum));</span><br><span class="line">  <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom AssertEqual method</span></span><br><span class="line"><span class="function"><span class="type">static</span> JSVM_Value <span class="title">AssertEqual</span><span class="params">(JSVM_Env env, JSVM_CallbackInfo info)</span> </span>&#123;</span><br><span class="line">  <span class="type">size_t</span> argc = <span class="number">2</span>;</span><br><span class="line">  JSVM_Value args[<span class="number">2</span>];</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_GetCbInfo</span>(env, info, &amp;argc, args, <span class="literal">NULL</span>, <span class="literal">NULL</span>));</span><br><span class="line"></span><br><span class="line">  <span class="type">bool</span> isStrictEquals = <span class="literal">false</span>;</span><br><span class="line">  <span class="built_in">JSVM_CALL</span>(<span class="built_in">OH_JSVM_StrictEquals</span>(env, args[<span class="number">0</span>], args[<span class="number">1</span>], &amp;isStrictEquals));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isStrictEquals) &#123;</span><br><span class="line">      <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM API TEST RESULT: PASS&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM API TEST RESULT: FAILED&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">fromOHStringValue</span><span class="params">(JSVM_Env &amp;env, JSVM_Value &amp;value, std::string &amp;result)</span> </span>&#123;</span><br><span class="line">  <span class="type">size_t</span> size;</span><br><span class="line">  <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_GetValueStringUtf8</span>(env, value, <span class="literal">nullptr</span>, <span class="number">0</span>, &amp;size));</span><br><span class="line">  <span class="type">char</span> resultStr[size + <span class="number">1</span>];</span><br><span class="line">  <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_GetValueStringUtf8</span>(env, value, resultStr, size + <span class="number">1</span>, &amp;size));</span><br><span class="line">  result = resultStr;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Provide an external interface to create a JSVM runtime environment and return the corresponding unique ID</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">CreateJsCore</span><span class="params">(<span class="type">uint32_t</span> *result)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM CreateJsCore START&quot;</span>);</span><br><span class="line">  g_taskQueueMap[ENVTAG_NUMBER] = deque&lt;Task *&gt;&#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (g_aa == <span class="number">0</span>) &#123;</span><br><span class="line">      JSVM_InitOptions init_options;</span><br><span class="line">      <span class="built_in">memset</span>(&amp;init_options, <span class="number">0</span>, <span class="built_in">sizeof</span>(init_options));</span><br><span class="line">      <span class="built_in">CHECK</span>(<span class="built_in">OH_JSVM_Init</span>(&amp;init_options));</span><br><span class="line">      g_aa++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock_guard</span><span class="params">(envMapLock)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Virtual machine instance</span></span><br><span class="line">  g_vmMap[ENVTAG_NUMBER] = <span class="keyword">new</span> JSVM_VM;</span><br><span class="line">  JSVM_CreateVMOptions options;</span><br><span class="line">  JSVM_VMScope vmScope;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;options, <span class="number">0</span>, <span class="built_in">sizeof</span>(options));</span><br><span class="line">  <span class="built_in">CHECK</span>(<span class="built_in">OH_JSVM_CreateVM</span>(&amp;options, g_vmMap[ENVTAG_NUMBER]));</span><br><span class="line">  <span class="built_in">CHECK</span>(<span class="built_in">OH_JSVM_OpenVMScope</span>(*g_vmMap[ENVTAG_NUMBER], &amp;vmScope));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// New environment</span></span><br><span class="line">  g_envMap[ENVTAG_NUMBER] = <span class="keyword">new</span> JSVM_Env;</span><br><span class="line">  g_callBackStructMap[ENVTAG_NUMBER] = <span class="keyword">new</span> JSVM_CallbackStruct[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Register callback function pointers and data for user-provided native functions, exposed to JS via JSVM-API</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">      g_callBackStructMap[ENVTAG_NUMBER][i].data = <span class="literal">nullptr</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  g_callBackStructMap[ENVTAG_NUMBER][<span class="number">0</span>].callback = Consoleinfo;</span><br><span class="line">  g_callBackStructMap[ENVTAG_NUMBER][<span class="number">1</span>].callback = Add;</span><br><span class="line">  g_callBackStructMap[ENVTAG_NUMBER][<span class="number">2</span>].callback = AssertEqual;</span><br><span class="line">  g_callBackStructMap[ENVTAG_NUMBER][<span class="number">3</span>].callback = CreatePromise;</span><br><span class="line">  JSVM_PropertyDescriptor descriptors[] = &#123;</span><br><span class="line">      &#123;<span class="string">&quot;consoleinfo&quot;</span>, <span class="literal">NULL</span>, &amp;g_callBackStructMap[ENVTAG_NUMBER][<span class="number">0</span>], <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, JSVM_DEFAULT&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;add&quot;</span>, <span class="literal">NULL</span>, &amp;g_callBackStructMap[ENVTAG_NUMBER][<span class="number">1</span>], <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, JSVM_DEFAULT&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;assertEqual&quot;</span>, <span class="literal">NULL</span>, &amp;g_callBackStructMap[ENVTAG_NUMBER][<span class="number">2</span>], <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, JSVM_DEFAULT&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;createPromise&quot;</span>, <span class="literal">NULL</span>, &amp;g_callBackStructMap[ENVTAG_NUMBER][<span class="number">3</span>], <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, JSVM_DEFAULT&#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">CHECK</span>(<span class="built_in">OH_JSVM_CreateEnv</span>(*g_vmMap[ENVTAG_NUMBER], <span class="built_in">sizeof</span>(descriptors) / <span class="built_in">sizeof</span>(descriptors[<span class="number">0</span>]), descriptors,</span><br><span class="line">                          g_envMap[ENVTAG_NUMBER]));</span><br><span class="line">  <span class="built_in">CHECK</span>(<span class="built_in">OH_JSVM_CloseVMScope</span>(*g_vmMap[ENVTAG_NUMBER], vmScope));</span><br><span class="line"></span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM CreateJsCore END&quot;</span>);</span><br><span class="line">  *result = ENVTAG_NUMBER;</span><br><span class="line">  ENVTAG_NUMBER++;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Provide an external interface to release the JSVM environment, releasing the corresponding environment via envId</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">ReleaseJsCore</span><span class="params">(<span class="type">uint32_t</span> coreEnvId)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM ReleaseJsCore START&quot;</span>);</span><br><span class="line">  <span class="built_in">CHECK_COND</span>(g_envMap.<span class="built_in">count</span>(coreEnvId) != <span class="number">0</span> &amp;&amp; g_envMap[coreEnvId] != <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">  <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock_guard</span><span class="params">(envMapLock)</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">CHECK</span>(<span class="built_in">OH_JSVM_DestroyEnv</span>(*g_envMap[coreEnvId]));</span><br><span class="line">  g_envMap[coreEnvId] = <span class="literal">nullptr</span>;</span><br><span class="line">  g_envMap.<span class="built_in">erase</span>(coreEnvId);</span><br><span class="line">  <span class="built_in">CHECK</span>(<span class="built_in">OH_JSVM_DestroyVM</span>(*g_vmMap[coreEnvId]));</span><br><span class="line">  g_vmMap[coreEnvId] = <span class="literal">nullptr</span>;</span><br><span class="line">  g_vmMap.<span class="built_in">erase</span>(coreEnvId);</span><br><span class="line">  <span class="keyword">delete</span>[] g_callBackStructMap[coreEnvId];</span><br><span class="line">  g_callBackStructMap[coreEnvId] = <span class="literal">nullptr</span>;</span><br><span class="line">  g_callBackStructMap.<span class="built_in">erase</span>(coreEnvId);</span><br><span class="line">  g_taskQueueMap.<span class="built_in">erase</span>(coreEnvId);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM ReleaseJsCore END&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> std::mutex mutexLock;</span><br><span class="line"><span class="comment">// Provide an external interface to execute JS code, running JS code in the corresponding JSVN environment via coreID</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">EvaluateJS</span><span class="params">(<span class="type">uint32_t</span> envId, <span class="type">const</span> <span class="type">char</span> *source, std::string &amp;res)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM EvaluateJS START&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">CHECK_COND</span>(g_envMap.<span class="built_in">count</span>(envId) != <span class="number">0</span> &amp;&amp; g_envMap[envId] != <span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">  JSVM_Env env = *g_envMap[envId];</span><br><span class="line">  JSVM_VM vm = *g_vmMap[envId];</span><br><span class="line">  JSVM_VMScope vmScope;</span><br><span class="line">  JSVM_EnvScope envScope;</span><br><span class="line">  JSVM_HandleScope handleScope;</span><br><span class="line">  JSVM_Value result;</span><br><span class="line"></span><br><span class="line">  <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock_guard</span><span class="params">(mutexLock)</span></span>;</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="comment">// Create a JSVM environment</span></span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_OpenVMScope</span>(vm, &amp;vmScope));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_OpenEnvScope</span>(*g_envMap[envId], &amp;envScope));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_OpenHandleScope</span>(*g_envMap[envId], &amp;handleScope));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Call test functions via script</span></span><br><span class="line">      JSVM_Script script;</span><br><span class="line">      JSVM_Value jsSrc;</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_CreateStringUtf8</span>(env, source, JSVM_AUTO_LENGTH, &amp;jsSrc));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_CompileScript</span>(env, jsSrc, <span class="literal">nullptr</span>, <span class="number">0</span>, <span class="literal">true</span>, <span class="literal">nullptr</span>, &amp;script));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_RunScript</span>(env, script, &amp;result));</span><br><span class="line"></span><br><span class="line">      JSVM_ValueType type;</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_Typeof</span>(env, result, &amp;type));</span><br><span class="line">      <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM API TEST type: %&#123;public&#125;d&quot;</span>, type);</span><br><span class="line">      <span class="comment">// Execute tasks in the current env event queue</span></span><br><span class="line">      <span class="keyword">while</span> (!g_taskQueueMap[envId].<span class="built_in">empty</span>()) &#123;</span><br><span class="line">          <span class="keyword">auto</span> task = g_taskQueueMap[envId].<span class="built_in">front</span>();</span><br><span class="line">          g_taskQueueMap[envId].<span class="built_in">pop_front</span>();</span><br><span class="line">          task-&gt;<span class="built_in">Run</span>();</span><br><span class="line">          <span class="keyword">delete</span> task;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (type == JSVM_STRING) &#123;</span><br><span class="line">          <span class="built_in">CHECK_COND</span>(<span class="built_in">fromOHStringValue</span>(env, result, res) != <span class="number">-1</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == JSVM_BOOLEAN) &#123;</span><br><span class="line">          <span class="type">bool</span> ret = <span class="literal">false</span>;</span><br><span class="line">          <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_GetValueBool</span>(env, result, &amp;ret));</span><br><span class="line">          ret ? res = <span class="string">&quot;true&quot;</span> : res = <span class="string">&quot;false&quot;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == JSVM_NUMBER) &#123;</span><br><span class="line">          <span class="type">int32_t</span> num;</span><br><span class="line">          <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_GetValueInt32</span>(env, result, &amp;num));</span><br><span class="line">          res = std::<span class="built_in">to_string</span>(num);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == JSVM_OBJECT) &#123;</span><br><span class="line">          JSVM_Value objResult;</span><br><span class="line">          <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_JsonStringify</span>(env, result, &amp;objResult));</span><br><span class="line">          <span class="built_in">CHECK_COND</span>(<span class="built_in">fromOHStringValue</span>(env, objResult, res) != <span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="type">bool</span> aal = <span class="literal">false</span>;</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_PumpMessageLoop</span>(*g_vmMap[envId], &amp;aal));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_PerformMicrotaskCheckpoint</span>(*g_vmMap[envId]));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_CloseHandleScope</span>(*g_envMap[envId], handleScope));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_CloseEnvScope</span>(*g_envMap[envId], envScope));</span><br><span class="line">      <span class="built_in">CHECK_RET</span>(<span class="built_in">OH_JSVM_CloseVMScope</span>(*g_vmMap[envId], vmScope));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;JSVM EvaluateJS END&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int32_t</span> <span class="title">TestJSVM</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> source1[] = <span class="string">&quot;&#123;\</span></span><br><span class="line"><span class="string">      let a = \&quot;hello World\&quot;;\</span></span><br><span class="line"><span class="string">      consoleinfo(a);\</span></span><br><span class="line"><span class="string">      const mPromise = createPromise();\</span></span><br><span class="line"><span class="string">      mPromise.then((result) =&gt; &#123;\</span></span><br><span class="line"><span class="string">        assertEqual(result, 0);\</span></span><br><span class="line"><span class="string">      &#125;);\</span></span><br><span class="line"><span class="string">      a;\</span></span><br><span class="line"><span class="string">  &#125;;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> source2[] = <span class="string">&quot;&#123;\</span></span><br><span class="line"><span class="string">      let a = \&quot;second hello\&quot;;\</span></span><br><span class="line"><span class="string">      consoleinfo(a);\</span></span><br><span class="line"><span class="string">      let b = add(99, 1);\</span></span><br><span class="line"><span class="string">      assertEqual(100, b);\</span></span><br><span class="line"><span class="string">      assertEqual(add(99, 1), 100);\</span></span><br><span class="line"><span class="string">      createPromise().then((result) =&gt; &#123;\</span></span><br><span class="line"><span class="string">          assertEqual(result, 1);\</span></span><br><span class="line"><span class="string">      &#125;);\</span></span><br><span class="line"><span class="string">      a;\</span></span><br><span class="line"><span class="string">  &#125;;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create the first runtime environment and bind TS callbacks</span></span><br><span class="line">  <span class="type">uint32_t</span> coreId1;</span><br><span class="line">  <span class="built_in">CHECK_COND</span>(<span class="built_in">CreateJsCore</span>(&amp;coreId1) == <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;TEST coreId: %&#123;public&#125;d&quot;</span>, coreId1);</span><br><span class="line">  <span class="comment">// Execute JS code in the first runtime environment</span></span><br><span class="line">  std::string result1;</span><br><span class="line">  <span class="built_in">CHECK_COND</span>(<span class="built_in">EvaluateJS</span>(coreId1, source1, result1) == <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;TEST evaluateJS: %&#123;public&#125;s&quot;</span>, result<span class="number">1.</span><span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create the second runtime environment and bind TS callbacks</span></span><br><span class="line">  <span class="type">uint32_t</span> coreId2;</span><br><span class="line">  <span class="built_in">CHECK_COND</span>(<span class="built_in">CreateJsCore</span>(&amp;coreId2) == <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;TEST coreId: %&#123;public&#125;d&quot;</span>, coreId2);</span><br><span class="line">  <span class="comment">// Execute JS code in the second runtime environment</span></span><br><span class="line">  std::string result2;</span><br><span class="line">  <span class="built_in">CHECK_COND</span>(<span class="built_in">EvaluateJS</span>(coreId2, source2, result2) == <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;TEST evaluateJS: %&#123;public&#125;s&quot;</span>, result<span class="number">2.</span><span class="built_in">c_str</span>());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Release the first runtime environment</span></span><br><span class="line">  <span class="built_in">CHECK_COND</span>(<span class="built_in">ReleaseJsCore</span>(coreId1) == <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// Release the second runtime environment</span></span><br><span class="line">  <span class="built_in">CHECK_COND</span>(<span class="built_in">ReleaseJsCore</span>(coreId2) == <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">OH_LOG_INFO</span>(LOG_APP, <span class="string">&quot;Test NAPI end&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">#### <span class="number">2.</span> When <span class="keyword">using</span> the HarmonyOS Tabs component with many tabs, how to automatically scroll the selected tab to the middle of the page during scrolling?  </span><br><span class="line">Reference demo:  </span><br><span class="line">```typescript</span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TabsExample</span> &#123;</span><br><span class="line">  @State fontColor: string = <span class="string">&#x27;#182431&#x27;</span></span><br><span class="line">  @State selectedFontColor: string = <span class="string">&#x27;#007DFF&#x27;</span></span><br><span class="line">  @State currentIndex: number = <span class="number">0</span></span><br><span class="line">  <span class="keyword">private</span> controller: TabsController = <span class="keyword">new</span> <span class="built_in">TabsController</span>()</span><br><span class="line"></span><br><span class="line">  @Builder</span><br><span class="line">  <span class="built_in">tabBuilder</span>(index: number, name: string) &#123;</span><br><span class="line">    <span class="built_in">Column</span>() &#123;</span><br><span class="line">      <span class="built_in">Text</span>(name)</span><br><span class="line">        .<span class="built_in">fontColor</span>(<span class="keyword">this</span>.currentIndex === index ? <span class="keyword">this</span>.selectedFontColor : <span class="keyword">this</span>.fontColor)</span><br><span class="line">        .<span class="built_in">fontSize</span>(<span class="number">10</span>)</span><br><span class="line">        .<span class="built_in">fontWeight</span>(<span class="keyword">this</span>.currentIndex === index ? <span class="number">500</span> : <span class="number">400</span>)</span><br><span class="line">        .<span class="built_in">lineHeight</span>(<span class="number">22</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/26/313-Daily-HarmonyOS-Next-Knowledge-Flex-Component-List-Refresh-Custom-Pop-up-Button-States-Auto-Soft-Keyboard-Pop-up/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/26/313-Daily-HarmonyOS-Next-Knowledge-Flex-Component-List-Refresh-Custom-Pop-up-Button-States-Auto-Soft-Keyboard-Pop-up/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Flex Component, List Refresh, Custom Pop-up, Button States, Auto Soft Keyboard Pop-up</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-26 22:13:14 / Modified: 22:14:16" itemprop="dateCreated datePublished" datetime="2025-06-26T22:13:14+08:00">2025-06-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Daily-HarmonyOS-Next-Knowledge-Flex-Component-List-Refresh-Custom-Pop-up-Button-States-Auto-Soft-Keyboard-Pop-up"><a href="#Daily-HarmonyOS-Next-Knowledge-Flex-Component-List-Refresh-Custom-Pop-up-Button-States-Auto-Soft-Keyboard-Pop-up" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Flex Component, List Refresh, Custom Pop-up, Button States, Auto Soft Keyboard Pop-up"></a>[Daily HarmonyOS Next Knowledge] Flex Component, List Refresh, Custom Pop-up, Button States, Auto Soft Keyboard Pop-up</h3><h4 id="1-Issues-with-HarmonyOS-Flex-component-causing-incorrect-UI"><a href="#1-Issues-with-HarmonyOS-Flex-component-causing-incorrect-UI" class="headerlink" title="1. Issues with HarmonyOS Flex component causing incorrect UI?"></a>1. Issues with HarmonyOS Flex component causing incorrect UI?</h4><p>The expected effect is that the first child1 Flex should not fill the entire main axis.  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">Flex(&#123;</span><br><span class="line">  direction: FlexDirection.Column,</span><br><span class="line">  // wrap: FlexWrap.NoWrap,</span><br><span class="line">  // justifyContent:  FlexAlign.Center,</span><br><span class="line">  // alignItems: ItemAlign.Start,</span><br><span class="line">  // alignContent: FlexAlign.Start,</span><br><span class="line">&#125;)&#123;</span><br><span class="line">  Flex(&#123;</span><br><span class="line">    direction: FlexDirection.Column,</span><br><span class="line">    // wrap: FlexWrap.NoWrap,</span><br><span class="line">    // justifyContent: FlexAlign.Start,</span><br><span class="line">    // alignItems: ItemAlign.Start,</span><br><span class="line">    // alignContent: FlexAlign.Start,</span><br><span class="line">  &#125;) &#123;</span><br><span class="line">    Text(&quot;啊是打火机卡的黑科技abc1234567890&quot;)</span><br><span class="line">  &#125;.id(&quot;child1&quot;)</span><br><span class="line">  Text(&quot;啊是打火机卡的黑科技&quot;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Code 2:</span><br><span class="line">  Flex(&#123;</span><br><span class="line">    direction: FlexDirection.Column,</span><br><span class="line">    // wrap: FlexWrap.NoWrap,</span><br><span class="line">    // justifyContent:  FlexAlign.Center,</span><br><span class="line">    // alignItems: ItemAlign.Start,</span><br><span class="line">    // alignContent: FlexAlign.Start,</span><br><span class="line">  &#125;)&#123;</span><br><span class="line">    Flex(&#123;</span><br><span class="line">      direction: FlexDirection.Column,</span><br><span class="line">      // wrap: FlexWrap.NoWrap,</span><br><span class="line">      // justifyContent: FlexAlign.Start,</span><br><span class="line">      // alignItems: ItemAlign.Start,</span><br><span class="line">      // alignContent: FlexAlign.Start,</span><br><span class="line">    &#125;) &#123;</span><br><span class="line">      Text(&quot;啊是打火机卡的黑科技abc1234567890&quot;)</span><br><span class="line">        .flexBasis(0).flexShrink(1).flexGrow(0)</span><br><span class="line">    &#125;.flexBasis(0).flexShrink(1).flexGrow(0).id(&quot;child1&quot;)</span><br><span class="line">    Text(&quot;啊是打火机卡的黑科技&quot;)</span><br><span class="line">  &#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">By default, the Flex component&#x27;s main axis fills the parent container when not explicitly set, while the Column/Row component&#x27;s main axis follows the child nodes&#x27; sizes by default.  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 2. How to refresh a List when ListItem data in HarmonyOS ListItemGroup is updated?  </span><br><span class="line">Abstract the group data into a component and pass the required parameters. Code:  </span><br></pre></td></tr></table></figure>
<p>@Observed<br>class ProjectArray extends Array<string>{<br>}</p>
<p>@Observed<br>class Subject {<br>  public title: string;<br>  public projects: ProjectArray;<br>  constructor(title, projects) {<br>    this.title &#x3D; title;<br>    this.projects &#x3D; projects;<br>  }<br>}</p>
<p>@Component<br>struct ViewA {<br>  title: string;<br>  @ObjectLink projects: ProjectArray;<br>  build() {<br>    Column() {<br>      Text(this.title)<br>      List(){<br>        ForEach(this.projects, (project) &#x3D;&gt; {<br>          ListItem() {<br>            Text(project)<br>              .width(“100%”).height(100).fontSize(20)<br>              .textAlign(TextAlign.Center).backgroundColor(0xFFFFFF)<br>          }</p>
<pre><code>    &#125;)
  &#125;
&#125;
</code></pre>
<p>  }<br>}</p>
<p>@Entry<br>@Component<br>struct ListItemGroupExample2 {<br>  @State timetable: Subject[] &#x3D; [<br>    new Subject(‘星期一’, new ProjectArray(‘语文’, ‘数学’, ‘英语’))<br>  ]<br>  build() {<br>    Column() {<br>      Button(‘change’)<br>        .onClick(() &#x3D;&gt; {<br>          console.log(‘testTag: Change’);<br>          this.timetable[0].projects.splice(0, 1, ‘英语’);<br>        })<br>      ForEach(this.timetable, (table) &#x3D;&gt; {<br>        ViewA({title: table.title, projects: table.projects})<br>      })</p>
<pre><code>&#125;.width(&#39;100%&#39;).height(&#39;100%&#39;).backgroundColor(0xDCDCDC).padding(&#123; top: 20 &#125;)
</code></pre>
<p>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### 3. How to display a @Builder-decorated function in the description of a HarmonyOS custom dialog?  </span><br><span class="line">Refer to the following demo:  </span><br></pre></td></tr></table></figure>
<p>@Builder<br>function customDialogBuilder(price:string,id_no:string) {<br>  Column({space:15}) {<br>    Row() {<br>      Text(‘运费:’ + price)<br>        .fontSize(10)<br>    }<br>    Row() {<br>      Text(‘货单:’ + id_no)<br>        .fontSize(10)<br>    }<br>  }<br>  .width(‘100%’)<br>  .height(200)<br>  .padding(5)<br>  .backgroundColor(“#FF0000”)<br>}</p>
<p>@CustomDialog<br>struct CustomDialogExample {<br>  @Link title: string<br>  @Link price: string<br>  @Link id_no: string<br>  controller?: CustomDialogController<br>  cancel: () &#x3D;&gt; void &#x3D; () &#x3D;&gt; {<br>  }<br>  confirm: () &#x3D;&gt; void &#x3D; () &#x3D;&gt; {<br>  }</p>
<p>  build() {<br>    Column() {<br>      Text(this.title).fontSize(20).margin({ top: 10, bottom: 10 })<br>      customDialogBuilder(this.price,this.id_no)<br>      Flex({ justifyContent: FlexAlign.SpaceAround }) {<br>        Button(‘cancel’)<br>          .onClick(() &#x3D;&gt; {<br>            if (this.controller !&#x3D; undefined) {<br>              this.controller.close()<br>              this.cancel()<br>            }<br>          }).backgroundColor(0xffffff).fontColor(Color.Black)<br>        Button(‘confirm’)<br>          .onClick(() &#x3D;&gt; {<br>            if (this.controller !&#x3D; undefined) {<br>              this.controller.close()<br>              this.confirm()<br>            }<br>          }).backgroundColor(0xffffff).fontColor(Color.Red)<br>      }.margin({ bottom: 10 })<br>    }.borderRadius(10)<br>  }<br>}</p>
<p>@Entry<br>@Component<br>struct Index {</p>
<p>  @State title: string &#x3D; ‘’<br>  @State price: string &#x3D; ‘’<br>  @State id_no: string &#x3D; ‘’<br>  dialogController: CustomDialogController | null &#x3D; new CustomDialogController({<br>    builder: CustomDialogExample({<br>      cancel: () &#x3D;&gt; {<br>        this.onCancel()<br>      },<br>      confirm: () &#x3D;&gt; {<br>        this.onAccept()<br>      },<br>      title: $title,<br>      price: $price,<br>      id_no: $id_no,<br>    }),<br>    autoCancel: true,<br>    alignment: DialogAlignment.Bottom,<br>    offset: { dx: 0, dy: -20 },<br>    gridCount: 4,<br>    customStyle: false,<br>    cornerRadius: 10,<br>  })</p>
<p>  &#x2F;&#x2F; Set dialogControlle to null when the custom component is about to be destroyed<br>  aboutToDisappear() {<br>    this.dialogController &#x3D; null &#x2F;&#x2F; Set dialogController to null<br>  }</p>
<p>  onCancel() {<br>    console.info(‘Callback when the first button is clicked’)<br>  }</p>
<p>  onAccept() {<br>    console.info(‘Callback when the second button is clicked’)<br>  }</p>
<p>  build() {<br>    Row() {<br>      Column() {<br>        Button(‘自定义弹框’)<br>          .width(‘100vp’)<br>          .height(‘100vp’)<br>          .onClick(() &#x3D;&gt; {<br>            if (this.dialogController !&#x3D; null) {<br>              this.title &#x3D; ‘自定义弹框title’<br>              this.price &#x3D; ‘100元’<br>              this.id_no &#x3D; ‘1234567895549’<br>              this.dialogController.open()<br>            }<br>          })<br>      }<br>      .width(‘100%’)<br>    }<br>    .height(‘100%’)<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### 4. How to set images for normal and selected states of a HarmonyOS button?  </span><br><span class="line">Set one image for the normal state and another for the selected state.  </span><br><span class="line">Refer to the demo:  </span><br></pre></td></tr></table></figure>
<p>@Entry<br>@Component<br>struct Page240605153407040 {<br>  @State message: string &#x3D; ‘app.media.photo’;</p>
<p>  build() {<br>    Row() {<br>      Column() {<br>        Button() {<br>          Image($r(this.message))<br>        }<br>        .width(40).height(40).margin({ left: 18 })<br>        .onClick(()&#x3D;&gt;{<br>          if (this.message &#x3D;&#x3D; ‘app.media.photo’ ) {<br>            this.message &#x3D; ‘app.media.startIcon’<br>          }else {<br>            this.message &#x3D; ‘app.media.photo’<br>          }</p>
<pre><code>    &#125;)
  &#125;
  .width(&#39;100%&#39;)
&#125;
.height(&#39;100%&#39;)
</code></pre>
<p>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### 5. How to automatically pop up the soft keyboard after opening a page in HarmonyOS?  </span><br><span class="line">Use focusControl.requestFocus to control the input box&#x27;s focus. The soft keyboard will automatically pop up when the component gains focus.  </span><br><span class="line">The TextInput triggers the input method when focused and closes it when focus is lost. Use focusControl to manage focus for closing the soft keyboard.  </span><br></pre></td></tr></table></figure>
<p>build() {<br>  Column() {<br>    TextInput()<br>    Button(<code>hide</code>)<br>      .key(‘button’)<br>      .onClick(()&#x3D;&gt;{<br>        focusControl.requestFocus(‘button’)<br>      })<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Judge by listening to the keyboard height change event:  </span><br></pre></td></tr></table></figure>
<p>window.getLastWindow(context).then(lastWindow &#x3D;&gt; {<br>  lastWindow.on(‘keyboardHeightChange’, (size: number) &#x3D;&gt; {<br>    console.warn(<code>...keyboardHeightChange: $&#123;size&#125;</code>);<br>  })<br>}).catch((err: BusinessError) &#x3D;&gt; {console.error(<code>...error message: $&#123;err.message&#125;</code>);<br>})<br>&#96;&#96;&#96;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/20/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><span class="page-number current">21</span><a class="page-number" href="/page/22/">22</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/22/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Qingkouwei</p>
  <div class="site-description" itemprop="description">Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">315</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingkouwei</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harmonyostech.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:type" content="website">
<meta property="og:title" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:url" content="https://harmonyostech.github.io/page/11/index.html">
<meta property="og:site_name" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Qingkouwei">
<meta property="article:tag" content="HarmonyOSNext, HarmonyOS NEXT, HarmonyOS, Cangjie">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://harmonyostech.github.io/page/11/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>HarmonyOS NEXT Knowledge Charging Station</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HarmonyOS NEXT Knowledge Charging Station</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Analysis of Core Technologies and Application Scenarios of HarmonyOS NEXT</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41216-Daily-HarmonyOS-Next-Knowledge-Long-press-Animation-Canvas-Overlapping-with-Bottom-Navigation-Grid-Dragging-and-Web-Width-Adaptation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41216-Daily-HarmonyOS-Next-Knowledge-Long-press-Animation-Canvas-Overlapping-with-Bottom-Navigation-Grid-Dragging-and-Web-Width-Adaptation/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Long-press Animation, Canvas Overlapping with Bottom Navigation, Grid Dragging, and Web Width Adaptation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 08:43:40 / Modified: 09:36:52" itemprop="dateCreated datePublished" datetime="2025-06-29T08:43:40+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Long-press-Animation-Canvas-Overlapping-with-Bottom-Navigation-Grid-Dragging-and-Web-Width-Adaptation"><a href="#Daily-HarmonyOS-Next-Knowledge-Long-press-Animation-Canvas-Overlapping-with-Bottom-Navigation-Grid-Dragging-and-Web-Width-Adaptation" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Long-press Animation, Canvas Overlapping with Bottom Navigation, Grid Dragging, and Web Width Adaptation"></a>[Daily HarmonyOS Next Knowledge] Long-press Animation, Canvas Overlapping with Bottom Navigation, Grid Dragging, and Web Width Adaptation</h1><h4 id="1-How-to-implement-a-long-press-animation-effect-for-a-button-in-HarmonyOS"><a href="#1-How-to-implement-a-long-press-animation-effect-for-a-button-in-HarmonyOS" class="headerlink" title="1. How to implement a long-press animation effect for a button in HarmonyOS?"></a>1. How to implement a long-press animation effect for a button in HarmonyOS?</h4><p>How to achieve a button long-press + animation effect  </p>
<p>Refer to the following code for a similar effect:  </p>
<pre><code class="language-typescript">// ets
@Entry
@Component
struct Progress_Ring &#123;
  @State progressValue: number = 0
  @State animationId: number | null = null
  build() &#123;
    Column(&#123; space: 15 &#125;) &#123;
      Stack() &#123;
        Progress(&#123; value: 0, total: 100, type: ProgressType.Ring &#125;)
          .color(&quot;red&quot;)
          .value(this.progressValue)
          .width(120)
          .style(&#123; strokeWidth: 5, scaleCount: 20, scaleWidth: 5, enableSmoothEffect: true &#125;)
          .backgroundColor(&#39;#00000000&#39;)

        Button(&#39;test&#39;).gesture(
          LongPressGesture(&#123; repeat: true, duration: 10 &#125;)
            .onAction((event: GestureEvent | undefined) =&gt; &#123;
              if (event &amp;&amp; this.progressValue &lt;= 100) &#123;
                clearInterval(this.animationId)
                this.animationId = null
                this.progressValue++
              &#125;
            &#125;)
            .onActionEnd(() =&gt; &#123;
              this.animationId = setInterval(() =&gt; &#123;
                this.progressValue--
                if (this.progressValue &lt;= 0) &#123;
                  clearInterval(this.animationId)
                &#125;
              &#125;, 10)
            &#125;)
        )
      &#125;

    &#125;.width(&#39;100%&#39;).padding(&#123; top: 5 &#125;)
  &#125;
&#125;
</code></pre>
<h4 id="2-When-rotating-the-phone-from-portrait-to-landscape-and-back-to-portrait-in-HarmonyOS-ghosting-appears-in-the-overlapping-area-between-the-Canvas-and-the-navigation-bar"><a href="#2-When-rotating-the-phone-from-portrait-to-landscape-and-back-to-portrait-in-HarmonyOS-ghosting-appears-in-the-overlapping-area-between-the-Canvas-and-the-navigation-bar" class="headerlink" title="2. When rotating the phone from portrait to landscape and back to portrait in HarmonyOS, ghosting appears in the overlapping area between the Canvas and the navigation bar."></a>2. When rotating the phone from portrait to landscape and back to portrait in HarmonyOS, ghosting appears in the overlapping area between the Canvas and the navigation bar.</h4><p>When the Canvas component is drawn full-screen, rotating the screen and then rotating back causes ghosting in the bottom navigation bar area due to delayed rendering during vertical scrolling and refresh drawing.  </p>
<p>If the Canvas component is not full-screen but drawn full-screen, adjust the Canvas component to full-screen.  </p>
<h4 id="3-How-to-prevent-modifying-the-positions-of-the-first-and-last-items-during-Grid-dragging-in-HarmonyOS"><a href="#3-How-to-prevent-modifying-the-positions-of-the-first-and-last-items-during-Grid-dragging-in-HarmonyOS" class="headerlink" title="3. How to prevent modifying the positions of the first and last items during Grid dragging in HarmonyOS?"></a>3. How to prevent modifying the positions of the first and last items during Grid dragging in HarmonyOS?</h4><p>Refer to the code below:  </p>
<pre><code class="language-typescript">import curves from &#39;@ohos.curves&#39;
@Entry
@Component
struct GridItemExample &#123;
  @State numbers: number[] = []
  @State dragItem: number = -1
  @State scaleItem: number = -1
  @State item: number = -1
  private dragRefOffsetx: number = 0
  private dragRefOffsety: number = 0
  @State offsetX: number = 0
  @State offsetY: number = 0
  private FIX_VP_X: number = 108
  private FIX_VP_Y: number = 120
  aboutToAppear() &#123;
    for (let i = 1; i &lt;= 11; i++) &#123;
      this.numbers.push(i)
    &#125;
  &#125;
  itemMove(index: number, newIndex: number): void &#123;
    console.info(&#39;index:&#39; + index + &#39; newIndex:&#39; + newIndex)
    if (!this.isDraggable(newIndex)) &#123;
      return
    &#125;
    let tmp = this.numbers.splice(index, 1)
    this.numbers.splice(newIndex, 0, tmp[0])
  &#125;
  // Down swipe
  down(index: number): void &#123;
    // Specify fixed GridItems that do not respond to events
    if (!this.isDraggable(index + 3)) &#123;
      return
    &#125;
    this.offsetY -= this.FIX_VP_Y
    this.dragRefOffsety += this.FIX_VP_Y
    this.itemMove(index, index + 3)
  &#125;
  // Down swipe (empty lower-right corner)
  down2(index: number): void &#123;
    if (!this.isDraggable(index + 3)) &#123;
      return
    &#125;
    this.offsetY -= this.FIX_VP_Y
    this.dragRefOffsety += this.FIX_VP_Y
    this.itemMove(index, index + 3)
  &#125;
  // Up swipe
  up(index: number): void &#123;
    if (!this.isDraggable(index - 3)) &#123;
      return
    &#125;
    this.offsetY += this.FIX_VP_Y
    this.dragRefOffsety -= this.FIX_VP_Y
    this.itemMove(index, index - 3)
  &#125;
  // Left swipe
  left(index: number): void &#123;
    if (!this.isDraggable(index - 1)) &#123;
      return
    &#125;
    this.offsetX += this.FIX_VP_X
    this.dragRefOffsetx -= this.FIX_VP_X
    this.itemMove(index, index - 1)
  &#125;
  // Right swipe
  right(index: number): void &#123;
    if (!this.isDraggable(index + 1)) &#123;
      return
    &#125;
    this.offsetX -= this.FIX_VP_X
    this.dragRefOffsetx += this.FIX_VP_X
    this.itemMove(index, index + 1)
  &#125;
  // Lower right swipe
  lowerRight(index: number): void &#123;
    if (!this.isDraggable(index + 4)) &#123;
      return
    &#125;
    this.offsetX -= this.FIX_VP_X
    this.dragRefOffsetx += this.FIX_VP_X
    this.offsetY -= this.FIX_VP_Y
    this.dragRefOffsety += this.FIX_VP_Y
    this.itemMove(index, index + 4)
  &#125;
  // Upper right swipe
  upperRight(index: number): void &#123;
    if (!this.isDraggable(index - 2)) &#123;
      return
    &#125;
    this.offsetX -= this.FIX_VP_X
    this.dragRefOffsetx += this.FIX_VP_X
    this.offsetY += this.FIX_VP_Y
    this.dragRefOffsety -= this.FIX_VP_Y
    this.itemMove(index, index - 2)
  &#125;
  // Lower left swipe
  lowerLeft(index: number): void &#123;
    if (!this.isDraggable(index + 2)) &#123;
      return
    &#125;
    this.offsetX += this.FIX_VP_X
    this.dragRefOffsetx -= this.FIX_VP_X
    this.offsetY -= this.FIX_VP_Y
    this.dragRefOffsety += this.FIX_VP_Y
    this.itemMove(index, index + 2)
  &#125;
  // Upper left swipe
  upperLeft(index: number): void &#123;
    if (!this.isDraggable(index - 4)) &#123;
      return
    &#125;
    this.offsetX += this.FIX_VP_X
    this.dragRefOffsetx -= this.FIX_VP_X
    this.offsetY += this.FIX_VP_Y
    this.dragRefOffsety -= this.FIX_VP_Y
    this.itemMove(index, index - 4)
  &#125;
  isDraggable(index: number): boolean &#123;
    console.info(&#39;index:&#39; + index)
    return index &gt; 0 &amp;&amp; index != this.numbers.length - 1;
  &#125;
  build() &#123;
    Column(&#123; space: 10 &#125;) &#123;
      Column(&#123; space: 5 &#125;) &#123;
        Text(&quot;Grid Drag and Drop Sorting Effect&quot;)
        Text(&quot;First and last components cannot be dragged&quot;)
      &#125;
      Grid() &#123;
        ForEach(this.numbers, (item: number) =&gt; &#123;
          GridItem() &#123;
            Text(item + &#39;&#39;)
              .fontSize(16)
              .width(&#39;100%&#39;)
              .textAlign(TextAlign.Center)
              .height(100)
              .borderRadius(10)
              .backgroundColor(0xFFFFFF)
              .shadow(this.scaleItem == item ? &#123;
                radius: 70,
                color: &#39;#15000000&#39;,
                offsetX: 0,
                offsetY: 0
              &#125; :
                &#123;
                  radius: 0,
                  color: &#39;#15000000&#39;,
                  offsetX: 0,
                  offsetY: 0
                &#125;)
              .animation(&#123; curve: Curve.Sharp, duration: 300 &#125;)
          &#125;
          // Specify fixed GridItems that do not respond to events
          .hitTestBehavior(this.isDraggable(this.numbers.indexOf(item)) ? HitTestMode.Default : HitTestMode.None)
          .scale(&#123; x: this.scaleItem == item ? 1.05 : 1, y: this.scaleItem == item ? 1.05 : 1 &#125;)
          .zIndex(this.dragItem == item ? 1 : 0)
          .translate(this.dragItem == item ? &#123; x: this.offsetX, y: this.offsetY &#125; : &#123; x: 0, y: 0 &#125;)
          .padding(10)
          .gesture(
            // The following combined gestures are recognized in sequence; drag gestures will not trigger if long-press gestures do not fire normally
            GestureGroup(GestureMode.Sequence,
              LongPressGesture(&#123; repeat: true &#125;)
                .onAction((event?: GestureEvent) =&gt; &#123;
                  animateTo(&#123; curve: Curve.Friction, duration: 300 &#125;, () =&gt; &#123;
                    this.scaleItem = item
                  &#125;)
                &#125;)
                .onActionEnd(() =&gt; &#123;
                  animateTo(&#123; curve: Curve.Friction, duration: 300 &#125;, () =&gt; &#123;
                    this.scaleItem = -1
                  &#125;)
                &#125;),
              PanGesture(&#123; fingers: 1, direction: null, distance: 0 &#125;)
                .onActionStart(() =&gt; &#123;
                  this.dragItem = item
                  this.dragRefOffsetx = 0
                  this.dragRefOffsety = 0
                &#125;)
                .onActionUpdate((event: GestureEvent) =&gt; &#123;
                  this.offsetY = event.offsetY - this.dragRefOffsety
                  this.offsetX = event.offsetX - this.dragRefOffsetx
                  animateTo(&#123; curve: curves.interpolatingSpring(0, 1, 400, 38) &#125;, () =&gt; &#123;
                    let index = this.numbers.indexOf(this.dragItem)
                    if (this.offsetY &gt;= this.FIX_VP_Y / 2 &amp;&amp; (this.offsetX &lt;= 44 &amp;&amp; this.offsetX &gt;= -44)
                      &amp;&amp; ![8, 9, 10].includes(index)) &#123;
                      // Down swipe
                      this.down(index)
                    &#125; else if (this.offsetY &lt;= -this.FIX_VP_Y / 2 &amp;&amp; (this.offsetX &lt;= 44 &amp;&amp; this.offsetX &gt;= -44)
                      &amp;&amp; ![0, 1, 2].includes(index)) &#123;
                      // Up swipe
                      this.up(index)
                    &#125; else if (this.offsetX &gt;= this.FIX_VP_X / 2 &amp;&amp; (this.offsetY &lt;= 50 &amp;&amp; this.offsetY &gt;= -50)
                      &amp;&amp; ![2, 5, 8, 10].includes(index)) &#123;
                      // Right swipe
                      this.right(index)
                    &#125; else if (this.offsetX &lt;= -this.FIX_VP_X / 2 &amp;&amp; (this.offsetY &lt;= 50 &amp;&amp; this.offsetY &gt;= -50)
                      &amp;&amp; ![0, 3, 6, 9].includes(index)) &#123;
                      // Left swipe
                      this.left(index)
                    &#125; else if (this.offsetX &gt;= this.FIX_VP_X / 2 &amp;&amp; this.offsetY &gt;= this.FIX_VP_Y / 2
                      &amp;&amp; ![2, 5, 7, 8, 9, 10].includes(index)) &#123;
                      // Lower right swipe
                      this.lowerRight(index)
                    &#125; else if (this.offsetX &gt;= this.FIX_VP_X / 2 &amp;&amp; this.offsetY &lt;= -this.FIX_VP_Y / 2
                      &amp;&amp; ![0, 1, 2, 5, 8].includes(index)) &#123;
                      // Upper right swipe
                      this.upperRight(index)
                    &#125; else if (this.offsetX &lt;= -this.FIX_VP_X / 2 &amp;&amp; this.offsetY &gt;= this.FIX_VP_Y / 2
                      &amp;&amp; ![0, 3, 6, 9, 10].includes(index)) &#123;
                      // Lower left swipe
                      this.lowerLeft(index)
                    &#125; else if (this.offsetX &lt;= -this.FIX_VP_X / 2 &amp;&amp; this.offsetY &lt;= -this.FIX_VP_Y / 2
                      &amp;&amp; ![0, 1, 2, 3, 6, 9].includes(index)) &#123;
                      // Upper left swipe
                      this.upperLeft(index)
                    &#125; else if (this.offsetX &gt;= this.FIX_VP_X / 2 &amp;&amp; this.offsetY &gt;= this.FIX_VP_Y / 2
                      &amp;&amp; [7].includes(index)) &#123;
                      // Lower right swipe (empty lower-right corner)
                      this.down2(index)
                    &#125;
                  &#125;)
                &#125;)
                .onActionEnd(() =&gt; &#123;
                  animateTo(&#123; curve: curves.interpolatingSpring(0, 1, 400, 38) &#125;, () =&gt; &#123;
                    this.dragItem = -1
                  &#125;)
                  animateTo(&#123;
                    curve: curves.interpolatingSpring(14, 1, 170, 17), delay: 150
                  &#125;, () =&gt; &#123;
                    this.scaleItem = -1
                  &#125;)
                &#125;)
            )
              .onCancel(() =&gt; &#123;
                animateTo(&#123; curve: curves.interpolatingSpring(0, 1, 400, 38) &#125;, () =&gt; &#123;
                  this.dragItem = -1
                &#125;)
                animateTo(&#123;
                  curve: curves.interpolatingSpring(14, 1, 170, 17)
                &#125;, () =&gt; &#123;
                  this.scaleItem = -1
                &#125;)
              &#125;)
          )
        &#125;, (item: number) =&gt; item.toString())
      &#125;
      .width(&#39;90%&#39;)
      .editMode(true)
      .scrollBar(BarState.Off)
      .columnsTemplate(&quot;1fr 1fr 1fr&quot;)
    &#125;.width(&#39;100%&#39;).height(&#39;100%&#39;).backgroundColor(&#39;#0D182431&#39;).padding(&#123; top: 5 &#125;)
  &#125;
&#125;
</code></pre>
<h4 id="4-When-using-Webview-to-load-the-Huawei-homepage-in-HarmonyOS-an-operation-bar-appears-and-the-width-does-not-adapt-automatically"><a href="#4-When-using-Webview-to-load-the-Huawei-homepage-in-HarmonyOS-an-operation-bar-appears-and-the-width-does-not-adapt-automatically" class="headerlink" title="4. When using Webview to load the Huawei homepage in HarmonyOS, an operation bar appears, and the width does not adapt automatically."></a>4. When using Webview to load the Huawei homepage in HarmonyOS, an operation bar appears, and the width does not adapt automatically.</h4><pre><code class="language-typescript">import web_webview from &#39;@ohos.web.webview&#39;;
@Entry
@Component
struct WebComponent &#123;
  controller: web_webview.WebviewController = new web_webview.WebviewController();
  @State userAgent: string =
    &#39;Mozilla/5.0 (Phone; OpenHarmony 4.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 ArkWeb/4.1.6.1 Mobile automobile/792&#39;
  aboutToAppear() &#123;
    web_webview.WebviewController.setWebDebuggingAccess(true);
  &#125;
  build() &#123;
    Column() &#123;
      Web(&#123; src: &quot;&quot;, controller: this.controller &#125;)
        .javaScriptAccess(true)
        .domStorageAccess(true)
        .width(&quot;100%&quot;)
        .height(&quot;100%&quot;)
        .onControllerAttached(() =&gt; &#123;
          this.controller.setCustomUserAgent(this.userAgent);
          this.controller.loadUrl(&quot;www.huawei.com&quot;)
        &#125;)
    &#125;
  &#125;
&#125;
</code></pre>
<h4 id="5-In-HarmonyOS-Grid-dragging-how-to-make-some-items-ignore-dragging"><a href="#5-In-HarmonyOS-Grid-dragging-how-to-make-some-items-ignore-dragging" class="headerlink" title="5. In HarmonyOS Grid dragging, how to make some items ignore dragging?"></a>5. In HarmonyOS Grid dragging, how to make some items ignore dragging?</h4><p>The entire page uses a Grid layout. How to make some items ignore dragging during the dragging process? For example, in the following layout: 1 2 3 4 5 6 7 8 9, the first element occupies a full row, and the rest are arranged 4 per row. When dragging the 8th element, it should swap with 2, 3, 4, 5, 6, 7, 8, and the first element should not respond to swap animations even if the dragged element is moved to its position.  </p>
<p>Refer to the following Demo:  </p>
<pre><code class="language-typescript">@Entry
@Component
struct GridExample &#123;
  @State numbers: string[] = []
  scroller: Scroller = new Scroller()
  layoutOptions1: GridLayoutOptions = &#123;
    regularSize: [1, 1], // Only supports [1, 1]
    irregularIndexes: [0], // The GridItem at index 0 occupies a full row
  &#125;
  @State text: string = &#39;drag&#39;

  @Builder pixelMapBuilder() &#123; // Style during dragging
    Column() &#123;
      Text(this.text)
        .fontSize(16)
        .backgroundColor(0xF9CF93)
        .width(80)
        .height(80)
        .textAlign(TextAlign.Center)
    &#125;
  &#125;

  aboutToAppear() &#123;
    for (let i = 1; i &lt;= 9; i++) &#123;
      this.numbers.push(i + &#39;&#39;)
    &#125;
  &#125;

  changeIndex(index1: number, index2: number) &#123; // Swap positions in the array
    const temp = this.numbers[index1];
    if (index1 &gt; index2) &#123;
      this.numbers.splice(index2, 0, temp);
      this.numbers.splice(index1 + 1, 1);
    &#125; else &#123;
      this.numbers.splice(index2 + 1, 0, temp);
      this.numbers.splice(index1, 1);
    &#125;
  &#125;

  build() &#123;
    Column(&#123; space: 
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41215-Daily-HarmonyOS-Next-Knowledge-Web-Component-Safe-Area-any-Related-Issues-Flow-Layout-Collapse-Effect-Double-Callback-Triggered-by-Click-and-Invalid-History/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41215-Daily-HarmonyOS-Next-Knowledge-Web-Component-Safe-Area-any-Related-Issues-Flow-Layout-Collapse-Effect-Double-Callback-Triggered-by-Click-and-Invalid-History/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Web Component Safe Area, any-Related Issues, Flow Layout Collapse Effect, Double Callback Triggered by Click, and Invalid History</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 08:42:43 / Modified: 09:36:53" itemprop="dateCreated datePublished" datetime="2025-06-29T08:42:43+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Web-Component-Safe-Area-any-Related-Issues-Flow-Layout-Collapse-Effect-Double-Callback-Triggered-by-Click-and-Invalid-History"><a href="#Daily-HarmonyOS-Next-Knowledge-Web-Component-Safe-Area-any-Related-Issues-Flow-Layout-Collapse-Effect-Double-Callback-Triggered-by-Click-and-Invalid-History" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Web Component Safe Area, any-Related Issues, Flow Layout Collapse Effect, Double Callback Triggered by Click, and Invalid History"></a>[Daily HarmonyOS Next Knowledge] Web Component Safe Area, any-Related Issues, Flow Layout Collapse Effect, Double Callback Triggered by Click, and Invalid History</h1><h4 id="1-The-safe-area-values-of-HarmonyOS-Web-components-are-incorrect-failing-to-avoid-the-bottom-navigation-bar"><a href="#1-The-safe-area-values-of-HarmonyOS-Web-components-are-incorrect-failing-to-avoid-the-bottom-navigation-bar" class="headerlink" title="1. The safe area values of HarmonyOS Web components are incorrect, failing to avoid the bottom navigation bar."></a>1. The safe area values of HarmonyOS Web components are incorrect, failing to avoid the bottom navigation bar.</h4><p>A meta tag needs to be added:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, viewport-fit=cover&quot; /&gt;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">#### 2. Why can&#x27;t the type `any` be used in HarmonyOS Map, but system APIs can use it?  </span><br><span class="line">- Why is `any` unsupported for Map types while system APIs can use it?  </span><br><span class="line">  Currently, `any` and `unknown` can be used in TS. System APIs are in `.d.ts` format, allowing `any` usage. As ArkTS is compatible with TS, no restrictions apply when ETS calls TS. For `.d.ts` files (TS code), ArkTS syntax recommends explicit parameter types, such as `Map&lt;string, string|number|boolean&gt;`. If necessary, use `EsObject` instead of `any`.  </span><br><span class="line"></span><br><span class="line">#### 3. Flow layout collapse effect in HarmonyOS  </span><br><span class="line">Is there a control that hides content exceeding 2 lines, displays a collapse arrow for the last line, and expands the remaining lines when the arrow is clicked?  </span><br><span class="line">- No such control exists, but it can be implemented using a List. For specific implementation, refer to: https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ohos-arkui-advanced-filter-V5  </span><br><span class="line">- Flow layout in HarmonyOS can be achieved via Flex layout. Demo:  </span><br><span class="line">```typescript</span><br><span class="line">import measure from &#x27;@ohos.measure&#x27;;</span><br><span class="line">import display from &#x27;@ohos.display&#x27;;</span><br><span class="line"></span><br><span class="line">const childMaxWidth: number = 325; // Width in px for subsequent calculations</span><br><span class="line">let displayClass: display.Display | null = null;</span><br><span class="line">let componentWidth: number = 0;</span><br><span class="line">try &#123;</span><br><span class="line">  displayClass = display.getDefaultDisplaySync();</span><br><span class="line">  componentWidth = displayClass.width;</span><br><span class="line">&#125; catch (exception) &#123;</span><br><span class="line">  console.error(&#x27;Failed to obtain the default display object. Code: &#x27; + JSON.stringify(exception));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Component</span><br><span class="line">struct TextItem &#123;</span><br><span class="line">  @State message: string = &#x27;&#x27;;</span><br><span class="line">  @Prop fontSizeData: number;</span><br><span class="line"></span><br><span class="line">  build() &#123;</span><br><span class="line">    Text(this.message)</span><br><span class="line">      .fontSize(this.fontSizeData)</span><br><span class="line">      .margin(&#123; left: 10, top: 10 &#125;)</span><br><span class="line">      .backgroundColor(&#x27;#c4c2cc&#x27;)</span><br><span class="line">      .constraintSize(&#123; maxWidth: childMaxWidth + &#x27;px&#x27; &#125;)</span><br><span class="line">      .maxLines(1)</span><br><span class="line">      .textOverflow(&#123; overflow: TextOverflow.Ellipsis &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line">struct Index2 &#123;</span><br><span class="line">  @State @Watch(&#x27;IndexChange&#x27;) index: number = 0;</span><br><span class="line">  @State @Watch(&#x27;textChange&#x27;) message: string = &#x27;&#x27;;</span><br><span class="line">  @State FlexWidth: string = &#x27;80%&#x27;;</span><br><span class="line">  @State newIndex: number = 0;</span><br><span class="line">  @State heightControl: number | string = 100;</span><br><span class="line">  @State ButtonText: string = &#x27;∨&#x27;;</span><br><span class="line">  @State AllData: string[] = [&#x27;1&#x27;, &#x27;22&#x27;, &#x27;333&#x27;, &#x27;44444&#x27;, &#x27;55&#x27;, &#x27;666&#x27;, &#x27;7777&#x27;, &#x27;8888888888888&#x27;, &#x27;99&#x27;, &#x27;3434&#x27;, &#x27;5656&#x27;, &#x27;7878&#x27;, &#x27;141414141&#x27;, &#x27;68681&#x27;];</span><br><span class="line">  @State SomeData: string[] = [];</span><br><span class="line">  @State ShowData: string[] = [];</span><br><span class="line">  @State fontSizeData: number = 30;</span><br><span class="line">  @State AllWidth: number = 0;</span><br><span class="line">  @State textWidth: number = 0;</span><br><span class="line">  @State restrictWidth: number = 0;</span><br><span class="line"></span><br><span class="line">  IndexChange() &#123;</span><br><span class="line">    if (this.AllWidth &gt;= (this.restrictWidth - childMaxWidth) &amp;&amp; this.AllWidth &lt;= (this.restrictWidth)) &#123;</span><br><span class="line">      this.newIndex = this.index;</span><br><span class="line">      console.log(&#x27;text1 newIndex&#x27;, this.newIndex);</span><br><span class="line">      console.log(&#x27;text1 change&#x27;, this.newIndex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  textChange() &#123;</span><br><span class="line">    let content: string = this.message;</span><br><span class="line">    this.textWidth = measure.measureText(&#123;</span><br><span class="line">      textContent: content,</span><br><span class="line">      fontSize: this.fontSizeData</span><br><span class="line">    &#125;);</span><br><span class="line">    if (this.textWidth &gt; childMaxWidth) &#123;</span><br><span class="line">      this.AllWidth += childMaxWidth;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      this.AllWidth += this.textWidth;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(&#x27;text1 content&#x27;, content);</span><br><span class="line">    console.log(&#x27;text1 Width&#x27;, this.textWidth);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  aboutToAppear(): void &#123;</span><br><span class="line">    if (componentWidth != 0) &#123;</span><br><span class="line">      this.restrictWidth = Math.floor((parseFloat(this.FlexWidth) * componentWidth) * 1.3 * 0.01);</span><br><span class="line">      console.log(&#x27;text1 componentWidth&#x27;, componentWidth);</span><br><span class="line">      console.log(&#x27;text1 restrictWidth&#x27;, this.restrictWidth);</span><br><span class="line">    &#125;</span><br><span class="line">    for (let i = 0; i &lt; this.AllData.length; i++) &#123;</span><br><span class="line">      this.message = this.AllData[i];</span><br><span class="line">      this.index = i;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(&#x27;text1 change newIndex&#x27;, this.newIndex);</span><br><span class="line">    this.SomeData = this.AllData.slice(0, this.newIndex + 1);</span><br><span class="line">    this.ShowData = this.SomeData;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  build() &#123;</span><br><span class="line">    Row() &#123;</span><br><span class="line">      Column() &#123;</span><br><span class="line">        Flex(&#123; wrap: FlexWrap.Wrap &#125;) &#123;</span><br><span class="line">          ForEach(</span><br><span class="line">            this.ShowData,</span><br><span class="line">            (item: string) =&gt; &#123;</span><br><span class="line">              TextItem(&#123; message: item, fontSizeData: this.fontSizeData &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          );</span><br><span class="line">          Button(this.ButtonText)</span><br><span class="line">            .onClick(() =&gt; &#123;</span><br><span class="line">              if (this.heightControl === 100) &#123;</span><br><span class="line">                this.heightControl = &#x27;100%&#x27;;</span><br><span class="line">                this.ButtonText = &#x27;^&#x27;;</span><br><span class="line">                this.ShowData = this.AllData;</span><br><span class="line">              &#125; else &#123;</span><br><span class="line">                this.heightControl = 100;</span><br><span class="line">                this.ButtonText = &#x27;v&#x27;;</span><br><span class="line">                this.ShowData = this.SomeData;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .width(40)</span><br><span class="line">            .height(30)</span><br><span class="line">            .margin(&#123; left: 10, top: 10 &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        .constraintSize(&#123; maxHeight: this.heightControl &#125;)</span><br><span class="line">        .border(&#123; width: 1 &#125;)</span><br><span class="line">        .width(this.FlexWidth)</span><br><span class="line">        .margin(&#123; left: &#x27;5%&#x27; &#125;)</span><br><span class="line">        .clip(true);</span><br><span class="line">      &#125;</span><br><span class="line">      .width(&#x27;100%&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    .height(&#x27;100%&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">#### 4. In HarmonyOS, clicking a slide in swiper 5x/6x versions on H5 pages triggers double callbacks.  </span><br><span class="line">The `swiper.js` file checks for device types but not HarmonyOS, leading to duplicate event registrations and double callback executions. It is recommended to download the file, add HarmonyOS detection, and reference the modified JS locally.  </span><br><span class="line">```javascript</span><br><span class="line">if (Support.touch) &#123;</span><br><span class="line">  var passiveListener = touchEvents.start === &#x27;touchstart&#x27; &amp;&amp; Support.passiveListener &amp;&amp; params.passiveListeners ? &#123; passive: true, capture: false &#125; : false;</span><br><span class="line">  el.addEventListener(touchEvents.start, swiper.onTouchStart, passiveListener);</span><br><span class="line">  el.addEventListener(touchEvents.move, swiper.onTouchMove, Support.passiveListener ? &#123; passive: false, capture: capture &#125; : capture);</span><br><span class="line">  el.addEventListener(touchEvents.end, swiper.onTouchEnd, passiveListener);</span><br><span class="line">  if (touchEvents.cancel) &#123;</span><br><span class="line">    el.addEventListener(touchEvents.cancel, swiper.onTouchEnd, passiveListener);</span><br><span class="line">  &#125;</span><br><span class="line">  if (!dummyEventAttached) &#123;</span><br><span class="line">    doc.addEventListener(&#x27;touchstart&#x27;, dummyEventListener);</span><br><span class="line">    dummyEventAttached = true;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">if (params.simulateTouch ) || (params.simulateTouch) &#123;</span><br><span class="line">  el.addEventListener(&#x27;mousedown&#x27;, swiper.onTouchStart, false);</span><br><span class="line">  doc.addEventListener(&#x27;mousemove&#x27;, swiper.onTouchMove, capture);</span><br><span class="line">  doc.addEventListener(&#x27;mouseup&#x27;, swiper.onTouchEnd, false);</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">#### 5. window.history is invalid for H5 pages in HarmonyOS.  </span><br><span class="line">After entering a native page and consecutively opening multiple H5 pages, swiping or pressing the physical back button directly returns to the first native page.  </span><br><span class="line">- To swipe back or return to the previous H5 page, listen for the back gesture in the component&#x27;s `onBackPress` lifecycle. This event triggers when the user clicks the back button and only takes effect for custom components decorated with `@Entry`. Returning `true` means the page handles back logic itself without routing; returning `false` uses the default routing back logic (no return value defaults to `false`).  </span><br><span class="line">  Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-custom-component-lifecycle-V5#onbackpress  </span><br><span class="line">```typescript</span><br><span class="line">onBackPress() &#123;</span><br><span class="line">  if (this.controller.accessBackward()) &#123;</span><br><span class="line">    this.controller.backward();</span><br><span class="line">    return true;</span><br><span class="line">  &#125;</span><br><span class="line">  return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41214-Daily-HarmonyOS-Next-Knowledge-Immersive-Status-Bar-Implementation-of-ref-like-Attributes-Transparent-Background-for-Custom-Dialogs-RichEditor-Paste-Callback-and-Auto-Scrolling-List/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41214-Daily-HarmonyOS-Next-Knowledge-Immersive-Status-Bar-Implementation-of-ref-like-Attributes-Transparent-Background-for-Custom-Dialogs-RichEditor-Paste-Callback-and-Auto-Scrolling-List/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Immersive Status Bar, Implementation of ref-like Attributes, Transparent Background for Custom Dialogs, RichEditor Paste Callback, and Auto-Scrolling List</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 08:41:55 / Modified: 08:42:10" itemprop="dateCreated datePublished" datetime="2025-06-29T08:41:55+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Immersive-Status-Bar-Implementation-of-ref-like-Attributes-Transparent-Background-for-Custom-Dialogs-RichEditor-Paste-Callback-and-Auto-Scrolling-List"><a href="#Daily-HarmonyOS-Next-Knowledge-Immersive-Status-Bar-Implementation-of-ref-like-Attributes-Transparent-Background-for-Custom-Dialogs-RichEditor-Paste-Callback-and-Auto-Scrolling-List" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Immersive Status Bar, Implementation of ref-like Attributes, Transparent Background for Custom Dialogs, RichEditor Paste Callback, and Auto-Scrolling List"></a>[Daily HarmonyOS Next Knowledge] Immersive Status Bar, Implementation of ref-like Attributes, Transparent Background for Custom Dialogs, RichEditor Paste Callback, and Auto-Scrolling List</h1><h4 id="1-HarmonyOS-Immersive-Status-Bar"><a href="#1-HarmonyOS-Immersive-Status-Bar" class="headerlink" title="1. HarmonyOS Immersive Status Bar"></a>1. HarmonyOS Immersive Status Bar</h4><p>When implementing immersive status bar functionality, each custom component currently requires a <code>padding top</code> set to the status bar height. Is there a way to set this uniformly without adding <code>padding top</code> to each component?  </p>
<p>There is currently no uniform setting method. You can encapsulate the <code>padding top</code> for each page’s bottom into a unified component and introduce it on each page for consistent maintenance, improving development efficiency and reducing maintenance costs.  </p>
<h4 id="2-How-to-Implement-ref-like-Attribute-Functionality-in-HarmonyOS-Custom-Components-Similar-to-React-or-Vue-in-Web-Development"><a href="#2-How-to-Implement-ref-like-Attribute-Functionality-in-HarmonyOS-Custom-Components-Similar-to-React-or-Vue-in-Web-Development" class="headerlink" title="2. How to Implement ref-like Attribute Functionality in HarmonyOS Custom Components (Similar to React or Vue in Web Development)?"></a>2. How to Implement ref-like Attribute Functionality in HarmonyOS Custom Components (Similar to React or Vue in Web Development)?</h4><p>In React or Vue, the <code>ref</code> attribute obtains a reference to a component to call methods exposed to the outside. In HarmonyOS development, system-built components like <code>Web</code> have corresponding controllers. For custom components, how to implement controller functionality? For example, encapsulating a <code>LottieView</code> to declaratively display Lottie animations while exposing methods like <code>play()</code>, <code>pause()</code>, <code>stop()</code> for external use.  </p>
<p>Refer to the following case: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/forum/topic/0203144585061300847?fid=0109140870620153026">https://developer.huawei.com/consumer/cn/forum/topic/0203144585061300847?fid=0109140870620153026</a>  </p>
<h4 id="3-Transparent-Background-for-HarmonyOS-CustomDialogController"><a href="#3-Transparent-Background-for-HarmonyOS-CustomDialogController" class="headerlink" title="3. Transparent Background for HarmonyOS CustomDialogController"></a>3. Transparent Background for HarmonyOS CustomDialogController</h4><p>When customizing a view with <code>CustomDialogController</code>, setting the background color to <code>Color.Transparent</code> is ineffective, and the default is white. How to set the background to transparent?  </p>
<p>Set <code>customStyle</code> to <code>true</code> for custom styling, which makes the background transparent.<br>Documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-methods-custom-dialog-box-V5#customdialogcontrolleroptions%E5%AF%B9%E8%B1%A1%E8%AF%B4%E6%98%8E">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-methods-custom-dialog-box-V5#customdialogcontrolleroptions%E5%AF%B9%E8%B1%A1%E8%AF%B4%E6%98%8E</a>  </p>
<h4 id="4-No-Callback-for-HarmonyOS-RichEditor-Paste-Events"><a href="#4-No-Callback-for-HarmonyOS-RichEditor-Paste-Events" class="headerlink" title="4. No Callback for HarmonyOS RichEditor Paste Events"></a>4. No Callback for HarmonyOS RichEditor Paste Events</h4><p><code>RichEditor</code> triggers callbacks for <code>aboutToIMEInput</code> and <code>onIMEInputComplete</code> during input or deletion, but not for direct pasting. The documentation provides an <code>onPaste</code> method, which only blocks the default paste event. Is there a callback for successful pasting?  </p>
<p>Add a timer in the <code>onPaste</code> callback for the paste completion event:  </p>
<pre><code class="language-typescript">.onPaste((): void =&gt; &#123;
  setTimeout(() =&gt; &#123;
    const spans = this.controller.getSpans();
    console.log(spans.length.toString() + JSON.stringify(spans));
  &#125;, 0);
&#125;)
</code></pre>
<h4 id="5-Auto-Horizontal-Scrolling-List-in-HarmonyOS"><a href="#5-Auto-Horizontal-Scrolling-List-in-HarmonyOS" class="headerlink" title="5. Auto-Horizontal Scrolling List in HarmonyOS"></a>5. Auto-Horizontal Scrolling List in HarmonyOS</h4><p>Refer to the following code. For auto-scrolling, use <code>setInterval</code> to call <code>scroller.scrollTo</code>:  </p>
<pre><code class="language-typescript">class Article &#123;
  id: string;
  title: string;
  brief: string;

  constructor(id: string, title: string, brief: string) &#123;
    this.id = id;
    this.title = title;
    this.brief = brief;
  &#125;
&#125;

@Entry
@Component
struct ArticleListView &#123;
  @State isListReachEnd: boolean = false;
  @State articleList: Array&lt;Article&gt; = [
    new Article(&#39;001&#39;, &#39;第1篇文章&#39;, &#39;文章简介内容&#39;),
    new Article(&#39;002&#39;, &#39;第2篇文章&#39;, &#39;文章简介内容&#39;),
    new Article(&#39;003&#39;, &#39;第3篇文章&#39;, &#39;文章简介内容&#39;),
    new Article(&#39;004&#39;, &#39;第4篇文章&#39;, &#39;文章简介内容&#39;),
    new Article(&#39;005&#39;, &#39;第5篇文章&#39;, &#39;文章简介内容&#39;),
    new Article(&#39;006&#39;, &#39;第6篇文章&#39;, &#39;文章简介内容&#39;)
  ]

  loadMoreArticles() &#123;
    this.articleList.push(this.articleList[0]);
    this.articleList.splice(0, 1);
  &#125;

  build() &#123;
    Column(&#123; space: 5 &#125;) &#123;
      List() &#123;
        ForEach(this.articleList, (item: Article) =&gt; &#123;
          ListItem() &#123;
            ArticleCard(&#123; article: item &#125;)
              .margin(&#123; top: 20 &#125;)
          &#125;
        &#125;, (item: Article) =&gt; item.id)
      &#125;
      .onReachEnd(() =&gt; &#123;
        this.loadMoreArticles();
      &#125;)
      .padding(20)
      .scrollBar(BarState.Off)
    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;)
    .backgroundColor(0xF1F3F5)
  &#125;
&#125;

@Component
struct ArticleCard &#123;
  @Prop article: Article;

  build() &#123;
    Row() &#123;
      Image($r(&#39;app.media.startIcon&#39;))
        .width(80)
        .height(80)
        .margin(&#123; right: 20 &#125;)
      Column() &#123;
        Text(this.article.title)
          .fontSize(20)
          .margin(&#123; bottom: 8 &#125;)
        Text(this.article.brief)
          .fontSize(16)
          .fontColor(Color.Gray)
          .margin(&#123; bottom: 8 &#125;)
      &#125;
      .alignItems(HorizontalAlign.Start)
      .width(&#39;80%&#39;)
      .height(&#39;100%&#39;)
    &#125;
    .padding(20)
    .borderRadius(12)
    .backgroundColor(&#39;#FFECECEC&#39;)
    .height(120)
    .width(&#39;100%&#39;)
    .justifyContent(FlexAlign.SpaceBetween)
  &#125;
&#125;
</code></pre>
<p>Refer to the following case for implementation: <a target="_blank" rel="noopener" href="https://gitee.com/harmonyos-cases/cases/tree/master/CommonAppDevelopment/feature/marquee">https://gitee.com/harmonyos-cases/cases/tree/master/CommonAppDevelopment/feature/marquee</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41213-Daily-HarmonyOS-Next-Knowledge-Reverse-Page-Data-Passing-Image-Filling-Issues-Clearing-Web-Cache-Refresh-Support-for-Swiper-POP-Color-Not-Working/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41213-Daily-HarmonyOS-Next-Knowledge-Reverse-Page-Data-Passing-Image-Filling-Issues-Clearing-Web-Cache-Refresh-Support-for-Swiper-POP-Color-Not-Working/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Reverse Page Data Passing, Image Filling Issues, Clearing Web Cache, Refresh Support for Swiper, POP Color Not Working</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 08:41:06 / Modified: 09:36:54" itemprop="dateCreated datePublished" datetime="2025-06-29T08:41:06+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Knowledge-Reverse-Page-Data-Passing-Image-Filling-Issues-Clearing-Web-Cache-Refresh-Support-for-Swiper-POP-Color-Not-Working"><a href="#Daily-HarmonyOS-Knowledge-Reverse-Page-Data-Passing-Image-Filling-Issues-Clearing-Web-Cache-Refresh-Support-for-Swiper-POP-Color-Not-Working" class="headerlink" title="[Daily HarmonyOS Knowledge] Reverse Page Data Passing, Image Filling Issues, Clearing Web Cache, Refresh Support for Swiper, POP Color Not Working"></a>[Daily HarmonyOS Knowledge] Reverse Page Data Passing, Image Filling Issues, Clearing Web Cache, Refresh Support for Swiper, POP Color Not Working</h1><h4 id="1-How-to-pass-data-from-page-B-back-to-page-A-in-HarmonyOS"><a href="#1-How-to-pass-data-from-page-B-back-to-page-A-in-HarmonyOS" class="headerlink" title="1. How to pass data from page B back to page A in HarmonyOS?"></a>1. How to pass data from page B back to page A in HarmonyOS?</h4><p>When navigating from page A to page B and returning from B to A, how can parameters be passed back to page A?  </p>
<p>Create three pages: Index2, APage, and BPage, to implement bidirectional data passing. Code example:  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; router &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">APage</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">message</span>: <span class="built_in">string</span> = <span class="string">&#x27;I am Page A&#x27;</span>;</span><br><span class="line">  <span class="attr">fromPage</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; = router.<span class="title function_">getParams</span>() <span class="keyword">as</span> <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;;</span><br><span class="line">  <span class="meta">@StorageLink</span>(<span class="string">&#x27;flag&#x27;</span>) <span class="attr">flag</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">message</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&quot;Go to Page B&quot;</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fromPage</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">              router.<span class="title function_">pushUrl</span>(&#123;</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&quot;pages/BPage&quot;</span>,</span><br><span class="line">                <span class="attr">params</span>: &#123; <span class="attr">data</span>: <span class="string">&quot;BPage&quot;</span> &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fromPage</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;In Page A, stored: &quot;</span> + <span class="variable language_">this</span>.<span class="property">fromPage</span>[<span class="string">&#x27;data&#x27;</span>].<span class="title function_">toString</span>());</span><br><span class="line">                <span class="title class_">AppStorage</span>.<span class="title function_">set</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="variable language_">this</span>.<span class="property">fromPage</span>[<span class="string">&#x27;data&#x27;</span>].<span class="title function_">toString</span>());</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;In Page A, flag output: &quot;</span> + <span class="variable language_">this</span>.<span class="property">flag</span>);</span><br><span class="line">              &#125;</span><br><span class="line">              router.<span class="title function_">pushUrl</span>(&#123;</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&quot;pages/BPage&quot;</span>,</span><br><span class="line">                <span class="attr">params</span>: &#123; <span class="attr">data</span>: <span class="string">&quot;BPage&quot;</span> &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&quot;Go to Index2&quot;</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            router.<span class="title function_">pushUrl</span>(&#123;</span><br><span class="line">              <span class="attr">url</span>: <span class="string">&quot;pages/Index2&quot;</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; router &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">BPage</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">message</span>: <span class="built_in">string</span> = <span class="string">&#x27;I am Page B&#x27;</span>;</span><br><span class="line">  <span class="meta">@StorageLink</span>(<span class="string">&#x27;flag&#x27;</span>) <span class="attr">flag</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attr">fromPage</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; = router.<span class="title function_">getParams</span>() <span class="keyword">as</span> <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">message</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&quot;Go to Page A&quot;</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">fromPage</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;In Page B, stored: &quot;</span> + <span class="variable language_">this</span>.<span class="property">fromPage</span>[<span class="string">&#x27;data&#x27;</span>].<span class="title function_">toString</span>());</span><br><span class="line">              <span class="title class_">AppStorage</span>.<span class="title function_">set</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="variable language_">this</span>.<span class="property">fromPage</span>[<span class="string">&#x27;data&#x27;</span>].<span class="title function_">toString</span>());</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;In Page B, flag output: &quot;</span> + <span class="variable language_">this</span>.<span class="property">flag</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            router.<span class="title function_">pushUrl</span>(&#123;</span><br><span class="line">              <span class="attr">url</span>: <span class="string">&quot;pages/APage&quot;</span>,</span><br><span class="line">              <span class="attr">params</span>: &#123; <span class="attr">data</span>: <span class="string">&quot;APage&quot;</span> &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        <span class="title class_">Text</span>(<span class="string">&quot;Go to Index2&quot;</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            router.<span class="title function_">pushUrl</span>(&#123;</span><br><span class="line">              <span class="attr">url</span>: <span class="string">&quot;pages/Index2&quot;</span></span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; router &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index2</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">message</span>: <span class="built_in">string</span> = <span class="string">&#x27;Current Page&#x27;</span>;</span><br><span class="line">  <span class="meta">@StorageLink</span>(<span class="string">&#x27;flag&#x27;</span>) <span class="meta">@Watch</span>(<span class="string">&#x27;onChange&#x27;</span>) <span class="attr">flag</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">onChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">flag</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">message</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">flag</span> == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Flag initialization failed&#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              router.<span class="title function_">pushUrl</span>(&#123;</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&quot;pages/&quot;</span> + <span class="variable language_">this</span>.<span class="property">flag</span></span><br><span class="line">              &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 2. In HarmonyOS, if no width or height is set for a local image, will the image fill the entire screen?  </span></span><br><span class="line"><span class="string">By default, an `</span><span class="title class_">Image</span><span class="string">` component with no width or height specified will fill its parent container. `</span><span class="title class_">ObjectFit</span><span class="string">` only affects the image display, not the component&#x27;s dimensions.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To address this, obtain the original image dimensions using `</span><span class="title class_">PixelMap</span><span class="string">` and set the `</span><span class="title class_">Image</span><span class="string">` size accordingly.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 3. How to clear web cache from a non-web page in HarmonyOS?  </span></span><br><span class="line"><span class="string">Clear web cache globally without relying on a specific web page. Example:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">import</span> web_webview <span class="keyword">from</span> <span class="string">&#x27;@ohos.web.webview&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> business_error <span class="keyword">from</span> <span class="string">&#x27;@ohos.base&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index5</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">message</span>: <span class="built_in">string</span> = <span class="string">&#x27;Hello World&#x27;</span>;</span><br><span class="line">  <span class="attr">webcontroller</span>: web_webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> web_webview.<span class="title class_">WebviewController</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="comment">// Assign a Web component to a global context</span></span><br><span class="line">        <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: <span class="string">&#x27;https://www.huawei.com&#x27;</span>, <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webcontroller</span> &#125;)</span><br><span class="line">          .<span class="title function_">onControllerAttached</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">GlobalContext</span>.<span class="title function_">getContext</span>().<span class="title function_">setObject</span>(<span class="string">&#x27;webcontroller&#x27;</span>, <span class="variable language_">this</span>.<span class="property">webcontroller</span>);</span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">height</span>(<span class="number">200</span>)</span><br><span class="line">          .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>);</span><br><span class="line">        <span class="comment">// Clear cache button</span></span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&#x27;Remove Cache&#x27;</span>)</span><br><span class="line">          .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              <span class="keyword">let</span> webcontroller = <span class="title class_">GlobalContext</span>.<span class="title function_">getContext</span>().<span class="title function_">getObject</span>(<span class="string">&#x27;webcontroller&#x27;</span>) <span class="keyword">as</span> web_webview.<span class="property">WebviewController</span>;</span><br><span class="line">              webcontroller.<span class="title function_">removeCache</span>(<span class="literal">true</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">              <span class="keyword">let</span> <span class="attr">e</span>: business_error.<span class="property">BusinessError</span> = error <span class="keyword">as</span> business_error.<span class="property">BusinessError</span>;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`ErrorCode: <span class="subst">$&#123;e.code&#125;</span>, Message: <span class="subst">$&#123;e.message&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">GlobalContext</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="attr">instance</span>: <span class="title class_">GlobalContext</span>;</span><br><span class="line">  <span class="keyword">private</span> _objects = <span class="keyword">new</span> <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">Object</span>&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="title function_">getContext</span>(): <span class="title class_">GlobalContext</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title class_">GlobalContext</span>.<span class="property">instance</span>) &#123;</span><br><span class="line">      <span class="title class_">GlobalContext</span>.<span class="property">instance</span> = <span class="keyword">new</span> <span class="title class_">GlobalContext</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">GlobalContext</span>.<span class="property">instance</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getObject</span>(<span class="attr">value</span>: <span class="built_in">string</span>): <span class="title class_">Object</span> | <span class="literal">undefined</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_objects</span>.<span class="title function_">get</span>(value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">setObject</span>(<span class="attr">key</span>: <span class="built_in">string</span>, <span class="attr">objectClass</span>: <span class="title class_">Object</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_objects</span>.<span class="title function_">set</span>(key, objectClass);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 4. Does HarmonyOS Refresh support Swiper?  </span></span><br><span class="line"><span class="string">When using a `</span><span class="title class_">Swiper</span><span class="string">` for vertical page scrolling with pull-to-refresh functionality, `</span><span class="title class_">Refresh</span><span class="string">` may not work as expected.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Reference demo**:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">SwiperItemLeak</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">swiperController</span>: <span class="title class_">SwiperController</span> = <span class="keyword">new</span> <span class="title class_">SwiperController</span>();</span><br><span class="line">  <span class="keyword">private</span> curSwiperIndex = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">list</span>: <span class="built_in">number</span>[] = [];</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">isStopSwiperSlide</span>: <span class="built_in">boolean</span> = <span class="literal">false</span>;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">positionY</span>: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">isRefresh</span>: <span class="built_in">boolean</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">list</span>.<span class="title function_">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Stack</span>(&#123; <span class="attr">alignContent</span>: <span class="title class_">Alignment</span>.<span class="property">TopStart</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">positionY</span>.<span class="title function_">toString</span>())</span><br><span class="line">        .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">        .<span class="title function_">height</span>(<span class="string">&#x27;10%&#x27;</span>)</span><br><span class="line">        .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">30</span>);</span><br><span class="line">      <span class="title class_">Swiper</span>(<span class="variable language_">this</span>.<span class="property">swiperController</span>) &#123;</span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">list</span>, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">Text</span>(item.<span class="title function_">toString</span>())</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="number">0xAFEEEE</span> * ((item + <span class="number">1</span>) / <span class="number">0x0f</span>))</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">30</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">vertical</span>(<span class="literal">true</span>)</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">      .<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">      .<span class="title function_">cachedCount</span>(<span class="number">3</span>)</span><br><span class="line">      .<span class="title function_">index</span>(<span class="number">0</span>)</span><br><span class="line">      .<span class="title function_">autoPlay</span>(<span class="literal">false</span>)</span><br><span class="line">      .<span class="title function_">indicator</span>(<span class="literal">false</span>)</span><br><span class="line">      .<span class="title function_">effectMode</span>(<span class="title class_">EdgeEffect</span>.<span class="property">None</span>)</span><br><span class="line">      .<span class="title function_">loop</span>(<span class="literal">false</span>)</span><br><span class="line">      .<span class="title function_">duration</span>(<span class="number">100</span>)</span><br><span class="line">      .<span class="title function_">disableSwipe</span>(<span class="variable language_">this</span>.<span class="property">isStopSwiperSlide</span>)</span><br><span class="line">      .<span class="title function_">displayCount</span>(<span class="number">1</span>)</span><br><span class="line">      .<span class="title function_">itemSpace</span>(<span class="number">0</span>)</span><br><span class="line">      .<span class="title function_">curve</span>(<span class="title class_">Curve</span>.<span class="property">Linear</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Red</span>)</span><br><span class="line">      .<span class="title function_">position</span>(&#123; <span class="attr">y</span>: <span class="variable language_">this</span>.<span class="property">positionY</span> &#125;)</span><br><span class="line">      .<span class="title function_">onChange</span>(<span class="function">(<span class="params"><span class="attr">index</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(index.<span class="title function_">toString</span>());</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">curSwiperIndex</span> = index;</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">parallelGesture</span>(</span><br><span class="line">        <span class="title class_">PanGesture</span>()</span><br><span class="line">          .<span class="title function_">onActionStart</span>(<span class="function">(<span class="params"><span class="attr">event</span>: <span class="title class_">GestureEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// Handle start event</span></span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">onActionUpdate</span>(<span class="function">(<span class="params"><span class="attr">event</span>: <span class="title class_">GestureEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (event &amp;&amp; <span class="variable language_">this</span>.<span class="property">curSwiperIndex</span> == <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="keyword">if</span> (event.<span class="property">offsetY</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">positionY</span> = event.<span class="property">offsetY</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isStopSwiperSlide</span> = <span class="literal">true</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isRefresh</span> = <span class="literal">true</span>;</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">positionY</span> = <span class="number">0</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isStopSwiperSlide</span> = <span class="literal">false</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isRefresh</span> = <span class="literal">false</span>;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">          .<span class="title function_">onActionEnd</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isRefresh</span>) &#123;</span><br><span class="line">              <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isStopSwiperSlide</span> = <span class="literal">false</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">positionY</span> = <span class="number">0</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isRefresh</span> = <span class="literal">false</span>;</span><br><span class="line">              &#125;, <span class="number">1000</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Pink</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 5. Why does setting POP color have no effect in HarmonyOS?  </span></span><br><span class="line"><span class="string">**Original code**:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line">.<span class="title function_">bindPopup</span>(<span class="variable language_">this</span>.<span class="property">isShowPopu</span>, &#123;</span><br><span class="line">  <span class="attr">builder</span>: <span class="variable language_">this</span>.<span class="title function_">customPop</span>(),</span><br><span class="line">  <span class="attr">radius</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">placement</span>: <span class="title class_">Placement</span>.<span class="property">Bottom</span>,</span><br><span class="line">  <span class="attr">arrowOffset</span>: <span class="number">60</span>,</span><br><span class="line">  <span class="attr">popupColor</span>: $r(<span class="string">&#x27;app.color.color_232934&#x27;</span>),</span><br><span class="line">  <span class="attr">autoCancel</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">onStateChange</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!e.<span class="property">isVisible</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isShowPopu</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Custom POP for charging orders and help */</span></span><br><span class="line"><span class="meta">@Builder</span> <span class="title function_">customPop</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Column</span>() &#123;</span><br><span class="line">    <span class="title class_">Text</span>(<span class="string">&#x27;Charging Orders&#x27;</span>)</span><br><span class="line">      .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">      .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">padding</span>(<span class="number">16</span>)</span><br><span class="line">      .<span class="title function_">border</span>(&#123; <span class="attr">width</span>: &#123; <span class="attr">bottom</span>: <span class="string">&#x27;1px&#x27;</span> &#125;, <span class="attr">color</span>: <span class="title class_">Color</span>.<span class="property">White</span> &#125;)</span><br><span class="line">      .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">JumpUtil</span>.<span class="title function_">execJump</span>(&#123; <span class="attr">url</span>: <span class="title class_">JumpUtil</span>.<span class="title function_">getH5Url</span>(H5HostType.<span class="property">APPHOST</span>, <span class="title class_">Order</span>.<span class="property">CHARGEORDER_LIST</span>) &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isShowPopu</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="title class_">Text</span>(<span class="string">&#x27;Charging Help&#x27;</span>)</span><br><span class="line">      .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">      .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">      .<span class="title function_">padding</span>(<span class="number">16</span>)</span><br><span class="line">      .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">JumpUtil</span>.<span class="title function_">execJump</span>(&#123; <span class="attr">url</span>: <span class="title class_">VehicleService</span>.<span class="property">CHARGE_HELP</span>.<span class="property">path</span>.<span class="title function_">replace</span>(<span class="string">&#x27;%s&#x27;</span>, <span class="string">&#x27;take&#x27;</span>) &#125;);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isShowPopu</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Transparent</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Solution**: To remove the blurred background effect, set `</span>backgroundBlurStyle<span class="string">` to `</span><span class="title class_">BlurStyle</span>.<span class="property">NONE</span><span class="string">`. Works on both simulators and physical devices.  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line">.<span class="title function_">bindPopup</span>(<span class="variable language_">this</span>.<span class="property">customPopup</span>, &#123;</span><br><span class="line">  <span class="attr">builder</span>: <span class="variable language_">this</span>.<span class="title function_">customPop</span>(), <span class="comment">// POP content</span></span><br><span class="line">  <span class="attr">popupColor</span>: <span class="title class_">Color</span>.<span class="property">Red</span>, <span class="comment">// Background color</span></span><br><span class="line">  <span class="attr">backgroundBlurStyle</span>: <span class="title class_">BlurStyle</span>.<span class="property">NONE</span>,</span><br><span class="line">  <span class="attr">radius</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">placement</span>: <span class="title class_">Placement</span>.<span class="property">Bottom</span>,</span><br><span class="line">  <span class="attr">arrowOffset</span>: <span class="number">60</span>,</span><br><span class="line">  <span class="attr">onStateChange</span>: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!e.<span class="property">isVisible</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isShowPopu</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41212-Daily-HarmonyOS-Next-Knowledge-Column-Containing-List-Actual-Size-After-Scaling-Animation-touchstart-Event-Web-Reload-JSON-Error/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41212-Daily-HarmonyOS-Next-Knowledge-Column-Containing-List-Actual-Size-After-Scaling-Animation-touchstart-Event-Web-Reload-JSON-Error/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Column Containing List, Actual Size After Scaling Animation, touchstart Event, Web Reload, JSON Error</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 08:39:54 / Modified: 08:40:17" itemprop="dateCreated datePublished" datetime="2025-06-29T08:39:54+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Column-Containing-List-Actual-Size-After-Scaling-Animation-touchstart-Event-Web-Reload-JSON-Error"><a href="#Daily-HarmonyOS-Next-Knowledge-Column-Containing-List-Actual-Size-After-Scaling-Animation-touchstart-Event-Web-Reload-JSON-Error" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Column Containing List, Actual Size After Scaling Animation, touchstart Event, Web Reload, JSON Error"></a>[Daily HarmonyOS Next Knowledge] Column Containing List, Actual Size After Scaling Animation, touchstart Event, Web Reload, JSON Error</h1><h4 id="1-HarmonyOS-Column-layout-containing-a-List"><a href="#1-HarmonyOS-Column-layout-containing-a-List" class="headerlink" title="1. HarmonyOS: Column layout containing a List?"></a>1. HarmonyOS: Column layout containing a List?</h4><p>When a Column layout includes both normal components and a List, the last item of the List cannot be fully displayed. How to solve this?  </p>
<p>The most likely cause is that in a non-Flex linear layout container, the layout constraints of child components are affected by properties like <code>layoutWeight</code>, <code>flexShrink</code>, or <code>flexGrow</code>. If other components and the List have the same layout constraints, the List uses <code>maxHeight</code> to obtain its real height (equal to the Column’s height). Combined with the height occupation of other components, the last part of the List items cannot be fully displayed on the screen. Setting <code>layoutWeight</code> on the List allows the Column to allocate the remaining space to the List, ensuring complete display.  </p>
<p><strong>Example code</strong>: If the List does not set <code>.layoutWeight(100)</code>, the last item of the List cannot be fully displayed.  </p>
<pre><code class="language-typescript">@Entry
@Component
struct Index &#123;
  @State strList: Array&lt;String&gt; = [&#39;Hello World&#39;, &#39;init&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;, &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;]
  build() &#123;
    Column() &#123;
      Text(&quot;111111&quot;)
        .fontSize(100)
      List() &#123;
        ForEach(this.strList, (item: string, index: number) =&gt; &#123;
          ListItem() &#123;
            Text(item)
              .fontSize(100)
          &#125;
        &#125;)
      &#125;
      .layoutWeight(300)
    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h4 id="2-HarmonyOS-After-scaling-and-translating-a-component-the-values-returned-by-ComponentInfo-do-not-match-the-inspector-Is-there-an-interface-to-get-the-actual-scaled-size-of-the-component"><a href="#2-HarmonyOS-After-scaling-and-translating-a-component-the-values-returned-by-ComponentInfo-do-not-match-the-inspector-Is-there-an-interface-to-get-the-actual-scaled-size-of-the-component" class="headerlink" title="2. HarmonyOS: After scaling and translating a component, the values returned by ComponentInfo do not match the inspector. Is there an interface to get the actual scaled size of the component?"></a>2. HarmonyOS: After scaling and translating a component, the values returned by ComponentInfo do not match the inspector. Is there an interface to get the actual scaled size of the component?</h4><p>Call the area change callback <code>onAreaChange</code> function for the component and read the <code>Area</code> type data. Example: (First define component width and height variables <code>cw, ch</code>)  </p>
<pre><code class="language-typescript">.onAreaChange((oldValue: Area, newValue: Area) =&gt; &#123;
  this.cw = new Number(newValue.width).valueOf()
  this.ch = new Number(newValue.height).valueOf()
&#125;)
</code></pre>
<h4 id="3-HarmonyOS-The-touchstart-event-does-not-respond-after-opening-a-page-in-WebView"><a href="#3-HarmonyOS-The-touchstart-event-does-not-respond-after-opening-a-page-in-WebView" class="headerlink" title="3. HarmonyOS: The touchstart event does not respond after opening a page in WebView."></a>3. HarmonyOS: The touchstart event does not respond after opening a page in WebView.</h4><p>The <code>touchstart</code> event conflicts with the <code>click</code> event. When adapting a completed PC site for mobile devices, using mobile-specific event systems (e.g., <code>touchstart</code> instead of <code>click</code>) can improve response speed. Mobile browsers delay the <code>click</code> event by 300ms to distinguish between single and double clicks, while <code>touchstart</code> triggers instantly when the user touches the screen.  </p>
<p>However, when adapting a PC site for mobile devices, simply replacing <code>click</code> with <code>touchstart</code> is insufficient because PCs cannot recognize <code>touchstart</code>. Binding both events to an element causes conflicts on mobile devices, as both events trigger sequentially (with <code>click</code> delayed by ~300ms), executing callbacks twice.  </p>
<p><strong>Solutions</strong>:  </p>
<ol>
<li><p>Use <code>preventDefault</code>:  </p>
<pre><code class="language-javascript">const Button = document.getElementById(&quot;targetButton&quot;)

Button.addEventListener(&quot;touchstart&quot;, e =&gt; &#123;
    e.preventDefault()
    console.log(&quot;touchstart event!&quot;)
&#125;)

Button.addEventListener(&quot;click&quot;, e =&gt; &#123;
    e.preventDefault()
    console.log(&quot;click event!&quot;)
&#125;)
</code></pre>
<p>Simulating a mobile device in the browser will only log <code>touchstart event!</code>, blocking the <code>click</code> event.  </p>
</li>
<li><p>Bind events based on feature detection:  </p>
<pre><code class="language-javascript">const Button = document.getElementById(&quot;targetButton&quot;)

const clickEvent = (function() &#123;
  if (&#39;ontouchstart&#39; in document.documentElement === true)
    return &#39;touchstart&#39;;
  else
    return &#39;click&#39;;
&#125;)();

Button.addEventListener(clickEvent, e =&gt; &#123;
  console.log(&quot;things happened!&quot;)
&#125;)
</code></pre>
</li>
</ol>
<h4 id="4-HarmonyOS-If-the-page-stack-contains-a-WebView-page-how-to-get-the-WebView-instance-to-perform-a-reload-operation-for-a-specific-WebView-in-the-stack"><a href="#4-HarmonyOS-If-the-page-stack-contains-a-WebView-page-how-to-get-the-WebView-instance-to-perform-a-reload-operation-for-a-specific-WebView-in-the-stack" class="headerlink" title="4. HarmonyOS: If the page stack contains a WebView page, how to get the WebView instance to perform a reload operation for a specific WebView in the stack?"></a>4. HarmonyOS: If the page stack contains a WebView page, how to get the WebView instance to perform a reload operation for a specific WebView in the stack?</h4><p>Refer to <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/web-page-loading-with-web-components-V5">Dynamically Creating Web Components</a>.  </p>
<h4 id="5-When-converting-a-JSON-array-to-a-string-and-saving-it-to-Preferences-an-error-occurs-“Parameter-error-The-type-of-‘value’-must-be-ValueType-”"><a href="#5-When-converting-a-JSON-array-to-a-string-and-saving-it-to-Preferences-an-error-occurs-“Parameter-error-The-type-of-‘value’-must-be-ValueType-”" class="headerlink" title="5. When converting a JSON array to a string and saving it to Preferences, an error occurs: “Parameter error. The type of ‘value’ must be ValueType.”"></a>5. When converting a JSON array to a string and saving it to Preferences, an error occurs: “Parameter error. The type of ‘value’ must be ValueType.”</h4><p>This issue may be caused by an excessively long string. The maximum length limit for <code>Value</code> is 8192 bytes. Preferences are recommended for storing small amounts of persistent data; consider using a relational database for large data: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-data-preferences-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-data-preferences-V5</a>.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41211-Daily-HarmonyOS-Next-Knowledge-Popup-Encapsulation-as-a-Method-Setting-Default-Tabcontent-in-Tabs-rawfile-Path-Default-Component-Width-Height-and-Color-for-Different-States/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41211-Daily-HarmonyOS-Next-Knowledge-Popup-Encapsulation-as-a-Method-Setting-Default-Tabcontent-in-Tabs-rawfile-Path-Default-Component-Width-Height-and-Color-for-Different-States/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Popup Encapsulation as a Method, Setting Default Tabcontent in Tabs, rawfile Path, Default Component Width/Height, and Color for Different States</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 00:12:57 / Modified: 00:14:01" itemprop="dateCreated datePublished" datetime="2025-06-29T00:12:57+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Knowledge-Popup-Encapsulation-as-a-Method-Setting-Default-Tabcontent-in-Tabs-rawfile-Path-Default-Component-Width-Height-and-Color-for-Different-States"><a href="#Daily-HarmonyOS-Knowledge-Popup-Encapsulation-as-a-Method-Setting-Default-Tabcontent-in-Tabs-rawfile-Path-Default-Component-Width-Height-and-Color-for-Different-States" class="headerlink" title="[Daily HarmonyOS Knowledge] Popup Encapsulation as a Method, Setting Default Tabcontent in Tabs, rawfile Path, Default Component Width&#x2F;Height, and Color for Different States"></a>[Daily HarmonyOS Knowledge] Popup Encapsulation as a Method, Setting Default Tabcontent in Tabs, rawfile Path, Default Component Width&#x2F;Height, and Color for Different States</h1><h4 id="1-How-to-encapsulate-a-HarmonyOS-popup-as-a-method-for-direct-invocation-elsewhere"><a href="#1-How-to-encapsulate-a-HarmonyOS-popup-as-a-method-for-direct-invocation-elsewhere" class="headerlink" title="1. How to encapsulate a HarmonyOS popup as a method for direct invocation elsewhere?"></a>1. How to encapsulate a HarmonyOS popup as a method for direct invocation elsewhere?</h4><p>For popup scenarios, it is recommended to use <code>promptAction.openCustomDialog</code>, which will be the primary evolution direction for popups. Developers mainly need to customize the popup content via a builder. For usage, refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-promptaction-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-promptaction-V5</a>  </p>
<p>Using <code>promptAction.openCustomDialog</code>, you can set the popup as non-modal (<code>isModal: false</code>) to prevent it from closing automatically when clicking outside the popup.  </p>
<h4 id="2-How-to-set-the-default-tabcontent-of-a-HarmonyOS-Tabs-component-to-a-position-other-than-index-0"><a href="#2-How-to-set-the-default-tabcontent-of-a-HarmonyOS-Tabs-component-to-a-position-other-than-index-0" class="headerlink" title="2. How to set the default tabcontent of a HarmonyOS Tabs component to a position other than index 0?"></a>2. How to set the default tabcontent of a HarmonyOS Tabs component to a position other than index 0?</h4><p>When using the Tabs component, the business scenario may require displaying a tabcontent that is not the first one (e.g., the third tabcontent by default).  </p>
<p><strong>Solution</strong>: Use the <code>index</code> parameter of the Tabs component.<br>Reference: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-components-container-tabs-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-components-container-tabs-V5</a>  </p>
<pre><code class="language-typescript">Tabs(&#123; barPosition?: BarPosition, index?: number, controller?: TabsController &#125;)
</code></pre>
<h4 id="3-In-which-directory-of-the-project-should-the-index-html-file-be-placed-for-rawfile-“index-html”-in-HarmonyOS"><a href="#3-In-which-directory-of-the-project-should-the-index-html-file-be-placed-for-rawfile-“index-html”-in-HarmonyOS" class="headerlink" title="3. In which directory of the project should the index.html file be placed for $rawfile(“index.html”) in HarmonyOS?"></a>3. In which directory of the project should the index.html file be placed for $rawfile(“index.html”) in HarmonyOS?</h4><p>As shown in the figure:<br><img src="/../images/%E3%80%90%E6%AF%8F%E6%97%A5%E5%AD%A6%E7%82%B9%E9%B8%BF%E8%92%99%E7%9F%A5%E8%AF%86%E3%80%9124.12.11.png"></p>
<h4 id="4-Why-does-setting-width-height-to-“auto”-for-a-HarmonyOS-component-not-take-effect-and-the-component-uses-the-full-width-height-of-the-parent-container"><a href="#4-Why-does-setting-width-height-to-“auto”-for-a-HarmonyOS-component-not-take-effect-and-the-component-uses-the-full-width-height-of-the-parent-container" class="headerlink" title="4. Why does setting width&#x2F;height to “auto” for a HarmonyOS component not take effect, and the component uses the full width&#x2F;height of the parent container?"></a>4. Why does setting width&#x2F;height to “auto” for a HarmonyOS component not take effect, and the component uses the full width&#x2F;height of the parent container?</h4><p>When <code>width</code> is set to <code>auto</code>, if the child component anchors to the container in the horizontal direction, <code>auto</code> will not take effect (the same applies vertically).<br>Reference document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-relativecontainer-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-relativecontainer-V5</a>  </p>
<pre><code class="language-typescript">@Builder
heatmapExampleLayout() &#123;
  RelativeContainer() &#123;
    Image($r(&#39;app.media.startIcon&#39;))
      .fitOriginalSize(true)
      .margin(&#123; bottom: 10 &#125;)
      .id(&#39;example_img&#39;)
    
    Text(`事实上`)
      .fontColor(Color.Red)
      .fontSize(12)
      .id(&#39;example_less&#39;)
    
    Text(`测试`)
      .fontColor(Color.Blue)
      .fontSize(12)
      .id(&#39;example_more&#39;)
  &#125;
  .padding(&#123; left: 8, right: 8, top: 5, bottom: 5 &#125;)
  .margin(&#123; left: 8, bottom: 12 &#125;)
  .border(&#123; width: 2, color: Color.White, radius: 8 &#125;)
  .backgroundColor(Color.Gray)
  .width(`auto`)
  .height(`auto`)
&#125;
</code></pre>
<h4 id="5-Why-does-a-HarmonyOS-button-only-display-the-font-color-for-the-Normal-state-even-when-different-states-are-set"><a href="#5-Why-does-a-HarmonyOS-button-only-display-the-font-color-for-the-Normal-state-even-when-different-states-are-set" class="headerlink" title="5. Why does a HarmonyOS button only display the font color for the Normal state, even when different states are set?"></a>5. Why does a HarmonyOS button only display the font color for the Normal state, even when different states are set?</h4><p>The <code>stateStyles</code> interface only supports universal attributes, and <code>fontColor</code> is not a universal attribute, so it does not take effect when set. For non-universal attributes, use <code>attributeModifier</code>.<br>Reference document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-attributes-attribute-modifier-V5#attributemodifier">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-attributes-attribute-modifier-V5#attributemodifier</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41210-Daily-HarmonyOS-Next-Knowledge-Stopping-Animations-Controlling-Swipe-Gestures-Login-Page-Navigation-Web-Component-Album-Access-and-Disabling-Edge-Swipes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41210-Daily-HarmonyOS-Next-Knowledge-Stopping-Animations-Controlling-Swipe-Gestures-Login-Page-Navigation-Web-Component-Album-Access-and-Disabling-Edge-Swipes/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Stopping Animations, Controlling Swipe Gestures, Login Page Navigation, Web Component Album Access, and Disabling Edge Swipes</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 00:12:04 / Modified: 00:12:17" itemprop="dateCreated datePublished" datetime="2025-06-29T00:12:04+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Knowledge-Stopping-Animations-Controlling-Swipe-Gestures-Login-Page-Navigation-Web-Component-Album-Access-and-Disabling-Edge-Swipes"><a href="#Daily-HarmonyOS-Knowledge-Stopping-Animations-Controlling-Swipe-Gestures-Login-Page-Navigation-Web-Component-Album-Access-and-Disabling-Edge-Swipes" class="headerlink" title="[Daily HarmonyOS Knowledge] Stopping Animations, Controlling Swipe Gestures, Login Page Navigation, Web Component Album Access, and Disabling Edge Swipes"></a>[Daily HarmonyOS Knowledge] Stopping Animations, Controlling Swipe Gestures, Login Page Navigation, Web Component Album Access, and Disabling Edge Swipes</h1><h4 id="1-Is-there-a-way-to-actively-stop-an-infinitely-looping-animateTo-animation-in-HarmonyOS"><a href="#1-Is-there-a-way-to-actively-stop-an-infinitely-looping-animateTo-animation-in-HarmonyOS" class="headerlink" title="1. Is there a way to actively stop an infinitely looping animateTo animation in HarmonyOS?"></a>1. Is there a way to actively stop an infinitely looping <code>animateTo</code> animation in HarmonyOS?</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">export</span> struct <span class="title class_">Test</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">message</span>: <span class="built_in">string</span> = <span class="string">&#x27;Hello World&#x27;</span>;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">opacityValue</span>: <span class="built_in">number</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Row</span>() &#123;</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">message</span>)</span><br><span class="line">          .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">          .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">          .<span class="title function_">opacity</span>(<span class="variable language_">this</span>.<span class="property">opacityValue</span>)</span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&quot;Start Animation&quot;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">animateTo</span>(&#123; <span class="attr">duration</span>: <span class="number">1000</span>, <span class="attr">iterations</span>: -<span class="number">1</span>, <span class="attr">playMode</span>: <span class="title class_">PlayMode</span>.<span class="property">AlternateReverse</span> &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">opacityValue</span> = <span class="number">0</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title class_">Button</span>(<span class="string">&quot;Stop Animation&quot;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">animateTo</span>(&#123;</span><br><span class="line">            <span class="attr">duration</span>: <span class="number">0</span>, <span class="attr">iterations</span>: <span class="number">1</span>, <span class="attr">onFinish</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">opacityValue</span> = <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">opacityValue</span> = <span class="number">0.9</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 2. How to disable or modify the system&#x27;s right/left swipe gestures in HarmonyOS?  </span></span><br><span class="line"><span class="string">On certain pages, you may need to disable or modify the system&#x27;s edge swipe gestures.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Solution**: Intercept the `</span>onBackPress<span class="string">` event. Return `</span><span class="literal">true</span><span class="string">` to handle navigation logic within the page.  </span></span><br><span class="line"><span class="string">Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-faqs-V5/faqs-arkui-29-V5  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 3. How to manage page navigation after logging in on a HarmonyOS login page?  </span></span><br><span class="line"><span class="string">**Scenario**: After logging in, the app enters the home page, then navigates to a subpage. If the user needs to log in again from a subpage, the app should return to the home page after successful login.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**Solution**: Clear the navigation stack and push the home page:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="title class_">Button</span>(<span class="string">&quot;Login&quot;</span>)</span><br><span class="line">  .<span class="title function_">onClick</span>(<span class="function">(<span class="params"><span class="attr">event</span>: <span class="title class_">ClickEvent</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Business logic: Login verification</span></span><br><span class="line">    <span class="comment">// Clear the navigation stack and navigate to the home page</span></span><br><span class="line">    router.<span class="title function_">clear</span>()</span><br><span class="line">    router.<span class="title function_">pushUrl</span>(&#123;</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&#x27;pages/Index&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 4. How to launch the album, camera, or file manager from a HarmonyOS Web component?  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">import</span> web_webview <span class="keyword">from</span> <span class="string">&#x27;@ohos.web.webview&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; common &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.AbilityKit&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; uri, util &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkTS&#x27;</span></span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;@ohos.file.fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> picker <span class="keyword">from</span> <span class="string">&#x27;@ohos.file.picker&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BusinessError</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.BasicServicesKit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">testClass</span> &#123;</span><br><span class="line">  <span class="attr">base64Str</span>: <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">base64Str</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">base64Str</span> = base64Str;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">test</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;2123&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toString</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Web Component toString&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">  <span class="attr">controller</span>: web_webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> web_webview.<span class="title class_">WebviewController</span>()</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">uris</span>: <span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt; = []</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">base64Str</span>: <span class="built_in">string</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="meta">@State</span> <span class="attr">testObj</span>: testClass = <span class="keyword">new</span> <span class="title function_">testClass</span>(<span class="variable language_">this</span>.<span class="property">base64Str</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    web_webview.<span class="property">WebviewController</span>.<span class="title function_">setWebDebuggingAccess</span>(<span class="literal">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: $rawfile(<span class="string">&#x27;TestonShowFileSelector.html&#x27;</span>), <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">controller</span> &#125;)</span><br><span class="line">        .<span class="title function_">javaScriptAccess</span>(<span class="literal">true</span>)</span><br><span class="line">        .<span class="title function_">domStorageAccess</span>(<span class="literal">true</span>)</span><br><span class="line">        .<span class="title function_">onShowFileSelector</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// //-------Invoke album-------------------------</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;MyFileUploader onShowFileSelector invoked&#x27;</span>)</span><br><span class="line">          <span class="keyword">const</span> photoSelectOptions = <span class="keyword">new</span> picker.<span class="title class_">PhotoSelectOptions</span>();</span><br><span class="line">          photoSelectOptions.<span class="property">MIMEType</span> = picker.<span class="property">PhotoViewMIMETypes</span>.<span class="property">IMAGE_VIDEO_TYPE</span>;</span><br><span class="line">          photoSelectOptions.<span class="property">maxSelectNumber</span> = <span class="number">8</span>;</span><br><span class="line">          <span class="keyword">const</span> photoViewPicker = <span class="keyword">new</span> picker.<span class="title class_">PhotoViewPicker</span>();</span><br><span class="line">          photoViewPicker.<span class="title function_">select</span>(photoSelectOptions).<span class="title function_">then</span>(<span class="function">(<span class="params"><span class="attr">photoSelectResult</span>: picker.<span class="title class_">PhotoSelectResult</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">uris</span> = photoSelectResult.<span class="property">photoUris</span>;</span><br><span class="line">            <span class="keyword">let</span> file1 = fs.<span class="title function_">openSync</span>(<span class="variable language_">this</span>.<span class="property">uris</span>[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">let</span> <span class="attr">array</span>: <span class="title class_">ArrayBuffer</span> = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(fs.<span class="title function_">statSync</span>(file1.<span class="property">fd</span>).<span class="property">size</span>)</span><br><span class="line">            fs.<span class="title function_">readSync</span>(file1.<span class="property">fd</span>, array)</span><br><span class="line">            <span class="keyword">let</span> unit = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(array)</span><br><span class="line">            <span class="keyword">let</span> base64 = <span class="keyword">new</span> util.<span class="title class_">Base64Helper</span>();</span><br><span class="line">            <span class="keyword">let</span> mystr = base64.<span class="title function_">encodeToStringSync</span>(unit);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">base64Str</span> = <span class="string">&quot;myFunction(\&quot;&quot;</span> + mystr + <span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">controller</span>.<span class="title function_">runJavaScript</span>(<span class="variable language_">this</span>.<span class="property">base64Str</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;photoViewPicker.select to file succeed and uris are:&#x27;</span> + <span class="variable language_">this</span>.<span class="property">uris</span>);</span><br><span class="line">          &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params"><span class="attr">err</span>: <span class="title class_">BusinessError</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`Invoke photoViewPicker.select failed, code is <span class="subst">$&#123;err.code&#125;</span>, message is <span class="subst">$&#123;err.message&#125;</span>`</span>);</span><br><span class="line">          &#125;)</span><br><span class="line"></span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">          </span><br><span class="line">          <span class="comment">//----Invoke file manager-----------------</span></span><br><span class="line">          <span class="comment">// ... [Code omitted for brevity]</span></span><br><span class="line">          </span><br><span class="line">          <span class="comment">////-----Camera--------------------------------</span></span><br><span class="line">          <span class="comment">// ... [Code omitted for brevity]</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string">**HTML part**:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>html</span><br><span class="line">&lt;form id=<span class="string">&quot;upload-form&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &lt;!-- <span class="title class_">Change</span> <span class="keyword">type</span> to <span class="string">&quot;camera&quot;</span> --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;upload&quot;</span> <span class="attr">name</span>=<span class="string">&quot;upload&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;image/*&quot;</span> <span class="attr">capture</span>=<span class="string">&quot;camera&quot;</span> /&gt;</span></span></span><br><span class="line">    &lt;!-- <span class="title class_">Add</span> an image element to preview selected images --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;preview&quot;</span>/&gt;</span></span></span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;155134&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 5. How to disable edge swipes in HarmonyOS?  </span></span><br><span class="line"><span class="string">Override the `</span><span class="title function_">onBackPress</span>()<span class="string">` method in the page lifecycle and return `</span><span class="literal">true</span><span class="string">`:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="title function_">onBackPress</span>(<span class="params"></span>) &#123; </span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/4129-Daily-HarmonyOS-Next-Knowledge-Web-Jumps-to-System-Apps-Dynamic-Page-Navigation-Observation-in-Non-UI-Contexts-MVVM-Pattern-Timing-Issues-in-Loops/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/4129-Daily-HarmonyOS-Next-Knowledge-Web-Jumps-to-System-Apps-Dynamic-Page-Navigation-Observation-in-Non-UI-Contexts-MVVM-Pattern-Timing-Issues-in-Loops/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Web Jumps to System Apps, Dynamic Page Navigation, Observation in Non-UI Contexts, MVVM Pattern, Timing Issues in Loops</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 00:10:55 / Modified: 08:38:02" itemprop="dateCreated datePublished" datetime="2025-06-29T00:10:55+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Knowledge-Web-Jumps-to-System-Apps-Dynamic-Page-Navigation-Observation-in-Non-UI-Contexts-MVVM-Pattern-Timing-Issues-in-Loops"><a href="#Daily-HarmonyOS-Knowledge-Web-Jumps-to-System-Apps-Dynamic-Page-Navigation-Observation-in-Non-UI-Contexts-MVVM-Pattern-Timing-Issues-in-Loops" class="headerlink" title="[Daily HarmonyOS Knowledge] Web Jumps to System Apps, Dynamic Page Navigation, Observation in Non-UI Contexts, MVVM Pattern, Timing Issues in Loops"></a>[Daily HarmonyOS Knowledge] Web Jumps to System Apps, Dynamic Page Navigation, Observation in Non-UI Contexts, MVVM Pattern, Timing Issues in Loops</h1><h4 id="1-How-to-make-phone-calls-and-jump-to-the-app-store-in-HarmonyOS-Web-components"><a href="#1-How-to-make-phone-calls-and-jump-to-the-app-store-in-HarmonyOS-Web-components" class="headerlink" title="1. How to make phone calls and jump to the app store in HarmonyOS Web components?"></a>1. How to make phone calls and jump to the app store in HarmonyOS Web components?</h4><p><strong>Phone call demo</strong>:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import web_webview from &#x27;@ohos.web.webview&#x27;;</span><br><span class="line">import call from &#x27;@ohos.telephony.call&#x27;;</span><br><span class="line">import &#123; BusinessError &#125; from &#x27;@ohos.base&#x27;;</span><br><span class="line"></span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line">struct WebComponent &#123;</span><br><span class="line">  webviewController: web_webview.WebviewController = new web_webview.WebviewController();</span><br><span class="line"></span><br><span class="line">  build() &#123;</span><br><span class="line">    Column() &#123;</span><br><span class="line">      Web(&#123; src: $rawfile(&#x27;call.html&#x27;), controller: this.webviewController &#125;)</span><br><span class="line">        .onLoadIntercept((event) =&gt; &#123;</span><br><span class="line">          if (event) &#123;</span><br><span class="line">            let url: string = event.data.getRequestUrl();</span><br><span class="line">            // Determine if the link is a dialing link</span><br><span class="line">            if (url.indexOf(&#x27;tel://&#x27;) === 0) &#123;</span><br><span class="line">              call.makeCall(url.substring(6), (err: BusinessError) =&gt; &#123;</span><br><span class="line">                if (!err) &#123;</span><br><span class="line">                  console.log(&quot;make call success.&quot;);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                  console.log(&quot;make call fail, err is:&quot; + JSON.stringify(err));</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">              return true;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          return false;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line">**call.html**:  </span><br></pre></td></tr></table></figure>
<!DOCTYPE html>
<html>
<body>
<div>
  <a href="tel://10086">拨打电话</a>
</div>
</body>
</html>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**App store jump demo**:  </span><br></pre></td></tr></table></figure>
import Want from '@ohos.app.ability.Want';
import common from '@ohos.app.ability.common';

<p>@Entry<br>@Component<br>struct Index {<br>  @State appId: string &#x3D; “要跳转的AppID”;<br>  controller: TextInputController &#x3D; new TextInputController();</p>
<p>  build() {<br>    Row() {<br>      Column() {<br>        TextInput({ text: this.appId, placeholder: ‘请输入应用的appId’, controller: this.controller })<br>          .width(‘90%’)<br>          .onChange((value: string) &#x3D;&gt; {<br>            this.appId &#x3D; value<br>          })<br>        Button(‘点击跳转到HarmonyOS版应用市场详情页面’)<br>          .margin({ top: 50 })<br>          .onClick(() &#x3D;&gt; {<br>            const want: Want &#x3D; {<br>              uri: <code>store://appgallery.huawei.com/app/id=$&#123;this.appId&#125;</code><br>            };<br>            const context &#x3D; getContext(this) as common.UIAbilityContext;<br>            context.startAbility(want).then(() &#x3D;&gt; {<br>              &#x2F;&#x2F; Successful launch<br>            }).catch(() &#x3D;&gt; {<br>              &#x2F;&#x2F; Failed to launch<br>            });<br>          })<br>      }<br>      .width(‘100%’)<br>    }<br>    .height(‘100%’)<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### 2. In HarmonyOS, how to dynamically display different page components based on logic for part of a page?  </span><br></pre></td></tr></table></figure>
<p>class Tmp {<br>  paramA1: string &#x3D; ‘’<br>}</p>
<p>@Builder function overBuilder(params: Tmp) {<br>  Row() {<br>    Text(<code>overBuilder: $&#123;params.paramA1&#125; </code>)<br>  }<br>}</p>
<p>@Builder function overBuilder2(params: Tmp) {<br>  Row() {<br>    Text(<code>overBuilder2: $&#123;params.paramA1&#125; </code>)<br>  }<br>}</p>
<p>@Entry<br>@Component<br>struct Index123 {<br>  @State label: string &#x3D; ‘Hello’;<br>  @State buildSet: boolean &#x3D; false;</p>
<p>  build() {<br>    Row() {<br>      Column() {<br>        if (this.buildSet) {<br>          overBuilder({ paramA1: this.label })<br>        } else {<br>          overBuilder2({ paramA1: this.label })<br>        }<br>      }<br>      .width(‘100%’)<br>    }<br>    .height(‘100%’)<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">#### 3. How to observe changes in non-UI contexts (e.g., aboutToAppear) for variables decorated with @ObservedV2 in HarmonyOS?  </span><br><span class="line">The `aboutToAppear` lifecycle is triggered only when a page is created. It executes after a custom component&#x27;s new instance is created and before its `build()` function. You can change state variables in `aboutToAppear`, and the changes will take effect when `build()` is executed subsequently.  </span><br><span class="line">Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-custom-component-lifecycle-V5#abouttoappear  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 4. What is the MVVM pattern in HarmonyOS, and how does ViewModel relate to View? How does ViewModel notify View decorators of data changes?  </span><br><span class="line">**Application example: Address book demo**  </span><br><span class="line">Variables decorated with `@State` trigger UI re-rendering when updated, re-executing the `build` method to display real-time data. `@Provide` shares `@State` characteristics and works with `@Consume` to synchronize data across parent, child, and descendant components.  </span><br><span class="line">For details on these decorators, refer to: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-component-state-management-V5  </span><br><span class="line"></span><br><span class="line">**Address book demo code (Index.ets)**:  </span><br></pre></td></tr></table></figure>
<p>import { Person, Address, AddressBook, ObservedArray } from ‘..&#x2F;viewmodel&#x2F;ListViewModel’<br>import emitter from ‘@ohos.events.emitter’;</p>
<p>&#x2F;&#x2F; Renders the name of a Person object and the first number in an ObservedArray<string><br>&#x2F;&#x2F; To update phone numbers, use @ObjectLink for person and phones;<br>&#x2F;&#x2F; Using this.person.phones directly won’t observe internal array changes.<br>&#x2F;&#x2F; The onClick in AddressBookView and PersonEditView updates selectedPerson<br>@Component<br>struct PersonView {<br>  @ObjectLink person: Person;<br>  @ObjectLink phones: ObservedArray<string>;<br>  @Link selectedPerson: Person;</p>
<p>  build() {<br>    Flex({ direction: FlexDirection.Row, justifyContent: FlexAlign.SpaceBetween }) {<br>      Text(this.person.name)<br>      if (this.phones.length) {<br>        Text(this.phones[0])<br>      }<br>    }<br>    .height(55)<br>    .backgroundColor(this.selectedPerson.name &#x3D;&#x3D; this.person.name ? “#ffa0a0” : “#ffffff”)<br>    .onClick(() &#x3D;&gt; {<br>      this.selectedPerson &#x3D; this.person;<br>    })<br>  }<br>}</p>
<p>@Component<br>struct phonesNumber {<br>  @ObjectLink phoneNumber: ObservedArray<string></p>
<p>  build() {<br>    Column() {<br>      ForEach(this.phoneNumber,<br>        (phone: ResourceStr, index?: number) &#x3D;&gt; {<br>          TextInput({ text: phone })<br>            .width(150)<br>            .onChange((value) &#x3D;&gt; {<br>              console.log(<code>$&#123;index&#125;. $&#123;value&#125; value has changed</code>)<br>              this.phoneNumber[index!] &#x3D; value;<br>            })<br>        },<br>        (phone: ResourceStr, index: number) &#x3D;&gt; <code>$&#123;this.phoneNumber[index] + index&#125;</code><br>      )<br>    }<br>  }<br>}</p>
<p>&#x2F;&#x2F; Renders detailed Person information<br>&#x2F;&#x2F; The @Prop-decorated variable DeepCopy data from the parent component AddressBookView, retaining changes locally;<br>&#x2F;&#x2F; TextInput changes only modify the local copy.<br>&#x2F;&#x2F; Clicking “Save Changes” syncs all copied data from @Prop to @Link for synchronization with other components<br>@Component<br>struct PersonEditView {<br>  @Consume addrBook: AddressBook;<br>  &#x2F;* Reference to the parent component’s selectedPerson <em>&#x2F;<br>  @Link selectedPerson: Person;<br>  &#x2F;</em> Edit on the local copy until saving *&#x2F;<br>  @Prop name: string &#x3D; “”;<br>  @Prop address: Address &#x3D; new Address(“”, 0, “”);<br>  @Prop phones: ObservedArray<string> &#x3D; [];</p>
<p>  selectedPersonIndex(): number {<br>    return this.addrBook.contacts.findIndex((person: Person) &#x3D;&gt; person.id_ &#x3D;&#x3D; this.selectedPerson.id_);<br>  }</p>
<p>  build() {<br>    Column() {<br>      TextInput({ text: this.name })<br>        .onChange((value) &#x3D;&gt; {<br>          this.name &#x3D; value;<br>        })<br>      TextInput({ text: this.address.street })<br>        .onChange((value) &#x3D;&gt; {<br>          this.address.street &#x3D; value;<br>        })<br>      TextInput({ text: this.address.city })<br>        .onChange((value) &#x3D;&gt; {<br>          this.address.city &#x3D; value;<br>        })<br>      TextInput({ text: this.address.zip.toString() })<br>        .onChange((value) &#x3D;&gt; {<br>          const result &#x3D; Number.parseInt(value);<br>          this.address.zip &#x3D; Number.isNaN(result) ? 0 : result;<br>        })<br>      if (this.phones.length &gt; 0) {<br>        phonesNumber({ phoneNumber: this.phones })<br>      }<br>      Flex({ direction: FlexDirection.Row, justifyContent: FlexAlign.SpaceBetween }) {<br>        Text(“Save Changes”)<br>          .onClick(() &#x3D;&gt; {<br>            &#x2F;&#x2F; Assign updated local copy values to the reference pointing to the parent component’s selectedPerson<br>            &#x2F;&#x2F; Avoid creating new objects; modify existing properties<br>            this.selectedPerson.name &#x3D; this.name;<br>            this.selectedPerson.address &#x3D; new Address(this.address.street, this.address.zip, this.address.city)<br>            this.phones.forEach((phone: string, index: number) &#x3D;&gt; {<br>              this.selectedPerson.phones[index] &#x3D; phone<br>            });<br>            emitter.emit(‘setModelData’, {<br>              data: {<br>                id: this.selectedPerson.id_,<br>                name: this.name<br>              }<br>            })<br>          })<br>        Button(‘getData’)<br>          .onClick(() &#x3D;&gt; {<br>            emitter.emit(‘getModelData’);<br>            this.selectedPerson &#x3D; this.addrBook.me;<br>          })<br>        if (this.selectedPersonIndex() !&#x3D; -1) {<br>          Text(“Delete Contact”)<br>            .onClick(() &#x3D;&gt; {<br>              let index &#x3D; this.selectedPersonIndex();<br>              console.log(<code>delete contact at index $&#123;index&#125;</code>);<br>              &#x2F;&#x2F; Delete the current contact<br>              this.addrBook.contacts.splice(index, 1);<br>              &#x2F;&#x2F; Delete the current selectedPerson and shift the selection forward by one<br>              index &#x3D; (index &lt; this.addrBook.contacts.length) ? index : index - 1;<br>              &#x2F;&#x2F; If no contacts remain, set me as the selected state<br>              this.selectedPerson &#x3D; (index &gt;&#x3D; 0) ? this.addrBook.contacts[index] : this.addrBook.me;<br>            })<br>        }<br>      }<br>    }<br>  }<br>}</p>
<p>@Component<br>struct AddressBookView {<br>  @ObjectLink me: Person;<br>  @ObjectLink contacts: ObservedArray<Person>;<br>  @State selectedPerson: Person &#x3D; new Person(“”, “”, 0, “”, []);</p>
<p>  aboutToAppear() {<br>    this.selectedPerson &#x3D; this.me;<br>  }</p>
<p>  build() {<br>    Flex({ direction: FlexDirection.Column, justifyContent: FlexAlign.Start }) {<br>      Text(“Me:”)<br>      PersonView({<br>        person: this.me,<br>        phones: this.me.phones,<br>        selectedPerson: this.selectedPerson<br>      })<br>      Divider().height(8)<br>      ForEach(this.contacts, (contact: Person) &#x3D;&gt; {<br>        PersonView({<br>          person: contact,<br>          phones: contact.phones as ObservedArray<string>,<br>          selectedPerson: this.selectedPerson<br>        })<br>      },<br>        (contact: Person): string &#x3D;&gt; {<br>          return contact.id_;<br>        }<br>      )<br>      Divider().height(8)<br>      Text(“Edit:”)<br>      PersonEditView({<br>        selectedPerson: this.selectedPerson,<br>        name: this.selectedPerson.name,<br>        address: this.selectedPerson.address,<br>        phones: this.selectedPerson.phones<br>      })<br>    }<br>    .borderStyle(BorderStyle.Solid).borderWidth(5).borderColor(0xAFEEEE).borderRadius(5)<br>  }<br>}</p>
<p>@Entry<br>@Component<br>struct Index {<br>  @StorageLink(“contacts”) @Watch(“contactsChange”) contacts: Array<Person> &#x3D; [];<br>  @Provide addrBook: AddressBook &#x3D; new AddressBook(<br>    new Person(“Gigi”, “Itamerenkatu 9”, 180, “Helsinki”, [“18*********”, “18*********”, “18*********”]),<br>    [<br>      new Person(“Oly”, “Itamerenkatu 9”, 180, “Helsinki”, [“11*********”, “12*********”]),<br>      new Person(“Sam”, “Itamerenkatu 9”, 180, “Helsinki”, [“13*********”, “14*********”]),<br>      new Person(“Vivi”, “Itamerenkatu 9”, 180, “Helsinki”, [“15*********”, “168*********”]),<br>    ]);</p>
<p>  contactsChange(propName: string): void {<br>    this.addrBook.contacts &#x3D; AppStorage.get(propName) as ObservedArray<Person>;<br>  }</p>
<p>  build() {<br>    Column() {<br>      AddressBookView({<br>        me: this.addrBook.me,<br>        contacts: this.addrBook.contacts,<br>        selectedPerson: this.addrBook.me<br>      })<br>    }<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**MVVM mechanism**:  </span><br><span class="line">- ViewModel and Model update data through state variables.  </span><br><span class="line">- ViewModel triggers the `build` method of the View page and the execution of `@Builder` custom build functions via state variable updates.  </span><br><span class="line">- The execution of `build` and `@Builder` functions changes corresponding state variables, achieving &quot;updating the view directly when data is updated.&quot;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 5. Why does using setTimeout in a for loop fail in HarmonyOS, and how to construct delays in a for loop?  </span><br><span class="line">**Problem**: Using `setTimeout` in a for loop is ineffective, and empty loops with `data` cause crashes.  </span><br><span class="line"></span><br><span class="line">**Solution**: Wrap `setTimeout` as a Promise and use related APIs.  </span><br><span class="line">Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V2/async-concurrency-overview-0000001632690002-V2  </span><br><span class="line"></span><br><span class="line">**Example (non-blocking delay)**:  </span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; Wait asynchronously<br>const delay &#x3D; (ms: number) &#x3D;&gt; new Promise(resolve &#x3D;&gt; setTimeout(resolve, ms));</p>
<p>for (let i &#x3D; 0; i &lt; 5; i++) {<br>  console.log(<code>Start iteration $&#123;i&#125;</code>);<br>  await delay(1000); &#x2F;&#x2F; Wait 1 second per iteration<br>  console.log(<code>End iteration $&#123;i&#125;</code>);<br>}<br>&#96;&#96;&#96;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/4128-Daily-HarmonyOS-Next-Knowledge-Listening-for-Input-Box-Delete-Key-Network-Requests-Before-Page-Entry-Same-Layer-Rendering-GridCol-Left-Alignment-and-Custom-Popup-Gesture-Prevention/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/4128-Daily-HarmonyOS-Next-Knowledge-Listening-for-Input-Box-Delete-Key-Network-Requests-Before-Page-Entry-Same-Layer-Rendering-GridCol-Left-Alignment-and-Custom-Popup-Gesture-Prevention/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Listening for Input Box Delete Key, Network Requests Before Page Entry, Same-Layer Rendering, GridCol Left Alignment, and Custom Popup Gesture Prevention</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 00:10:09 / Modified: 00:10:23" itemprop="dateCreated datePublished" datetime="2025-06-29T00:10:09+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Knowledge-Listening-for-Input-Box-Delete-Key-Network-Requests-Before-Page-Entry-Same-Layer-Rendering-GridCol-Left-Alignment-and-Custom-Popup-Gesture-Prevention"><a href="#Daily-HarmonyOS-Knowledge-Listening-for-Input-Box-Delete-Key-Network-Requests-Before-Page-Entry-Same-Layer-Rendering-GridCol-Left-Alignment-and-Custom-Popup-Gesture-Prevention" class="headerlink" title="[Daily HarmonyOS Knowledge] Listening for Input Box Delete Key, Network Requests Before Page Entry, Same-Layer Rendering, GridCol Left Alignment, and Custom Popup Gesture Prevention"></a>[Daily HarmonyOS Knowledge] Listening for Input Box Delete Key, Network Requests Before Page Entry, Same-Layer Rendering, GridCol Left Alignment, and Custom Popup Gesture Prevention</h1><h4 id="1-How-to-listen-for-the-delete-key-in-a-HarmonyOS-input-box"><a href="#1-How-to-listen-for-the-delete-key-in-a-HarmonyOS-input-box" class="headerlink" title="1. How to listen for the delete key in a HarmonyOS input box?"></a>1. How to listen for the delete key in a HarmonyOS input box?</h4><p>You can adopt the following solutions:  </p>
<ul>
<li><p>Listen to the <code>onChange</code> event of <code>TextInput</code>. When the user presses the delete key in the input box, the <code>onChange</code> event is triggered, and the passed parameter includes the new text value. By comparing the old and new text values, you can determine whether the user pressed the delete key (i.e., whether the text length decreases).  </p>
</li>
<li><p>Another solution is implemented using a verification code input box. Refer to: <a target="_blank" rel="noopener" href="https://gitee.com/harmonyos-cases/cases/tree/master/CommonAppDevelopment/feature/verifycode">https://gitee.com/harmonyos-cases/cases/tree/master/CommonAppDevelopment/feature/verifycode</a></p>
</li>
</ul>
<h4 id="2-Can-HarmonyOS-execute-interface-request-logic-before-a-page-enters-instead-of-within-the-page-lifecycle-to-reduce-page-waiting-time"><a href="#2-Can-HarmonyOS-execute-interface-request-logic-before-a-page-enters-instead-of-within-the-page-lifecycle-to-reduce-page-waiting-time" class="headerlink" title="2. Can HarmonyOS execute interface request logic before a page enters instead of within the page lifecycle to reduce page waiting time?"></a>2. Can HarmonyOS execute interface request logic before a page enters instead of within the page lifecycle to reduce page waiting time?</h4><p>For page-level operations, the earliest lifecycle function loaded is <code>aboutToAppear</code>. For numerous requests, you can use <code>LazyForEach</code>. Use DevEco Profiler for performance tuning to identify requests with excessive latency and optimize them.  </p>
<h4 id="3-How-does-the-xcomponent-for-same-layer-rendering-in-HarmonyOS-perform-rendering-at-the-underlying-layer"><a href="#3-How-does-the-xcomponent-for-same-layer-rendering-in-HarmonyOS-perform-rendering-at-the-underlying-layer" class="headerlink" title="3. How does the xcomponent for same-layer rendering in HarmonyOS perform rendering at the underlying layer?"></a>3. How does the xcomponent for same-layer rendering in HarmonyOS perform rendering at the underlying layer?</h4><p>Xcomponent supports two rendering methods:  </p>
<ul>
<li>One method specifies <code>libraryName</code>, and the C++ side listens for and obtains the native window, allowing the business to render onto the native window.</li>
</ul>
<p>Regarding the same-layer rendering document, does it retrieve the xcomponent’s ID? How can I obtain the corresponding native window?  </p>
<p>Related API links:  </p>
<ol>
<li>Native XComponent Development Guide: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/napi-xcomponent-guidelines-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/napi-xcomponent-guidelines-V5</a>  </li>
<li>NativeWindow Development Guide: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/native-window-guidelines-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/native-window-guidelines-V5</a>  </li>
<li>Defining Functions for Obtaining and Using NativeWindow: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/native-window-guidelines-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/native-window-guidelines-V5</a></li>
</ol>
<h4 id="4-How-to-left-align-GridCol-subcomponents-in-a-HarmonyOS-grid-layout"><a href="#4-How-to-left-align-GridCol-subcomponents-in-a-HarmonyOS-grid-layout" class="headerlink" title="4. How to left-align GridCol subcomponents in a HarmonyOS grid layout?"></a>4. How to left-align GridCol subcomponents in a HarmonyOS grid layout?</h4><p>Set the width of the <code>Row</code> in the <code>IconWithSubTitle</code> component to prevent adaptive sizing. Refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-layout-development-grid-layout-V5#span">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-layout-development-grid-layout-V5#span</a>  </p>
<h4 id="5-How-to-prevent-gesture-back-cancellation-for-custom-popups-in-HarmonyOS"><a href="#5-How-to-prevent-gesture-back-cancellation-for-custom-popups-in-HarmonyOS" class="headerlink" title="5. How to prevent gesture back cancellation for custom popups in HarmonyOS?"></a>5. How to prevent gesture back cancellation for custom popups in HarmonyOS?</h4><p>Use <code>onwilldismiss</code>. Refer to: <a target="_blank" rel="noopener" href="https://gitee.com/openharmony/docs/blob/master/zh-cn/application-dev/reference/apis-arkui/arkui-ts/ts-methods-custom-dialog-box.md#customdialogcontrolleroptions%E5%AF%B9%E8%B1%A1%E8%AF%B4%E6%98%8E">https://gitee.com/openharmony/docs/blob/master/zh-cn/application-dev/reference/apis-arkui/arkui-ts/ts-methods-custom-dialog-box.md#customdialogcontrolleroptions%E5%AF%B9%E8%B1%A1%E8%AF%B4%E6%98%8E</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/4127-Daily-HarmonyOS-Next-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/4127-Daily-HarmonyOS-Next-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 00:09:01 / Modified: 00:09:34" itemprop="dateCreated datePublished" datetime="2025-06-29T00:09:01+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Hext-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction"><a href="#Daily-HarmonyOS-Hext-Knowledge-Navigation-Jump-Anomalies-Default-Mobile-Version-Webpage-Loading-Menu-Positioning-View-to-Image-Saving-and-H5-Native-Interaction" class="headerlink" title="[Daily HarmonyOS Hext Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction"></a>[Daily HarmonyOS Hext Knowledge] Navigation Jump Anomalies, Default Mobile Version Webpage Loading, Menu Positioning, View-to-Image Saving, and H5-Native Interaction</h1><h4 id="1-HarmonyOS-When-navigating-to-a-non-existent-URL-no-exception-is-thrown-and-it-jumps-to-a-blank-page"><a href="#1-HarmonyOS-When-navigating-to-a-non-existent-URL-no-exception-is-thrown-and-it-jumps-to-a-blank-page" class="headerlink" title="1. HarmonyOS: When navigating to a non-existent URL, no exception is thrown, and it jumps to a blank page?"></a>1. HarmonyOS: When navigating to a non-existent URL, no exception is thrown, and it jumps to a blank page?</h4><p>Using <code>pushDestinationByName</code> can catch exceptions. Refer to the following:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">this.pageStack.pushDestinationByName(&#x27;PageOne&#x27;, &quot;PageOne Param&quot;)</span><br><span class="line">  .catch((error: BusinessError) =&gt; &#123;</span><br><span class="line">    console.error(`Push destination failed, error code = $&#123;error.code&#125;, error.message = $&#123;error.message&#125;.`);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">  console.error(&#x27;Push destination succeed.&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">#### 2. HarmonyOS: How to set the webview to load the mobile version of a webpage by default?  </span><br></pre></td></tr></table></figure>
<p>import webview from ‘@ohos.web.webview’;</p>
<p>@Entry<br>@Component<br>struct Page2 {<br>  webController: webview.WebviewController &#x3D; new webview.WebviewController();<br>  aboutToAppear(): void {<br>    webview.WebviewController.setWebDebuggingAccess(true)<br>  }<br>  build() {<br>    Row() {<br>      Column() {<br>        Web({src: “<a target="_blank" rel="noopener" href="https://www.huawei.com/">https://www.huawei.com</a>“, controller: this.webController}).domStorageAccess(true)<br>          .onControllerAttached(() &#x3D;&gt; {<br>          let newAgent &#x3D; “Mozilla&#x2F;5.0 (Phone; OpenHarmony 4.1) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;114.0.0.0 Safari&#x2F;537.36 ArkWeb&#x2F;4.1.6.1 Mobile”;<br>          this.webController.setCustomUserAgent(newAgent)<br>        })<br>      }<br>      .width(‘100%’)<br>    }<br>    .height(‘100%’)<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 3. HarmonyOS: How to control the position of a popped Menu?  </span><br><span class="line">When clicking a button to pop up a Menu, the position cannot be controlled—it sometimes appears below the button, sometimes on the left/right. To fix the Menu position, configure the `placement` attribute. For example, `Placement.BottomLeft` displays the Menu below the bound component with the left edge aligned.  </span><br><span class="line">Reference: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ui-js-components-menu-V5#%E5%88%9B%E5%BB%BAmenu%E7%BB%84%E4%BB%B6  </span><br><span class="line"></span><br><span class="line">#### 4. HarmonyOS: How to generate an image from a View and save it to the album?  </span><br><span class="line">**Implementation Steps**:  </span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; 1. Poster layout<br>Column() {<br>  &#x2F;&#x2F; Top image<br>  this.renderImage(this.isHiresSong)</p>
<p>  &#x2F;&#x2F; Hi-Res quality label<br>  if (this.labelInfoJson !&#x3D;&#x3D; null || this.labelInfoJson !&#x3D;&#x3D; undefined) {<br>    this.renderHiresLabel()<br>  }</p>
<p>  &#x2F;&#x2F; Lyrics<br>  if (this.selectLyricList.length &gt; 0) {<br>    this.renderLyric()<br>  }</p>
<p>  &#x2F;&#x2F; Title and author<br>  this.renderTitleInfo(this.selectLyricList.length &gt; 0)</p>
<p>  &#x2F;&#x2F; Watermark and QR code<br>  this.renderWatermarkQrc()<br>}<br>.id(‘placard_layout’)<br>.backgroundColor(this.bgColor)<br>.margin({ top: ‘25vp’, bottom: ‘48vp’, left: ‘30vp’, right: ‘30vp’ })<br>.padding({ top: ‘16vp’, bottom: ‘16vp’, left: ‘16vp’, right: ‘16vp’ })</p>
<p>&#x2F;&#x2F; 2. Check permissions before saving (no permission needed for in-app storage)<br>&#x2F;&#x2F; Note: ohos.permission.WRITE_IMAGEVIDEO is a system_basic permission. Ordinary apps need ACL elevation.<br>let content: Context &#x3D; getContext(this)<br>let permissions: Array<Permissions> &#x3D; [‘ohos.permission.WRITE_IMAGEVIDEO’]<br>let atManager &#x3D; abilityAccessCtrl.createAtManager();<br>let promise &#x3D; atManager.requestPermissionsFromUser(content, permissions);<br>let rejectNum &#x3D; 0;<br>promise.then(async (data) &#x3D;&gt; {<br>  let grant: number[] &#x3D; data.authResults;<br>  let grantName: string[] &#x3D; data.permissions;<br>  for (let i &#x3D; 0; i &lt; grant.length; i++) {<br>    if (grant[i] !&#x3D;&#x3D; 0) {<br>      console.info(TAG, ‘user reject permission request ‘ + grantName[i]);<br>      rejectNum++;<br>    }<br>  }<br>  if (rejectNum &gt; 0) {<br>    promptAction.showToast({ message: ‘拒绝权限’ })<br>  } else {<br>    this.savePlacard()<br>  }<br>}).catch((err: Error) &#x3D;&gt; {<br>  console.error(TAG, ‘ requestPermissionsFromUser, error &#x3D; ‘ + err);<br>});</p>
<p>&#x2F;&#x2F; 3. Save the image<br>&#x2F;&#x2F; Capture the component screenshot via componentSnapshot.get(“placard_layout”), returning image.PixelMap<br>componentSnapshot.get(“placard_layout”)<br>  .then((pixmap: image.PixelMap) &#x3D;&gt; {<br>    this.pixmap &#x3D; pixmap;<br>    &#x2F;&#x2F; Choose storage method<br>    …<br>  })</p>
<p>&#x2F;&#x2F; 1) Save directly to app storage<br>image.createImagePacker().packing(pixmap, { format: “image&#x2F;jpeg”, quality: 98 })<br>  .then(((data: ArrayBuffer): void &#x3D;&gt; {<br>    let dir &#x3D; getContext().cacheDir<br>    let file &#x3D; fs.openSync(<code>$&#123;dir&#125;/xxx.jpg</code>, fs.OpenMode.WRITE_ONLY | fs.OpenMode.CREATE | fs.OpenMode.TRUNC)<br>    let len: number &#x3D; fs.writeSync(file.fd, data, { encoding: “utf-8” })<br>    console.log(<code>$&#123;len&#125;</code>)<br>  }))</p>
<p>&#x2F;&#x2F; 2) Use ohos.file.picker to open the system file manager for the user to select a save path, returning a URI<br>const photoSaveOptions &#x3D; new picker.PhotoSaveOptions();<br>photoSaveOptions.newFileNames &#x3D; [fileName + ‘.png’];<br>const photoViewPicker &#x3D; new picker.PhotoViewPicker();<br>photoViewPicker.save(photoSaveOptions)<br>  .then((photoSaveResult) &#x3D;&gt; {<br>    console.log(TAG, “photoSaveUri  photoSaveResult[0]” + JSON.stringify(photoSaveResult[0]))<br>    this.photoSaveUri &#x3D; photoSaveResult[0]<br>  })<br>  .catch((err:Error) &#x3D;&gt; {<br>    console.log(TAG, “photoSaveUri  fail” + JSON.stringify(err))<br>    promptAction.showToast({message:’保存失败’})<br>  })</p>
<p>&#x2F;&#x2F; 3) Save to the album via photoAccessHelper<br>let photoType &#x3D; photoAccessHelper.PhotoType.IMAGE;<br>let extension &#x3D; ‘jpg’;<br>const context &#x3D; getContext(this);<br>let phAccessHelper &#x3D; photoAccessHelper.getPhotoAccessHelper(context);</p>
<p>phAccessHelper.createAsset(photoType, extension, {<br>  title: fileName<br>}, (err, uri) &#x3D;&gt; {<br>  if (uri !&#x3D; undefined) {<br>    console.info(TAG + ‘createAsset uri’ + uri);<br>    this.photoSaveUri &#x3D; uri<br>    console.info(TAG + ‘createAsset successfully’);<br>  } else {<br>    console.error(TAG + ‘createAsset failed, message &#x3D; ‘, err);<br>  }<br>});</p>
<p>&#x2F;&#x2F; After creating the URI, perform file writing<br>pixmap: image.PixelMap | undefined &#x3D; undefined;<br>@State @Watch(“onPhotoSaveUriUpdate”) photoSaveUri: string &#x3D; ‘’;</p>
<p>&#x2F;&#x2F; Listen for URI updates to perform file read&#x2F;write operations<br>onPhotoSaveUriUpdate() {<br>  if (this.photoSaveUri) {<br>    console.error(TAG, ‘photoSaveUri is: ‘ + JSON.stringify(this.photoSaveUri));<br>    const imagePacker &#x3D; image.createImagePacker();<br>    if (this.pixmap &#x3D;&#x3D;&#x3D; undefined) {<br>      return<br>    }<br>    imagePacker.packing(this.pixmap, { format: “image&#x2F;jpeg”, quality: 100 })<br>      .then(data &#x3D;&gt; {<br>        let file &#x3D; fs.openSync(this.photoSaveUri, fs.OpenMode.WRITE_ONLY);<br>        fs.writeSync(file.fd, data);<br>        fs.closeSync(file);<br>        promptAction.showToast({<br>          message: ‘已成功保存至相册’,<br>          duration: 1000<br>        })<br>      })<br>      .catch((error: Error) &#x3D;&gt; {<br>        console.error(TAG, ‘Failed to pack the image. And the error is: ‘ + error);<br>      })<br>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 5. HarmonyOS: How does H5 communicate with HarmonyOS?  </span><br><span class="line">Refer to the document: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/web-app-page-data-channel-V5  </span><br><span class="line"></span><br><span class="line">Frontend pages and the app can use the `createWebMessagePorts()` API to create message ports for two-way communication.  </span><br><span class="line"></span><br><span class="line">**App-side code**:  </span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; xxx.ets<br>import { webview } from ‘@kit.ArkWeb’;<br>import { BusinessError } from ‘@kit.BasicServicesKit’;</p>
<p>@Entry<br>@Component<br>struct WebComponent {<br>  controller: webview.WebviewController &#x3D; new webview.WebviewController();<br>  ports: webview.WebMessagePort[] &#x3D; [];<br>  @State sendFromEts: string &#x3D; ‘Send this message from ets to HTML’;<br>  @State receivedFromHtml: string &#x3D; ‘Display received message send from HTML’;</p>
<p>  build() {<br>    Column() {<br>      Text(this.receivedFromHtml)<br>      TextInput({ placeholder: ‘Send this message from ets to HTML’ })<br>        .onChange((value: string) &#x3D;&gt; {<br>          this.sendFromEts &#x3D; value;<br>        })</p>
<pre><code>  Button(&#39;postMessage&#39;)
    .onClick(() =&gt; &#123;
      try &#123;
        this.ports = this.controller.createWebMessagePorts();
        this.ports[1].onMessageEvent((result: webview.WebMessage) =&gt; &#123;
          let msg = &#39;Got msg from HTML:&#39;;
          if (typeof (result) === &#39;string&#39;) &#123;
            console.info(`received string message from html5, string is: $&#123;result&#125;`);
            msg = msg + result;
          &#125; else if (typeof (result) === &#39;object&#39;) &#123;
            if (result instanceof ArrayBuffer) &#123;
              console.info(`received arraybuffer from html5, length is: $&#123;result.byteLength&#125;`);
              msg = msg + &#39;length is &#39; + result.byteLength;
            &#125; else &#123;
              console.info(&#39;not support&#39;);
            &#125;
          &#125; else &#123;
            console.info(&#39;not support&#39;);
          &#125;
          this.receivedFromHtml = msg;
        &#125;)
        this.controller.postMessage(&#39;__init_port__&#39;, [this.ports[0]], &#39;*&#39;);
      &#125; catch (error) &#123;
        console.error(`ErrorCode: $&#123;(error as BusinessError).code&#125;,  Message: $&#123;(error as BusinessError).message&#125;`);
      &#125;
    &#125;)

  Button(&#39;SendDataToHTML&#39;)
    .onClick(() =&gt; &#123;
      try &#123;
        if (this.ports &amp;&amp; this.ports[1]) &#123;
          this.ports[1].postMessageEvent(this.sendFromEts);
        &#125; else &#123;
          console.error(`ports is null, Please initialize first`);
        &#125;
      &#125; catch (error) &#123;
        console.error(`ErrorCode: $&#123;(error as BusinessError).code&#125;,  Message: $&#123;(error as BusinessError).message&#125;`);
      &#125;
    &#125;)
  Web(&#123; src: $rawfile(&#39;index.html&#39;), controller: this.controller &#125;)
&#125;
</code></pre>
<p>  }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**Frontend page code (index.html)**:  </span><br></pre></td></tr></table></figure>
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebView Message Port Demo</title>
</head>
<body>
    <h1>WebView Message Port Demo</h1>
    <div>
        <input type="button" value="SendToEts" onclick="PostMsgToEts(msgFromJS.value);"/><br/>
        <input id="msgFromJS" type="text" value="send this message from HTML to ets"/><br/>
    </div>
    <p class="output">display received message send from ets</p>
</body>
<script>
var h5Port;
var output = document.querySelector('.output');
window.addEventListener('message', function (event) {
    if (event.data === '__init_port__') {
        if (event.ports[0] !== null) {
            h5Port = event.ports[0];
            h5Port.onmessage = function (event) {
              var msg = 'Got message from ets:';
              var result = event.data;
              if (typeof(result) === 'string') {
                console.info(`received string message from html5, string is: ${result}`);
                msg = msg + result;
              } else if (typeof(result) === 'object') {
                if (result instanceof ArrayBuffer) {
                  console.info(`received arraybuffer from html5, length is: ${result.byteLength}`);
                  msg = msg + 'length is ' + result.byteLength;
                } else {
                  console.info('not support');
                }
              } else {
                console.info('not support');
              }
              output.innerHTML = msg;
            }
        }
    }
})
function PostMsgToEts(data) {
    if (h5Port) {
      h5Port.postMessage(data);
    } else {
      console.error('h5Port is null, Please initialize first');
    }
}
</script>
</html>
```
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Qingkouwei</p>
  <div class="site-description" itemprop="description">Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">317</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingkouwei</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"harmonyostech.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:type" content="website">
<meta property="og:title" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:url" content="https://harmonyostech.github.io/page/11/index.html">
<meta property="og:site_name" content="HarmonyOS NEXT Knowledge Charging Station">
<meta property="og:description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next&#96;s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Qingkouwei">
<meta property="article:tag" content="HarmonyOSNext, HarmonyOS NEXT, HarmonyOS, Cangjie">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://harmonyostech.github.io/page/11/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>HarmonyOS NEXT Knowledge Charging Station</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HarmonyOS NEXT Knowledge Charging Station</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Analysis of Core Technologies and Application Scenarios of HarmonyOS NEXT</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41118-Daily-HarmonyOS-Next-Knowledge-Number-of-Worker-Threads-Determining-User-Permission-Decisions-Image-Upload-Type-Errors-Request-Lock-Release-Timing-H5-Issues/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41118-Daily-HarmonyOS-Next-Knowledge-Number-of-Worker-Threads-Determining-User-Permission-Decisions-Image-Upload-Type-Errors-Request-Lock-Release-Timing-H5-Issues/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Number of Worker Threads, Determining User Permission Decisions, Image Upload Type Errors, Request Lock Release Timing, H5 Issues</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:45:31 / Modified: 09:45:48" itemprop="dateCreated datePublished" datetime="2025-06-29T09:45:31+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Number-of-Worker-Threads-Determining-User-Permission-Decisions-Image-Upload-Type-Errors-Request-Lock-Release-Timing-H5-Issues"><a href="#Daily-HarmonyOS-Next-Knowledge-Number-of-Worker-Threads-Determining-User-Permission-Decisions-Image-Upload-Type-Errors-Request-Lock-Release-Timing-H5-Issues" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Number of Worker Threads, Determining User Permission Decisions, Image Upload Type Errors, Request Lock Release Timing, H5 Issues"></a>[Daily HarmonyOS Next Knowledge] Number of Worker Threads, Determining User Permission Decisions, Image Upload Type Errors, Request Lock Release Timing, H5 Issues</h1><h4 id="1-How-to-determine-the-number-of-worker-threads-created-in-HarmonyOS"><a href="#1-How-to-determine-the-number-of-worker-threads-created-in-HarmonyOS" class="headerlink" title="1. How to determine the number of worker threads created in HarmonyOS?"></a>1. How to determine the number of worker threads created in HarmonyOS?</h4><p>Since there is a limit on the number of worker threads, we need to query the current number of workers to avoid creation failures. Is there a limit on the number of concurrently running worker threads, or on the number of worker threads that can be created by the same application?  </p>
<ol>
<li>There is currently no interface to query the current number of worker threads, but it can be viewed via <code>ps</code>.  </li>
<li>There is a limit on the number of worker threads that can be created under the same process. If the upper limit is reached, call <code>terminate</code> to destroy one before creating a new one.</li>
</ol>
<h4 id="2-In-HarmonyOS-permission-judgment-can-we-determine-whether-the-user-has-not-yet-made-a-permission-decision"><a href="#2-In-HarmonyOS-permission-judgment-can-we-determine-whether-the-user-has-not-yet-made-a-permission-decision" class="headerlink" title="2. In HarmonyOS permission judgment, can we determine whether the user has not yet made a permission decision?"></a>2. In HarmonyOS permission judgment, can we determine whether the user has not yet made a permission decision?</h4><p>There are only two states: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-abilityaccessctrl-V5#grantstatus">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-abilityaccessctrl-V5#grantstatus</a>  </p>
<p>GrantStatus is an enumeration representing the authorization status:  </p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>PERMISSION_DENIED</td>
<td>-1</td>
<td>Indicates unauthorized.</td>
</tr>
<tr>
<td>PERMISSION_GRANTED</td>
<td>0</td>
<td>Indicates authorized.</td>
</tr>
</tbody></table>
<h4 id="3-HarmonyOS-prompts-an-image-upload-type-error-even-when-app-information-configuration-is-consistent"><a href="#3-HarmonyOS-prompts-an-image-upload-type-error-even-when-app-information-configuration-is-consistent" class="headerlink" title="3. HarmonyOS prompts an image upload type error even when app information configuration is consistent."></a>3. HarmonyOS prompts an image upload type error even when app information configuration is consistent.</h4><ol>
<li>The image format may be incorrect. Convert it again to PNG or JPG format for format validation.  </li>
<li>The image resolution may be unsuitable. It is recommended to ensure a 16:9 resolution.</li>
</ol>
<h4 id="4-When-is-the-lock-added-by-HarmonyOS-ArkTS-Utils-locks-AsyncLock-request-released"><a href="#4-When-is-the-lock-added-by-HarmonyOS-ArkTS-Utils-locks-AsyncLock-request-released" class="headerlink" title="4. When is the lock added by HarmonyOS ArkTS Utils.locks.AsyncLock.request released?"></a>4. When is the lock added by HarmonyOS ArkTS <code>Utils.locks.AsyncLock.request</code> released?</h4><ol>
<li>The added lock is released when the closure ends.  </li>
<li>There is currently no method to release the lock actively.<br>Asynchronous locks are based on micro-task queues. Even after the lock is released, it must wait for other micro-tasks to complete. Consider splitting tasks.</li>
</ol>
<h4 id="5-When-embedding-an-H5-page-in-HarmonyOS-ArkWeb-the-original-functions-fail-to-work"><a href="#5-When-embedding-an-H5-page-in-HarmonyOS-ArkWeb-the-original-functions-fail-to-work" class="headerlink" title="5. When embedding an H5 page in HarmonyOS ArkWeb, the original functions fail to work."></a>5. When embedding an H5 page in HarmonyOS ArkWeb, the original functions fail to work.</h4><ol>
<li>Can the telephone function invoked via an <code>&lt;a&gt;</code> tag in the embedded page take effect directly in HarmonyOS’s WebView?  </li>
<li>Can an <code>&lt;input&gt;</code> tag invoking album image selection take effect directly in HarmonyOS’s WebView?</li>
</ol>
<p><strong>1. For the first question, refer to the following code:</strong>  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// xxx.ets</span></span><br><span class="line"><span class="keyword">import</span> web_webview <span class="keyword">from</span> <span class="string">&#x27;@ohos.web.webview&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> call <span class="keyword">from</span> <span class="string">&#x27;@ohos.telephony.call&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">WebComponent</span> &#123;</span><br><span class="line">  <span class="attr">webviewController</span>: web_webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> web_webview.<span class="title class_">WebviewController</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: $rawfile(<span class="string">&#x27;call.html&#x27;</span>), <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">webviewController</span> &#125;)</span><br><span class="line">        .<span class="title function_">onLoadIntercept</span>(<span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (event) &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="attr">url</span>: <span class="built_in">string</span> = event.<span class="property">data</span>.<span class="title function_">getRequestUrl</span>();</span><br><span class="line">            <span class="comment">// Check if the link is a dialing link</span></span><br><span class="line">            <span class="keyword">if</span> (url.<span class="title function_">indexOf</span>(<span class="string">&#x27;tel://&#x27;</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="comment">// Navigate to the dialing interface</span></span><br><span class="line">              call.<span class="title function_">makeCall</span>(url.<span class="title function_">substring</span>(<span class="number">6</span>), <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;make call succeeded.&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                  <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;make call fail, err is:&#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">**2. For the second question, refer to the following code:**  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct photo &#123;</span><br><span class="line">  <span class="attr">controller</span>: web_webview.<span class="property">WebviewController</span> = <span class="keyword">new</span> web_webview.<span class="title class_">WebviewController</span>();</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">webPickImage</span>: pickImage = <span class="keyword">new</span> <span class="title function_">pickImage</span>();</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">webCameraImage</span>: cameraImage = <span class="keyword">new</span> <span class="title function_">cameraImage</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// Configure Web to enable debug mode</span></span><br><span class="line">    web_webview.<span class="property">WebviewController</span>.<span class="title function_">setWebDebuggingAccess</span>(<span class="literal">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;refresh&#x27;</span>)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">controller</span>.<span class="title function_">refresh</span>();</span><br><span class="line">          &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="attr">e</span>: business_error.<span class="property">BusinessError</span> = error <span class="keyword">as</span> business_error.<span class="property">BusinessError</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`ErrorCode: <span class="subst">$&#123;e.code&#125;</span>,  Message: <span class="subst">$&#123;e.message&#125;</span>`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;Register JavaScript To Window&#x27;</span>)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">controller</span>.<span class="title function_">registerJavaScriptProxy</span>(<span class="variable language_">this</span>.<span class="property">webPickImage</span>, <span class="string">&quot;pickImageName&quot;</span>, [<span class="string">&quot;testPickImage&quot;</span>]);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">controller</span>.<span class="title function_">registerJavaScriptProxy</span>(<span class="variable language_">this</span>.<span class="property">webCameraImage</span>, <span class="string">&quot;cameraImageName&quot;</span>, [<span class="string">&quot;testCameraImage&quot;</span>]);</span><br><span class="line">          &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="attr">e</span>: business_error.<span class="property">BusinessError</span> = error <span class="keyword">as</span> business_error.<span class="property">BusinessError</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`ErrorCode: <span class="subst">$&#123;e.code&#125;</span>,  Message: <span class="subst">$&#123;e.message&#125;</span>`</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      <span class="title class_">Web</span>(&#123; <span class="attr">src</span>: $rawfile(<span class="string">&#x27;Test1128.html&#x27;</span>), <span class="attr">controller</span>: <span class="variable language_">this</span>.<span class="property">controller</span> &#125;)</span><br><span class="line">        .<span class="title function_">javaScriptAccess</span>(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">pickImage</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">testPickImage</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="title class_">PhotoSelectOptions</span> = <span class="keyword">new</span> picker.<span class="title class_">PhotoSelectOptions</span>();</span><br><span class="line">      <span class="title class_">PhotoSelectOptions</span>.<span class="property">MIMEType</span> = picker.<span class="property">PhotoViewMIMETypes</span>.<span class="property">IMAGE_TYPE</span>;</span><br><span class="line">      <span class="title class_">PhotoSelectOptions</span>.<span class="property">maxSelectNumber</span> = <span class="number">5</span>;</span><br><span class="line">      <span class="keyword">let</span> photoPicker = <span class="keyword">new</span> picker.<span class="title class_">PhotoViewPicker</span>();</span><br><span class="line">      photoPicker.<span class="title function_">select</span>(<span class="title class_">PhotoSelectOptions</span>).<span class="title function_">then</span>(<span class="function">(<span class="params"><span class="title class_">PhotoSelectResult</span>: picker.<span class="title class_">PhotoSelectResult</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&#x27;PhotoViewPicker.select successfully, PhotoSelectResult uri: &#x27;</span> +</span><br><span class="line">        <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title class_">PhotoSelectResult</span>));</span><br><span class="line">      &#125;).<span class="title function_">catch</span>(<span class="function">(<span class="params"><span class="attr">err</span>: <span class="title class_">BusinessError</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;PhotoViewPicker.select failed with err: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="attr">err</span>: <span class="title class_">BusinessError</span> = error <span class="keyword">as</span> <span class="title class_">BusinessError</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;PhotoViewPicker failed with err: &#x27;</span> + <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(err));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;121&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">cameraImage</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">testCameraImage</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> context = <span class="title function_">getContext</span>(<span class="variable language_">this</span>) <span class="keyword">as</span> common.<span class="property">UIAbilityContext</span></span><br><span class="line">    context.<span class="title function_">startAbilityForResult</span>(&#123;</span><br><span class="line">      <span class="attr">action</span>: <span class="string">&quot;ohos.want.action.imageCapture&quot;</span>,</span><br><span class="line">      <span class="attr">parameters</span>: &#123;</span><br><span class="line">        <span class="attr">callBundleName</span>: <span class="string">&quot;com.hm.imageshow&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="function">(<span class="params">err, data</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">&quot;imageCapture:&quot;</span> + <span class="string">`<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>`</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;1221&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41119-Daily-HarmonyOS-Next-Knowledge-Grid-Item-Drag-Support-WebView-Callback-Issues-Page-Name-Acquisition-Danmaku-Effect-Implementation-Modifying-App-Output-Path/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41119-Daily-HarmonyOS-Next-Knowledge-Grid-Item-Drag-Support-WebView-Callback-Issues-Page-Name-Acquisition-Danmaku-Effect-Implementation-Modifying-App-Output-Path/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Grid Item Drag Support, WebView Callback Issues, Page Name Acquisition, Danmaku Effect Implementation, Modifying App Output Path</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:44:40 / Modified: 09:45:00" itemprop="dateCreated datePublished" datetime="2025-06-29T09:44:40+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Grid-Item-Drag-Support-WebView-Callback-Issues-Page-Name-Acquisition-Danmaku-Effect-Implementation-Modifying-App-Output-Path"><a href="#Daily-HarmonyOS-Next-Knowledge-Grid-Item-Drag-Support-WebView-Callback-Issues-Page-Name-Acquisition-Danmaku-Effect-Implementation-Modifying-App-Output-Path" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Grid Item Drag Support, WebView Callback Issues, Page Name Acquisition, Danmaku Effect Implementation, Modifying App Output Path"></a>[Daily HarmonyOS Next Knowledge] Grid Item Drag Support, WebView Callback Issues, Page Name Acquisition, Danmaku Effect Implementation, Modifying App Output Path</h1><h4 id="1-Does-HarmonyOS-support-dragging-items-in-a-Grid"><a href="#1-Does-HarmonyOS-support-dragging-items-in-a-Grid" class="headerlink" title="1. Does HarmonyOS support dragging items in a Grid?"></a>1. Does HarmonyOS support dragging items in a Grid?</h4><p>I want the items in the Grid to be draggable and removable after being dragged out. The following code was provided by you last time, which normally works. However, when dragging downward over a TextInput, the <code>onDragMove</code> event of the GridItem stops firing. Setting <code>draggable(false)</code> for the TextInput does not resolve the issue.  </p>
<pre><code class="language-typescript">import &#123; media &#125; from &#39;@kit.MediaKit&#39;;
import &#123; BusinessError &#125; from &#39;@kit.BasicServicesKit&#39;;

import util from &#39;@ohos.util&#39;;
import &#123; curves &#125; from &#39;@kit.ArkUI&#39;;

@Entry
@Component
struct Index &#123;
  @State numbers: number[] = []
  @State isTextInputVisible: boolean = true
  @State isGridItemVisible: Visibility = Visibility.Visible
  scroller: Scroller = new Scroller()
  @State enableScroll: boolean = true
  @State scaleItem: number = -1
  @State dragItem: number = -1
  @State offsetX: number = 0
  @State offsetY: number = 0
  @State currentY: number = 0
  private dragRefOffsetx: number = 0
  private dragRefOffsety: number = 0
  private FIX_VP_X: number = 108
  private FIX_VP_Y: number = 120

  aboutToAppear() &#123;
    for (let i = 1; i &lt;= 11; i++) &#123;
      this.numbers.push(i)
    &#125;
  &#125;

  // Slide left
  left(index: number): void &#123;
    this.offsetX += this.FIX_VP_X
    this.dragRefOffsetx -= this.FIX_VP_X
    this.itemMove(index, index - 1)
  &#125;

  // Slide right
  right(index: number): void &#123;
    this.offsetX -= this.FIX_VP_X
    this.dragRefOffsetx += this.FIX_VP_X
    this.itemMove(index, index + 1)
  &#125;

  itemMove(index: number, newIndex: number): void &#123;
    console.info(&#39;index:&#39; + index + &#39; newIndex:&#39; + newIndex)
    let tmp = this.numbers.splice(index, 1)
    this.numbers.splice(newIndex, 0, tmp[0])
  &#125;

  build() &#123;
    Column(&#123; space: 5 &#125;) &#123;
      Grid(this.scroller) &#123;
        ForEach(this.numbers, (item: number) =&gt; &#123;
          GridItem() &#123;
            Text(item + &#39;&#39;)
              .fontSize(16)
              .width(&#39;100%&#39;)
              .textAlign(TextAlign.Center)
              .height(100)
              .borderRadius(10)
              .backgroundColor(0xFFFFFF)
              .animation(&#123; curve: Curve.Sharp, duration: 300 &#125;)
          &#125;
          .visibility(this.dragItem == item ? Visibility.Hidden : Visibility.Visible) // Set visibility based on the dragged item
          .width(100)
          .height(100)
          .padding(5)
          .zIndex(this.dragItem == item ? 1 : 0)
          .scale(&#123; x: this.scaleItem == item ? 1.05 : 1, y: this.scaleItem == item ? 1.05 : 1 &#125;)
          .translate(this.dragItem == item ? &#123; x: this.offsetX, y: this.offsetY &#125; : &#123; x: 0, y: 0 &#125;)
          .onDragStart((event: DragEvent, extraParams?: string) =&gt; &#123;
            animateTo(&#123; curve: Curve.Friction, duration: 300 &#125;, () =&gt; &#123;
              this.scaleItem = item
            &#125;)
            this.dragItem = item
            this.dragRefOffsetx = event.getWindowX()
            this.dragRefOffsety = event.getWindowY()
          &#125;)
          .onDrop((event: DragEvent, extraParams?: string) =&gt; &#123;
          &#125;)
          .onDragMove((event: DragEvent, extraParams?: string) =&gt; &#123;
            this.enableScroll = false
            console.log(&#39;onDragMove GridItem getWindowX&#39;, event.getWindowX())
            console.log(&#39;onDragMove GridItem getWindowY&#39;, event.getWindowY())
            this.offsetX = event.getWindowX() - this.dragRefOffsetx
            this.offsetY = event.getWindowY() - this.dragRefOffsety
            this.currentY = event.getWindowY()
            console.log(&#39;onDragMove GridItem offsetX&#39;, this.currentY)
            animateTo(&#123; curve: curves.interpolatingSpring(0, 1, 400, 38) &#125;, () =&gt; &#123;
              let index = this.numbers.indexOf(this.dragItem)
              console.log(&#39;index&#39;, index)
              if (this.offsetX &gt;= this.FIX_VP_X / 2 &amp;&amp; this.offsetY &lt; this.FIX_VP_Y) &#123;
                this.right(index)
              &#125; else if (this.offsetX &lt;= -this.FIX_VP_X / 2 &amp;&amp; this.offsetY &lt; this.FIX_VP_Y) &#123;
                this.left(index)
              &#125;
            &#125;)
            this.isGridItemVisible = Visibility.Hidden
          &#125;)
          .onDragEnd(() =&gt; &#123;
            this.enableScroll = true
            this.isTextInputVisible = true
            this.isGridItemVisible = Visibility.Visible
            animateTo(&#123; curve: curves.interpolatingSpring(0, 1, 400, 38) &#125;, () =&gt; &#123;
              this.dragItem = -1
              this.scaleItem = -1
            &#125;)
          &#125;)
        &#125;, (item: number) =&gt; item.toString())
      &#125;
      .padding(&#123; left: 20, right: 20 &#125;)
      .width(&#39;100%&#39;)
      .height(&#39;120&#39;)
      .scrollBar(BarState.Off)
      .rowsTemplate(&#39;1fr&#39;)
      .columnsGap(5)
      .editMode(true)
      .edgeEffect(EdgeEffect.Spring)
      .backgroundColor(&#39;#0D182431&#39;)
      .enabled(this.enableScroll)

      // Modified TextInput to ignore drag events
      TextInput(&#123;placeholder: &#39;Add Title&#39;&#125;)
        .width(&#39;100%&#39;)
        .height(200)
      // .visibility(this.isTextInputVisible ? Visibility.Visible : Visibility.Hidden)
      // .onDragMove(() =&gt; &#123;
      // // Hide TextInput
      // this.isTextInputVisible = false
      // &#125;)

      Text(&#39;Delete&#39;)
        .width(&#39;100%&#39;)
        .height(50)
        .backgroundColor(Color.Red)
        .position(&#123; bottom: 0 &#125;)
        .visibility(this.currentY &gt; 580 ? Visibility.Visible : Visibility.Hidden)
        .hitTestBehavior(HitTestMode.None)
    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;)
    .margin(&#123; top: 5 &#125;)
    .backgroundColor(&#39;#0D182431&#39;)
  &#125;
&#125;
</code></pre>
<h4 id="2-The-error-codes-returned-in-HarmonyOS-Webview’s-onErrorReceive-do-not-match-the-documentation"><a href="#2-The-error-codes-returned-in-HarmonyOS-Webview’s-onErrorReceive-do-not-match-the-documentation" class="headerlink" title="2. The error codes returned in HarmonyOS Webview’s onErrorReceive do not match the documentation."></a>2. The error codes returned in HarmonyOS Webview’s <code>onErrorReceive</code> do not match the documentation.</h4><p>The error codes returned in Webview’s <code>onErrorReceive</code> do not align with the documentation: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/errorcode-webview-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/errorcode-webview-V5</a>. Some return <code>-2</code>, others <code>-106</code>, and some <code>-302</code>.  </p>
<p>Refer to the following document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-neterrorlist-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-neterrorlist-V5</a>.  </p>
<h4 id="3-How-to-obtain-the-page-name-and-uniqueness-via-context-common-Context-in-HarmonyOS"><a href="#3-How-to-obtain-the-page-name-and-uniqueness-via-context-common-Context-in-HarmonyOS" class="headerlink" title="3. How to obtain the page name and uniqueness via context: common.Context in HarmonyOS?"></a>3. How to obtain the page name and uniqueness via <code>context: common.Context</code> in HarmonyOS?</h4><ul>
<li>Use <code>router.getstat</code> to get the page name on the current page: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-router-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-router-V5</a>.  </li>
<li>Use <code>getStringValue</code> to get the identifier: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-resource-manager-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-resource-manager-V5</a>.</li>
</ul>
<h4 id="4-How-to-implement-text-animation-effects-in-HarmonyOS-such-as-displaying-text-at-a-specific-position-when-clicked-moving-upward-by-a-certain-distance-and-automatically-hiding-while-supporting-multiple-texts-displayed-in-sequence-with-spacing-based-on-click-intervals-similar-to-danmaku"><a href="#4-How-to-implement-text-animation-effects-in-HarmonyOS-such-as-displaying-text-at-a-specific-position-when-clicked-moving-upward-by-a-certain-distance-and-automatically-hiding-while-supporting-multiple-texts-displayed-in-sequence-with-spacing-based-on-click-intervals-similar-to-danmaku" class="headerlink" title="4. How to implement text animation effects in HarmonyOS, such as displaying text at a specific position when clicked, moving upward by a certain distance, and automatically hiding, while supporting multiple texts displayed in sequence with spacing based on click intervals (similar to danmaku)?"></a>4. How to implement text animation effects in HarmonyOS, such as displaying text at a specific position when clicked, moving upward by a certain distance, and automatically hiding, while supporting multiple texts displayed in sequence with spacing based on click intervals (similar to danmaku)?</h4><p>Implement text animation for the Text component: display text at a specific position when clicked, move upward by a certain distance, and auto-hide. For consecutive quick clicks, display multiple texts that move upward and hide in sequence based on click intervals, similar to danmaku.  </p>
<p>Refer to the following approach:  </p>
<ol>
<li>Create an Image component to show text on click.  </li>
<li>Use <code>@buildParams</code> for text, which appears each time a click occurs.  </li>
<li>Implement text effects with <code>transition</code>.</li>
</ol>
<h4 id="5-How-to-modify-the-output-path-and-name-when-building-an-app-or-hap-in-HarmonyOS"><a href="#5-How-to-modify-the-output-path-and-name-when-building-an-app-or-hap-in-HarmonyOS" class="headerlink" title="5. How to modify the output path and name when building an app or hap in HarmonyOS?"></a>5. How to modify the output path and name when building an app or hap in HarmonyOS?</h4><ul>
<li>For package naming, refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-customized-multi-targets-and-products-guides-V5#section329173315468">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-customized-multi-targets-and-products-guides-V5#section329173315468</a>.  </li>
<li>Configure the artifact storage path with <code>ohos.buildDir</code>, refer to: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-set-options-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-set-options-V5</a>.</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41120-Daily-HarmonyOS-Next-Knowledge-WebView-Event-Listening-Build-Tool-Validation-Rules-Safe-Area-Issues-Grid-Layout-Alignment-String-to-Base64/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41120-Daily-HarmonyOS-Next-Knowledge-WebView-Event-Listening-Build-Tool-Validation-Rules-Safe-Area-Issues-Grid-Layout-Alignment-String-to-Base64/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] WebView Event Listening, Build Tool Validation Rules, Safe Area Issues, Grid Layout Alignment, String to Base64</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:43:34 / Modified: 09:44:02" itemprop="dateCreated datePublished" datetime="2025-06-29T09:43:34+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-WebView-Event-Listening-Build-Tool-Validation-Rules-Safe-Area-Issues-Grid-Layout-Alignment-String-to-Base64"><a href="#Daily-HarmonyOS-Next-Knowledge-WebView-Event-Listening-Build-Tool-Validation-Rules-Safe-Area-Issues-Grid-Layout-Alignment-String-to-Base64" class="headerlink" title="[Daily HarmonyOS Next Knowledge] WebView Event Listening, Build Tool Validation Rules, Safe Area Issues, Grid Layout Alignment, String to Base64"></a>[Daily HarmonyOS Next Knowledge] WebView Event Listening, Build Tool Validation Rules, Safe Area Issues, Grid Layout Alignment, String to Base64</h1><h4 id="1-How-does-HarmonyOS’s-WebView-listen-for-scroll-events-How-can-H5-directly-call-phone-numbers"><a href="#1-How-does-HarmonyOS’s-WebView-listen-for-scroll-events-How-can-H5-directly-call-phone-numbers" class="headerlink" title="1. How does HarmonyOS’s WebView listen for scroll events? How can H5 directly call phone numbers?"></a>1. How does HarmonyOS’s WebView listen for scroll events? How can H5 directly call phone numbers?</h4><p>Code for WebView scroll event listening and phone calling: The first Web component listens for scroll events, and the second Web component calls the phone via H5.  </p>
<pre><code class="language-typescript">// xxx.ets
import webView from &#39;@ohos.web.webview&#39;;
import &#123; call &#125; from &#39;@kit.TelephonyKit&#39;;
import &#123; BusinessError &#125; from &#39;@kit.BasicServicesKit&#39;;

@Entry
@Component
struct WebPage &#123;
  controller: webView.WebviewController = new webView.WebviewController();
  aaa: number = 0

  build() &#123;
    Column(&#123; space: 20 &#125;) &#123;
      Web(&#123; src: &#39;https://developer.huawei.com/consumer/cn/&#39;, controller: this.controller &#125;)
        .height(500)
        .javaScriptAccess(true)
        .domStorageAccess(true)
        .verticalScrollBarAccess(true)
        .onScroll((event) =&gt; &#123;
          if (event.yOffset &gt; this.aaa) &#123;
            console.log(&#39;aaa scrolling down&#39;)
          &#125;
          if (this.aaa &gt; event.yOffset) &#123;
            console.log(&#39;aaa scrolling up&#39;);
          &#125;
          this.aaa = event.yOffset
        &#125;)

      Divider()

      Web(&#123; src: $rawfile(&#39;call.html&#39;), controller: this.controller &#125;)
        .height(500)
        .onLoadIntercept((event) =&gt; &#123;
          if (event) &#123;
            let url: string = event.data.getRequestUrl();
            // Check if the link is a dialing link
            if (url.indexOf(&#39;tel://&#39;) === 0) &#123;
              call.makeCall(url.substring(6), (err: BusinessError) =&gt; &#123;
                if (!err) &#123;
                  console.log(&#39;make call success.&#39;);
                &#125; else &#123;
                  console.log(&#39;make call fail, err is:&#39; + JSON.stringify(err));
                &#125;
              &#125;);
              return true;
            &#125;
          &#125;
          return false;
        &#125;)
    &#125;

  &#125;
</code></pre>
<p>call.html:  </p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;body&gt; &lt;div&gt; &lt;a href=&quot;tel://10086&quot;&gt;Call&lt;/a&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt;
</code></pre>
<h4 id="2-The-validation-rules-for-macOS-and-Linux-toolchain-builds-are-inconsistent-How-to-modify-them-to-consistent-case-sensitive-rules"><a href="#2-The-validation-rules-for-macOS-and-Linux-toolchain-builds-are-inconsistent-How-to-modify-them-to-consistent-case-sensitive-rules" class="headerlink" title="2. The validation rules for macOS and Linux toolchain builds are inconsistent. How to modify them to consistent case-sensitive rules?"></a>2. The validation rules for macOS and Linux toolchain builds are inconsistent. How to modify them to consistent case-sensitive rules?</h4><p>When only modifying dependencies in <code>dependencies</code> to uppercase while keeping <code>import</code> statements in lowercase, local compilation (macOS) passes, but Linux Commandline packaging fails to find the package.  </p>
<p><strong>Impact</strong>: Developers may mistakenly assume the code is correct after local compilation, leading to pipeline packaging failures.  </p>
<p>Set the <code>strictMode</code> field to <code>true</code> in the configuration file <code>build-profile.json5</code>:  </p>
<pre><code class="language-json5">&quot;strictMode&quot;: &#123;
  &quot;caseSensitiveCheck&quot;: true
&#125;
</code></pre>
<p>The compiler will strictly check the case of imported files, and incorrect file name case will result in compilation errors.<br><strong>Reference Document</strong>: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-build-profile-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-build-profile-V5</a>  </p>
<h4 id="3-Using-expandSafeArea-for-a-HarmonyOS-Web-component-does-not-adapt-the-web-page-rendering-content"><a href="#3-Using-expandSafeArea-for-a-HarmonyOS-Web-component-does-not-adapt-the-web-page-rendering-content" class="headerlink" title="3. Using expandSafeArea for a HarmonyOS Web component does not adapt the web page rendering content."></a>3. Using <code>expandSafeArea</code> for a HarmonyOS Web component does not adapt the web page rendering content.</h4><p>To achieve full-screen web display and hide the status bar and navigation bar, add the following code to avoid safe area adjustments:  </p>
<pre><code class="language-typescript">// 1. Set the window to full screen
let isLayoutFullScreen = true;
windowClass.setWindowLayoutFullScreen(isLayoutFullScreen)
// 2. Set the status bar and navigation bar to hidden
windowClass.setSpecificSystemBarEnabled(&#39;status&#39;, false)
</code></pre>
<p><strong>Reference Document</strong>: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-develop-apply-immersive-effects-V5#section202484117114">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-develop-apply-immersive-effects-V5#section202484117114</a>  </p>
<h4 id="4-In-HarmonyOS-Grid-layout-items-are-arranged-by-rows-with-an-unfixed-number-of-columns-and-fixed-GridItem-sizes-How-to-center-all-GridItems-instead-of-left-aligning-them"><a href="#4-In-HarmonyOS-Grid-layout-items-are-arranged-by-rows-with-an-unfixed-number-of-columns-and-fixed-GridItem-sizes-How-to-center-all-GridItems-instead-of-left-aligning-them" class="headerlink" title="4. In HarmonyOS Grid layout, items are arranged by rows with an unfixed number of columns and fixed GridItem sizes. How to center all GridItems instead of left-aligning them?"></a>4. In HarmonyOS Grid layout, items are arranged by rows with an unfixed number of columns and fixed GridItem sizes. How to center all GridItems instead of left-aligning them?</h4><p>To center GridItems relative to the Grid container, use the <code>margin</code> attribute for offset. Set either <code>rowsTemplate</code> or <code>columnsTemplate</code>: elements are arranged in the specified direction, and the Grid can scroll to display overflow content. If <code>rowsTemplate</code> is set, the Grid scrolls horizontally, with the main axis horizontal and the cross axis vertical. The leftmost subcomponent is rendered first.  </p>
<pre><code class="language-typescript">@Entry
@Component
struct Page617 &#123;
  @State message: string = &#39;Hello World&#39;;
  @State numbers1: String[] = [&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;]

  build() &#123;
    RelativeContainer() &#123;
      Grid() &#123;
        ForEach(this.numbers1, (day: string) =&gt; &#123;
          ForEach(this.numbers1, (day: string) =&gt; &#123;
            GridItem() &#123;
              Text(day)
                .fontSize(16)
                .backgroundColor(0xF9CF93)
                .width(&#39;50&#39;)
                .height(&#39;50&#39;)
                .textAlign(TextAlign.Center)
            &#125;.margin(&#123; left: 20, right: 20 &#125;)
          &#125;, (day: string) =&gt; day)
        &#125;, (day: string) =&gt; day)
      &#125;

      // .columnsTemplate(&#39;1fr 1fr 1fr&#39;)
      .rowsTemplate(&#39;1fr 1fr 1fr&#39;)
      .columnsGap(20)
      .rowsGap(20)
      .width(&#39;90%&#39;)
      .backgroundColor(0xFAEEE0)
      .height(300)
    &#125;
    .height(&#39;100%&#39;)
    .width(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h4 id="5-Calling-base64Helper-decodeSync-to-parse-a-URL-in-HarmonyOS-throws-an-error-Are-there-alternative-methods-to-convert-strings-to-base64"><a href="#5-Calling-base64Helper-decodeSync-to-parse-a-URL-in-HarmonyOS-throws-an-error-Are-there-alternative-methods-to-convert-strings-to-base64" class="headerlink" title="5. Calling base64Helper.decodeSync to parse a URL in HarmonyOS throws an error. Are there alternative methods to convert strings to base64?"></a>5. Calling <code>base64Helper.decodeSync</code> to parse a URL in HarmonyOS throws an error. Are there alternative methods to convert strings to base64?</h4><p>Base64 does not support special characters, which need to be processed first. Consider using <code>TextEncoder</code> and <code>TextDecoder</code> for data handling.<br><strong>Reference Document</strong>: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-util-V5#textencoder">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-util-V5#textencoder</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41121-Daily-HarmonyOS-Next-Knowledge-List-Swipe-Sliding-Conflict-Pull-to-Refresh-Compilation-Error-Location-Lifecycle-Monitoring-App-Market-Listing-Requirements/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41121-Daily-HarmonyOS-Next-Knowledge-List-Swipe-Sliding-Conflict-Pull-to-Refresh-Compilation-Error-Location-Lifecycle-Monitoring-App-Market-Listing-Requirements/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] List+Swipe Sliding Conflict, Pull-to-Refresh, Compilation Error Location, Lifecycle Monitoring, App Market Listing Requirements</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:41:54 / Modified: 09:42:59" itemprop="dateCreated datePublished" datetime="2025-06-29T09:41:54+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-List-Swipe-Sliding-Conflict-Pull-to-Refresh-Compilation-Error-Location-Lifecycle-Monitoring-App-Market-Listing-Requirements"><a href="#Daily-HarmonyOS-Next-Knowledge-List-Swipe-Sliding-Conflict-Pull-to-Refresh-Compilation-Error-Location-Lifecycle-Monitoring-App-Market-Listing-Requirements" class="headerlink" title="[Daily HarmonyOS Next Knowledge] List+Swipe Sliding Conflict, Pull-to-Refresh, Compilation Error Location, Lifecycle Monitoring, App Market Listing Requirements"></a>[Daily HarmonyOS Next Knowledge] List+Swipe Sliding Conflict, Pull-to-Refresh, Compilation Error Location, Lifecycle Monitoring, App Market Listing Requirements</h1><h4 id="1-HarmonyOS-List-Swipe-web-sliding-conflict"><a href="#1-HarmonyOS-List-Swipe-web-sliding-conflict" class="headerlink" title="1. HarmonyOS List+Swipe+web sliding conflict?"></a>1. HarmonyOS List+Swipe+web sliding conflict?</h4><p>When nesting a horizontally sliding Swipe within a List, and then nesting a Web component within Swipe, setting gesture priority may prevent联动 (co联动) interaction between the Web and List.  </p>
<p><strong>Cause</strong>: Sliding conflict may arise from nesting a List component with a Web component. This can be mitigated using touch test control: <code>.hitTestBehavior(HitTestMode.Block)</code>.<br><strong>Reference Document</strong>: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-gesture-events-multi-level-gesture-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-gesture-events-multi-level-gesture-V5</a>  </p>
<h4 id="2-How-to-implement-pull-to-refresh-for-HarmonyOS-Webview"><a href="#2-How-to-implement-pull-to-refresh-for-HarmonyOS-Webview" class="headerlink" title="2. How to implement pull-to-refresh for HarmonyOS Webview?"></a>2. How to implement pull-to-refresh for HarmonyOS Webview?</h4><p>Pull-to-refresh can be achieved using pulltorefresh.<br><strong>Reference Link</strong>: <a target="_blank" rel="noopener" href="https://ohpm.openharmony.cn/#/cn/detail/@ohos%2Fpulltorefresh">https://ohpm.openharmony.cn/#/cn/detail/@ohos%2Fpulltorefresh</a>  </p>
<h4 id="3-When-compiling-via-Command-Line-how-to-obtain-error-information-or-the-compilation-success-status-in-case-of-errors"><a href="#3-When-compiling-via-Command-Line-how-to-obtain-error-information-or-the-compilation-success-status-in-case-of-errors" class="headerlink" title="3. When compiling via Command Line, how to obtain error information or the compilation success status in case of errors?"></a>3. When compiling via Command Line, how to obtain error information or the compilation success status in case of errors?</h4><ol>
<li><p>When compiling with hvigor, use the following commands to display relevant log information:  </p>
<ul>
<li><code>-d</code> (Set hvigor log level to debug).  </li>
<li><code>--stacktrace</code> (hvigor disables stack trace printing by default; add this option to enable it).<br><strong>Reference</strong>: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-commandline-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-commandline-V5</a></li>
</ul>
</li>
<li><p>Command-line compilation returns a status code:  </p>
<ul>
<li>Success: <code>code 0</code>.  </li>
<li>Failure: <code>code 1</code>.<br>Obtain the return code based on the specific platform.</li>
</ul>
</li>
</ol>
<h4 id="4-How-to-monitor-component-lifecycles-for-ordinary-objects-in-HarmonyOS"><a href="#4-How-to-monitor-component-lifecycles-for-ordinary-objects-in-HarmonyOS" class="headerlink" title="4. How to monitor component lifecycles for ordinary objects in HarmonyOS?"></a>4. How to monitor component lifecycles for ordinary objects in HarmonyOS?</h4><p>Refer to: <a target="_blank" rel="noopener" href="https://gitee.com/openharmony/docs/blob/7ad8e708cebd3e4a43979e97de160da9c0533316/zh-cn/application-dev/reference/apis/js-apis-arkui-observer.md">https://gitee.com/openharmony/docs/blob/7ad8e708cebd3e4a43979e97de160da9c0533316/zh-cn/application-dev/reference/apis/js-apis-arkui-observer.md</a>  </p>
<pre><code class="language-typescript">// entryability.ets
import window from &#39;@ohos.window&#39;;
import &#123; BusinessError &#125; from &#39;@ohos.base&#39;;


interface Data &#123;
  window: window.Window
&#125;

export default class EntryAbility extends UIAbility &#123;
  private window: window.Window | undefined = undefined
  onCreate(want: Want, launchParam: AbilityConstant.LaunchParam): void &#123;

    const that: EntryAbility = this
    this.context.eventHub.on(&quot;getWindow&quot;, (data: Data) =&gt; &#123;
      if (that.window != undefined) &#123;
        data.window = that.window
      &#125; else &#123;
        hilog.info(0x0000, &#39;testTag&#39;, &#39;%&#123;public&#125;s&#39;, &#39;that.subWindowStage == undefined&#39;);
      &#125;
    &#125;)
  &#125;

  onDestroy(): void &#123;
  &#125;

  onWindowStageCreate(windowStage: window.WindowStage): void &#123;
    // Main window is created, set main page for this ability
    hilog.info(0x0000, &#39;testTag&#39;, &#39;%&#123;public&#125;s&#39;, &#39;Ability onWindowStageCreate&#39;);


    windowStage.loadContent(&#39;pages/Index2&#39;, (err, data) =&gt; &#123;
      if (err.code) &#123;
        hilog.error(0x0000, &#39;testTag&#39;, &#39;Failed to load the content. Cause: %&#123;public&#125;s&#39;, JSON.stringify(err) ?? &#39;&#39;);
        return;
      &#125;
      hilog.info(0x0000, &#39;testTag&#39;, &#39;Succeeded in loading the content. Data: %&#123;public&#125;s&#39;, JSON.stringify(data) ?? &#39;&#39;);
      // Get the main window of the application.
      let windowClass: window.Window = window.findWindow(&quot;observer0&quot;);
      this.window = windowClass
      windowStage.getMainWindow((err: BusinessError, data) =&gt; &#123;
        let errCode: number = err.code;
        if (errCode) &#123;
          console.error(&#39;Failed to obtain the main window. Cause: &#39; + JSON.stringify(err));
          return;
        &#125;
      &#125;)
    &#125;);
  &#125;
  onWindowStageDestroy(): void &#123;
  &#125;
&#125;
// index2.ets
import common from &#39;@ohos.app.ability.common&#39;;
import window from &#39;@ohos.window&#39;;
import UIContext, &#123; UIObserver &#125; from &#39;@ohos.ArkUI.UIContext&#39;;
import observer from &#39;@ohos.ArkUI.observer&#39;;
import router from &#39;@ohos.router&#39;;

interface Data11 &#123;
  window: window.Window | null
&#125;

@Entry
@Component
struct Index2 &#123;
  private abilityContext: common.UIAbilityContext | null = null;
  private uiContext: UIContext.UIContext | null = null
  private context = getContext(this) as common.UIAbilityContext;

  testFunc(info: observer.RouterPageInfo) &#123;
    console.log(&quot;[testFunc][UI-in-Pages] called by: Index2: &quot; + `$&#123;info.index&#125;` + &quot;, name: &quot; + `$&#123;info.name&#125;` + &quot;, path: &quot; + `$&#123;info.path&#125;` + &quot;, state: &quot; + `$&#123;info.state&#125;` + &quot;,context: &quot; + `$&#123;info.context&#125;`);
  &#125;
  aboutToAppear() &#123;
    console.log(&quot;[Test] aboutToAppear before createWindow&quot;);
    this.abilityContext = getContext(this) as common.UIAbilityContext;
    let data: Data11 = &#123;
      window: null
    &#125;;
    this.abilityContext.eventHub.emit(&quot;getWindow&quot;, data);
    if (data.window) &#123;
      this.uiContext = data.window.getUIContext()
    &#125; else &#123;
      this.uiContext = null
    &#125;
    router.getState()
  &#125;
  build() &#123;
    Flex(&#123; direction: FlexDirection.Column, alignItems: ItemAlign.Center, justifyContent: FlexAlign.Center &#125;) &#123;
      Text(&#39;这是Index&#39;)
        .fontSize(20)
        .fontWeight(FontWeight.Bold)

      Button(&#39;ObserverOn&#39;)
        .margin(&#123; top: 5 &#125;)
        .onClick(() =&gt; &#123;
          let observer: UIObserver | null = this.uiContext ? this.uiContext.getUIObserver() : null
          if (observer) &#123;
            // Register router page monitoring within the current UIContext scope
            console.log(&quot;[Test] set observer to ON&quot;);
            observer.on(&#39;routerPageUpdate&#39;, this.testFunc)
          &#125;
        &#125;)
      Button(&#39;ObserverOff&#39;)
        .margin(&#123; top: 5 &#125;)
        .onClick(() =&gt; &#123;
          let observer: UIObserver | null = this.uiContext ? this.uiContext.getUIObserver() : null
          if (observer) &#123;
            // Register router page monitoring within the current UIContext scope
            console.log(&quot;[Test] set observer to OFF&quot;);
            observer.off(&#39;routerPageUpdate&#39;, this.testFunc)
          &#125;
        &#125;)

      Button(&#39;pushUrl PageOne&#39;)
        .margin(&#123; top: 5 &#125;)
        .onClick(() =&gt; &#123;
          router.pushUrl(&#123;
            url: &#39;pages/PageOne2&#39;,
          &#125;)
        &#125;)

    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;)
    .backgroundColor(&#39;#FFBFE5C5&#39;)
  &#125;
&#125;
// PageOne2.ets

@Entry
@Component
struct PageOne2 &#123;
  @State message: string = &#39;22222222222&#39;;

  build() &#123;
    Row() &#123;
      Column() &#123;
        Text(this.message)
          .fontSize(50)
          .fontWeight(FontWeight.Bold)
      &#125;
      .width(&#39;100%&#39;)
    &#125;
    .height(&#39;100%&#39;)
  &#125;
&#125;
</code></pre>
<h4 id="5-What-are-the-conditions-that-the-HarmonyOS-device-fingerprint-App-Market-listing-SDK-must-meet"><a href="#5-What-are-the-conditions-that-the-HarmonyOS-device-fingerprint-App-Market-listing-SDK-must-meet" class="headerlink" title="5. What are the conditions that the HarmonyOS device fingerprint App Market listing SDK must meet?"></a>5. What are the conditions that the HarmonyOS device fingerprint App Market listing SDK must meet?</h4><p>Requirements for listing the SDK on the App Market:  </p>
<ol>
<li>IDE version must be canary4sp1 or above.  </li>
<li>The signing certificate account and the listing SDK account must use an enterprise account to apply for a release certificate via AGC.<br><strong>IDE Signing Guide</strong>: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-publish-app-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-publish-app-V5</a><br><img src="/../images/%E3%80%90%E6%AF%8F%E6%97%A5%E5%AD%A6%E7%82%B9%E9%B8%BF%E8%92%99%E7%9F%A5%E8%AF%86%E3%80%9124.11.21.png"></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41122-Daily-HarmonyOS-Next-Knowledge-Attribute-Variable-Keys-Waterflow-Lag-Issues-Package-Upload-Failures-Video-Control-Playback-Vue-like-Syntax/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41122-Daily-HarmonyOS-Next-Knowledge-Attribute-Variable-Keys-Waterflow-Lag-Issues-Package-Upload-Failures-Video-Control-Playback-Vue-like-Syntax/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Attribute Variable Keys, Waterflow Lag Issues, Package Upload Failures, Video Control Playback, Vue-like Syntax</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:40:54 / Modified: 11:19:46" itemprop="dateCreated datePublished" datetime="2025-06-29T09:40:54+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Attribute-Variable-Keys-Waterflow-Lag-Issues-Package-Upload-Failures-Video-Control-Playback-Vue-like-Syntax"><a href="#Daily-HarmonyOS-Next-Knowledge-Attribute-Variable-Keys-Waterflow-Lag-Issues-Package-Upload-Failures-Video-Control-Playback-Vue-like-Syntax" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Attribute Variable Keys, Waterflow Lag Issues, Package Upload Failures, Video Control Playback, Vue-like Syntax"></a>[Daily HarmonyOS Next Knowledge] Attribute Variable Keys, Waterflow Lag Issues, Package Upload Failures, Video Control Playback, Vue-like Syntax</h1><h4 id="1-Can-HarmonyOS-attribute-variable-constants-be-used-as-keys-for-object-objects"><a href="#1-Can-HarmonyOS-attribute-variable-constants-be-used-as-keys-for-object-objects" class="headerlink" title="1. Can HarmonyOS attribute variable constants be used as keys for object objects?"></a>1. Can HarmonyOS attribute variable constants be used as keys for object objects?</h4><p><code>a: object = new Object() this.a[Constants.TEST_KEY] = &quot;456&quot;</code> can be defined first and then assigned.  </p>
<h4 id="2-Clicking-on-the-home-page-to-return-to-the-first-node-of-waterflow-rebuilds-all-nodes-from-0-to-index-causing-lag"><a href="#2-Clicking-on-the-home-page-to-return-to-the-first-node-of-waterflow-rebuilds-all-nodes-from-0-to-index-causing-lag" class="headerlink" title="2. Clicking on the home page to return to the first node of waterflow rebuilds all nodes from 0 to index, causing lag."></a>2. Clicking on the home page to return to the first node of waterflow rebuilds all nodes from 0 to index, causing lag.</h4><p>Using scrollTo recalculates the layout and triggers node reconstruction. Using scrollToIndex can solve this problem.  </p>
<h4 id="3-After-packaging-with-the-new-HarmonyOS-version-the-package-cannot-be-uploaded-remaining-stuck-in-“parsing”-and-then-failing-to-parse"><a href="#3-After-packaging-with-the-new-HarmonyOS-version-the-package-cannot-be-uploaded-remaining-stuck-in-“parsing”-and-then-failing-to-parse" class="headerlink" title="3. After packaging with the new HarmonyOS version, the package cannot be uploaded, remaining stuck in “parsing” and then failing to parse."></a>3. After packaging with the new HarmonyOS version, the package cannot be uploaded, remaining stuck in “parsing” and then failing to parse.</h4><p>This error occurs because the atomic service API call detection fails. Atomic services developed with API 11 and above can only call APIs within the “Atomic Service API Set”.<br>Reference: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-harmonyoserror-0000001651912985#section182629567266">https://developer.huawei.com/consumer/cn/doc/app/agc-help-harmonyoserror-0000001651912985#section182629567266</a><br>Check whether the atomic service package calls APIs outside the “Atomic Service API Set”, modify it, repackage, and upload again.<br>Atomic service APIs: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/atomic-references-V5/atomic-apis-intro-V5">https://developer.huawei.com/consumer/cn/doc/atomic-references-V5/atomic-apis-intro-V5</a>  </p>
<h4 id="4-After-placing-a-video-in-the-resource-directory-of-a-HarmonyOS-har-and-introducing-the-har-into-the-project-the-video-cannot-be-played-via-the-Video-control"><a href="#4-After-placing-a-video-in-the-resource-directory-of-a-HarmonyOS-har-and-introducing-the-har-into-the-project-the-video-cannot-be-played-via-the-Video-control" class="headerlink" title="4. After placing a video in the resource directory of a HarmonyOS har and introducing the har into the project, the video cannot be played via the Video control."></a>4. After placing a video in the resource directory of a HarmonyOS har and introducing the har into the project, the video cannot be played via the Video control.</h4><p>After obtaining resources from the har using getContext().resourceManager.getRawFileContentSync, it is found that the Video control does not support setting resources via byte streams, resulting in the inability to play videos in the har.<br>Reference: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-media-components-video-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-media-components-video-V5</a><br>Currently, byte stream playback is not supported; please directly pass in resources.<br>It is recommended to expose resources in the har as interface return values in the form of resource return values.  </p>
<h4 id="5-Is-there-a-method-in-HarmonyOS-similar-to-Vue’s-this-nextTick"><a href="#5-Is-there-a-method-in-HarmonyOS-similar-to-Vue’s-this-nextTick" class="headerlink" title="5. Is there a method in HarmonyOS similar to Vue’s this.$nextTick?"></a>5. Is there a method in HarmonyOS similar to Vue’s this.$nextTick?</h4><p>Is there a method similar to Vue’s this.$nextTick?  </p>
<pre><code>this.getUIContext().getUIInspector().createComponentObserver(&quot;Page13HelloWorld&quot;).on(&quot;draw&quot;, () =&gt; &#123;
  console.log(&quot;testTag - draw&quot;)
  let utils = this.getUIContext().getComponentUtils()
  let com = utils.getRectangleById(&quot;Page13HelloWorld&quot;)
  console.log(&quot;testTag - draw - height : &quot;+ com.size.height );
</code></pre>
<p>This interface can listen for component refreshes.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41123-Daily-HarmonyOS-Next-Knowledge-Component-Encapsulation-General-Methods-Performance-Comparison-Between-Callback-and-Await-Web-Component-Pull-Down-Refresh-HSP-Package-Error-WebView-Rounded-Corners/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41123-Daily-HarmonyOS-Next-Knowledge-Component-Encapsulation-General-Methods-Performance-Comparison-Between-Callback-and-Await-Web-Component-Pull-Down-Refresh-HSP-Package-Error-WebView-Rounded-Corners/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Component Encapsulation General Methods, Performance Comparison Between Callback and Await, Web Component Pull-Down Refresh, HSP Package Error, WebView Rounded Corners</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:39:59 / Modified: 09:40:25" itemprop="dateCreated datePublished" datetime="2025-06-29T09:39:59+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Component-Encapsulation-General-Methods-Performance-Comparison-Between-Callback-and-Await-Web-Component-Pull-Down-Refresh-HSP-Package-Error-WebView-Rounded-Corners"><a href="#Daily-HarmonyOS-Next-Knowledge-Component-Encapsulation-General-Methods-Performance-Comparison-Between-Callback-and-Await-Web-Component-Pull-Down-Refresh-HSP-Package-Error-WebView-Rounded-Corners" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Component Encapsulation General Methods, Performance Comparison Between Callback and Await, Web Component Pull-Down Refresh, HSP Package Error, WebView Rounded Corners"></a>[Daily HarmonyOS Next Knowledge] Component Encapsulation General Methods, Performance Comparison Between Callback and Await, Web Component Pull-Down Refresh, HSP Package Error, WebView Rounded Corners</h1><h4 id="1-How-to-encapsulate-common-attributes-and-methods-for-custom-components-in-HarmonyOS-similar-to-inheritance-in-Java"><a href="#1-How-to-encapsulate-common-attributes-and-methods-for-custom-components-in-HarmonyOS-similar-to-inheritance-in-Java" class="headerlink" title="1. How to encapsulate common attributes and methods for custom components in HarmonyOS, similar to inheritance in Java?"></a>1. How to encapsulate common attributes and methods for custom components in HarmonyOS, similar to inheritance in Java?</h4><pre><code class="language-typescript">export class Animal &#123;
  name: string;
  age: string;
  constructor(name: string, age: string) &#123;
    this.name = name;
    this.age = age;
  &#125;
&#125;

export class Person extends Animal &#123;
  reading: string;
  constructor(reading: string, name: string, age: string) &#123;
    super(name, age);
    this.reading = reading;
  &#125;
&#125;
</code></pre>
<h4 id="2-Which-performs-better-in-HarmonyOS-callback-or-await"><a href="#2-Which-performs-better-in-HarmonyOS-callback-or-await" class="headerlink" title="2. Which performs better in HarmonyOS, callback or await?"></a>2. Which performs better in HarmonyOS, callback or await?</h4><p><strong>1. Callback Functions</strong>  </p>
<ul>
<li><strong>Advantages</strong>: Solve synchronization issues (long-running tasks no longer block subsequent tasks, improving overall program execution efficiency).  </li>
<li><strong>Disadvantages</strong>: Nested callbacks lead to “callback hell,” increasing code coupling and reducing maintainability. Errors cannot be caught with <code>try-catch</code>, and <code>return</code> statements do not work as expected.</li>
</ul>
<p><strong>2. Promise</strong>  </p>
<ul>
<li><strong>Advantages</strong>: Chain callbacks to avoid callback hell.  </li>
<li><strong>Disadvantages</strong>: Cannot cancel a Promise once initiated. Errors must be handled via <code>.catch()</code>.</li>
</ul>
<p><strong>3. Async&#x2F;Await</strong><br>Async functions are syntactic sugar built on generators and Promises, with an automatic executor. When encountering an <code>await</code> statement, the function pauses until the Promise resolves. This allows writing asynchronous logic in a synchronous style.  </p>
<ul>
<li><strong>Advantages</strong>: Cleaner code structure, eliminates callback hell.  </li>
<li><strong>Disadvantages</strong>: <code>await</code> forces asynchronous operations to execute sequentially. Using <code>await</code> for independent operations may degrade performance.</li>
</ul>
<h4 id="3-How-to-add-pull-down-refresh-to-a-HarmonyOS-Web-component"><a href="#3-How-to-add-pull-down-refresh-to-a-HarmonyOS-Web-component" class="headerlink" title="3. How to add pull-down refresh to a HarmonyOS Web component?"></a>3. How to add pull-down refresh to a HarmonyOS Web component?</h4><p>Refer to the following demo:  </p>
<pre><code class="language-typescript">import web_webview from &#39;@ohos.web.webview&#39;;
import &#123; PullToRefresh &#125; from &#39;@ohos/pulltorefresh&#39;;

@Entry
@Component
struct WebPage &#123;
  controller: web_webview.WebviewController = new web_webview.WebviewController();
  @State dataArray: Array&lt;string&gt; = [];
  private scroller: Scroller = new Scroller();

  @Builder
  getContentView() &#123;
    Column() &#123;
      Web(&#123; src: &#39;http://www.huawei.com&#39;, controller: this.controller &#125;)
    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;);
  &#125;

  build() &#123;
    Scroll(this.scroller) &#123;
      PullToRefresh(&#123;
        // Required: Data bound to the list component (pass empty array if not using a list)
        data: $dataArray,
        // Required: Scroller for the main layout
        scroller: this.scroller,
        // Required: Custom main layout
        customList: () =&gt; &#123;
          // A UI method decorated with @Builder where the Web component is defined
          this.getContentView();
        &#125;,
        // Optional: Pull-down refresh callback
        onRefresh: () =&gt; &#123;
          return new Promise&lt;string&gt;((resolve, reject) =&gt; &#123;
            setTimeout(() =&gt; &#123;
              resolve(&#39;&#39;);
              // this.controller.loadUrl(&#39;https://www.huawei.com&#39;);
            &#125;, 1000);
          &#125;);
        &#125;,
      &#125;)
      .width(&#39;100%&#39;)
      .height(&#39;100%&#39;);
    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;);
  &#125;
&#125;
</code></pre>
<h4 id="4-When-depending-on-an-HSP-package-it-works-fine-with-the-debug-version-but-fails-with-“versionname-mismatch”-in-the-release-version"><a href="#4-When-depending-on-an-HSP-package-it-works-fine-with-the-debug-version-but-fails-with-“versionname-mismatch”-in-the-release-version" class="headerlink" title="4. When depending on an HSP package, it works fine with the debug version but fails with “versionname mismatch” in the release version."></a>4. When depending on an HSP package, it works fine with the debug version but fails with “versionname mismatch” in the release version.</h4><p>Ensure the <code>versionname</code> and <code>releaseType</code> of the HSP package exactly match those of the HAP.<br>Reference: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/in-app-hsp-V5#restrictions">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/in-app-hsp-V5#restrictions</a>  </p>
<h4 id="5-Rounded-corners-on-a-HarmonyOS-WebView-do-not-take-effect"><a href="#5-Rounded-corners-on-a-HarmonyOS-WebView-do-not-take-effect" class="headerlink" title="5. Rounded corners on a HarmonyOS WebView do not take effect."></a>5. Rounded corners on a HarmonyOS WebView do not take effect.</h4><p>In some scenarios, setting rounded corners (e.g., top-left and top-right) for a Web component may not work when it is not displayed full-screen. The following demo demonstrates this issue:  </p>
<pre><code class="language-typescript">import web_webview from &#39;@ohos.web.webview&#39;;
import business_error from &#39;@ohos.base&#39;;

@Entry
@Component
struct Page2 &#123;
  controller: web_webview.WebviewController = new web_webview.WebviewController();
  @State progress: number = 0;
  @State src: string = &#39;https://www.huawei.com/u/bmmain/helpsale/evaluate?random=1000&amp;channel=BM_0933&amp;needHideHead=3&amp;cateId=101&amp;type=B&amp;plainSceneId=B2COld2New&amp;modelId=125986&amp;brandId=10532&amp;modelName=%E5%8D%8E%E4%B8%BA%20Mate%2060%20Pro&amp;skip2NextUrl=https%3A%2F%2Fm.zhuanzhuan.com%2Fzlj%2Fold_for_new_service_h5%2Fvaluation%3FneedHideHead%3D3%26needNewWebview%3D1%26serviceIds%3D%26productId%3D1779861808894005248%26metric%3D%26from%3Dc2b%26isUserEval%3D1&#39;;

  build() &#123;
    Column() &#123;
      Row().height(&#39;30%&#39;);
      Stack() &#123;
        Web(&#123; src: this.src, controller: this.controller &#125;)
          .borderRadius(&#123; topLeft: 100, topRight: 100, bottomLeft: 0, bottomRight: 0 &#125;)
          .javaScriptAccess(true)
          .domStorageAccess(true)
          .onProgressChange((event) =&gt; &#123;
            this.progress = event?.newProgress || 0;
            // console.log(`progress: $&#123;this.progress&#125;`);
          &#125;)
          .height(&#39;100%&#39;);
        Column(&#123; space: 20 &#125;) &#123;
          Text(`progress: $&#123;this.progress&#125;`).fontSize(30).fontColor(Color.Black);
          Button(&#39;loadUrl&#39;)
            .onClick(() =&gt; &#123;
              try &#123;
                this.controller.setCustomUserAgent(&quot;zzVersion/8.18.20 zzT/16 zzDevice/1_44.0_3.0 zzApp/58ZhuanZhuan&quot;);
                const customUa = this.controller.getCustomUserAgent();
                const ua = this.controller.getUserAgent();
                console.log(`customUa: $&#123;customUa&#125;, ua: $&#123;ua&#125;`);
              &#125; catch (error) &#123;
                let e: business_error.BusinessError = error as business_error.BusinessError;
                console.error(`ErrorCode: $&#123;e.code&#125;,  Message: $&#123;e.message&#125;`);
              &#125;
            &#125;);
        &#125;
      &#125;
      .height(&#39;70%&#39;);
    &#125;.backgroundColor(Color.Black);
  &#125;
&#125;
</code></pre>
<p><strong>Solution</strong>: Set <code>clip</code> to <code>true</code>.<br>Reference: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-attributes-sharp-clipping-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-universal-attributes-sharp-clipping-V5</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41124-Daily-HarmonyOS-Next-Knowledge-PersistentStorage-Persistence-Slot-Methods-Relative-Layout-Pull-to-Load-and-Pull-to-Refresh-List-Linked-Sliding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41124-Daily-HarmonyOS-Next-Knowledge-PersistentStorage-Persistence-Slot-Methods-Relative-Layout-Pull-to-Load-and-Pull-to-Refresh-List-Linked-Sliding/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] PersistentStorage Persistence, Slot Methods, Relative Layout, Pull-to-Load and Pull-to-Refresh, List Linked Sliding</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:37:44 / Modified: 09:38:31" itemprop="dateCreated datePublished" datetime="2025-06-29T09:37:44+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-PersistentStorage-Persistence-Slot-Methods-Relative-Layout-Pull-to-Load-and-Pull-to-Refresh-List-Linked-Sliding"><a href="#Daily-HarmonyOS-Next-Knowledge-PersistentStorage-Persistence-Slot-Methods-Relative-Layout-Pull-to-Load-and-Pull-to-Refresh-List-Linked-Sliding" class="headerlink" title="[Daily HarmonyOS Next Knowledge] PersistentStorage Persistence, Slot Methods, Relative Layout, Pull-to-Load and Pull-to-Refresh, List Linked Sliding"></a>[Daily HarmonyOS Next Knowledge] PersistentStorage Persistence, Slot Methods, Relative Layout, Pull-to-Load and Pull-to-Refresh, List Linked Sliding</h1><h4 id="1-Why-is-PersistentStorage-persistence-of-user-information-invalid-in-HarmonyOS"><a href="#1-Why-is-PersistentStorage-persistence-of-user-information-invalid-in-HarmonyOS" class="headerlink" title="1. Why is PersistentStorage persistence of user information invalid in HarmonyOS?"></a>1. Why is PersistentStorage persistence of user information invalid in HarmonyOS?</h4><p>When obtaining user information on the home page via <code>@StorageLink(&#39;userInfoTest&#39;) userInfoTest: string = &#39;&#39;</code>, it returns <code>undefined</code>. What is the reason?  </p>
<p>First, declare <code>PersistentStorage.persistProp</code> outside the <code>@Entry</code> on the home page. Second, when setting the value after login, use <code>AppStorage.set</code> instead of <code>PersistentStorage.persistProp</code> to modify the value. Take <code>userInfo</code> as an example:  </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">PersistentStorage</span>.<span class="title function_">persistProp</span>(<span class="string">&#x27;userInfo&#x27;</span>, <span class="string">&quot;111&quot;</span>) <span class="comment">// Can be directly placed below the import code. This example only uses userInfo; each property requiring persistent storage needs to be declared.</span></span><br><span class="line"><span class="comment">// The value set during declaration can be arbitrary and modified via set later. Try to keep the property consistent with the target value.</span></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&quot;Click to test&quot;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Testing set&quot;</span>)</span><br><span class="line">        <span class="title class_">AppStorage</span>.<span class="title function_">set</span>(<span class="string">&#x27;userInfo&#x27;</span>, <span class="string">&quot;ceshi&quot;</span>) <span class="comment">// Use AppStorage.set directly instead of PersistentStorage.persistProp; otherwise, modification will fail.</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&quot;Find userInfo&quot;</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> ut = <span class="title class_">AppStorage</span>.<span class="property">get</span>&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ut); <span class="comment">// The test result shows the value in userInfo becomes &quot;ceshi&quot;. After killing the process and re-entering, clicking the button directly logs &quot;ceshi&quot;, achieving persistent storage.</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 2. Does HarmonyOS have slot usage methods like Vue?  </span></span><br><span class="line"><span class="string">The `</span><span class="meta">@BuilderParam</span><span class="string">` decorator can be used, which declares an element for any UI description, similar to a slot placeholder.  </span></span><br><span class="line"><span class="string">Reference link: https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-builderparam-V5  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 3. For HarmonyOS RelativeContainer, can the anchor position coordinates set by offset not be used as anchors, and only the old coordinates without offset configuration can be used as anchors for calibrating the next component?  </span></span><br><span class="line"><span class="string">For example, if component A has its position configured via an anchor (with coordinate `</span>pos1<span class="string">`) and an offset sets a new position `</span>pos2<span class="string">`, component B must include the offset of component A to calibrate based on `</span>pos2<span class="string">`.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Take the following three components as an example: The desired effect is a 13-unit gap between &quot;Personal Information&quot; and &quot;Age&quot;, and between &quot;Gender&quot; and &quot;Age&quot;. However, the actual gap between the three components is 0.  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="title class_">Row</span>() &#123;</span><br><span class="line">  <span class="title class_">Text</span>(<span class="string">&#x27;Personal Information&#x27;</span>)</span><br><span class="line">    .<span class="title function_">fontColor</span>(<span class="title class_">Color</span>.<span class="property">White</span>)</span><br><span class="line">    .<span class="title function_">fontSize</span>(<span class="number">14</span>)</span><br><span class="line">    .<span class="title function_">alignRules</span>(&#123;</span><br><span class="line">      <span class="attr">left</span>: &#123; <span class="attr">anchor</span>: <span class="string">&#x27;row1&#x27;</span>, <span class="attr">align</span>: <span class="title class_">HorizontalAlign</span>.<span class="property">Start</span> &#125;,</span><br><span class="line">      <span class="attr">center</span>: &#123; <span class="attr">anchor</span>: <span class="string">&#x27;row1&#x27;</span>, <span class="attr">align</span>: <span class="title class_">VerticalAlign</span>.<span class="property">Center</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">offset</span>(&#123;</span><br><span class="line">      <span class="attr">x</span>: <span class="number">13</span>,</span><br><span class="line">      <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">id</span>(<span class="string">&quot;person_info_text&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="title class_">Button</span>(<span class="string">&#x27;Age&#x27;</span>)</span><br><span class="line">    .<span class="title function_">fontSize</span>(<span class="number">12</span>)</span><br><span class="line">    .<span class="title function_">aspectRatio</span>(<span class="number">1.857</span>)</span><br><span class="line">    .<span class="title function_">alignRules</span>(&#123;</span><br><span class="line">      <span class="attr">left</span>: &#123; <span class="attr">anchor</span>: <span class="string">&quot;person_info_text&quot;</span>, <span class="attr">align</span>: <span class="title class_">HorizontalAlign</span>.<span class="property">End</span> &#125;,</span><br><span class="line">      <span class="attr">center</span>: &#123; <span class="attr">anchor</span>: <span class="string">&#x27;row1&#x27;</span>, <span class="attr">align</span>: <span class="title class_">VerticalAlign</span>.<span class="property">Center</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">offset</span>(&#123;</span><br><span class="line">      <span class="attr">x</span>: <span class="number">13</span>,</span><br><span class="line">      <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">id</span>(<span class="string">&quot;age_btn&quot;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="title class_">Button</span>(<span class="string">&#x27;Gender&#x27;</span>)</span><br><span class="line">    .<span class="title function_">fontSize</span>(<span class="number">12</span>)</span><br><span class="line">    .<span class="title function_">aspectRatio</span>(<span class="number">1.857</span>)</span><br><span class="line">    .<span class="title function_">alignRules</span>(&#123;</span><br><span class="line">      <span class="attr">left</span>: &#123; <span class="attr">anchor</span>: <span class="string">&quot;age_btn&quot;</span>, <span class="attr">align</span>: <span class="title class_">HorizontalAlign</span>.<span class="property">End</span> &#125;,</span><br><span class="line">      <span class="attr">center</span>: &#123; <span class="attr">anchor</span>: <span class="string">&#x27;row1&#x27;</span>, <span class="attr">align</span>: <span class="title class_">VerticalAlign</span>.<span class="property">Center</span> &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">offset</span>(&#123;</span><br><span class="line">      <span class="attr">x</span>: <span class="number">13</span>,</span><br><span class="line">      <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">id</span>(<span class="string">&quot;gender_btn&quot;</span>)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The anchor position set by `</span><span class="title class_">RelativeContainer</span><span class="string">` via `</span>offset<span class="string">` remains the original position before offset. Therefore, subsequent components reference the pre-offset position. To achieve the desired effect, set the offset as follows:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line">.<span class="title function_">offset</span>(&#123;</span><br><span class="line">  <span class="attr">x</span>: <span class="number">13</span>,</span><br><span class="line">  <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">offset</span>(&#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">26</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">offset</span>(&#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">39</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 4. Are there any pre-encapsulated controls for pull-to-load and pull-to-refresh in HarmonyOS?  </span></span><br><span class="line"><span class="string">Writing data requests in `</span>listTouchEvent<span class="string">` is too coupled. A pre-encapsulated component is needed to expose the pull-to-refresh and pull-to-load layout for user configuration, along with event listening.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="title class_">PullToRefresh</span><span class="string">` is a usable component for pull-to-refresh and pull-to-load.  </span></span><br><span class="line"><span class="string">Reference link: https://gitee.com/openharmony-sig/ohos_pull_to_refresh  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Demo:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">PullToRefresh</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@ohos/pulltorefresh&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">refreshText</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">dataNumbers</span>: <span class="built_in">string</span>[] = [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;10&#x27;</span>];</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">dataStrings</span>: <span class="built_in">string</span>[] =</span><br><span class="line">    [<span class="string">&#x27;My Comments&#x27;</span>, <span class="string">&#x27;Related to Me&#x27;</span>, <span class="string">&#x27;Personal Center 1&#x27;</span>, <span class="string">&#x27;Personal Center 2&#x27;</span>, <span class="string">&#x27;Personal Center 3&#x27;</span>, <span class="string">&#x27;My Posts&#x27;</span>, <span class="string">&#x27;Settings&#x27;</span>, <span class="string">&#x27;Logout&#x27;</span>];</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">data</span>: <span class="built_in">string</span>[] = <span class="variable language_">this</span>.<span class="property">dataStrings</span>;</span><br><span class="line">  <span class="comment">// List or grid component must be bound</span></span><br><span class="line">  <span class="keyword">private</span> <span class="attr">scroller</span>: <span class="title class_">Scroller</span> = <span class="keyword">new</span> <span class="title class_">Scroller</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">PullToRefresh</span>(&#123;</span><br><span class="line">        <span class="comment">// Required: Data bound to the list component</span></span><br><span class="line">        <span class="attr">data</span>: $data,</span><br><span class="line">        <span class="comment">// Required: Scroller bound to the list or grid component in the main layout</span></span><br><span class="line">        <span class="attr">scroller</span>: <span class="variable language_">this</span>.<span class="property">scroller</span>,</span><br><span class="line">        <span class="comment">// Required: Custom main layout with list or grid component inside</span></span><br><span class="line">        <span class="attr">customList</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// A UI method decorated with @Builder</span></span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">getListView</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// Optional: Pull-to-refresh callback</span></span><br><span class="line">        <span class="attr">onRefresh</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// Simulate network request: After 2 seconds, resolve and update list data</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="title function_">resolve</span>(<span class="string">&#x27;Refresh successful&#x27;</span>);</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">data</span> = <span class="variable language_">this</span>.<span class="property">dataNumbers</span>;</span><br><span class="line">            &#125;, <span class="number">2000</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// Optional: Pull-to-load-more callback</span></span><br><span class="line">        <span class="attr">onLoadMore</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>&lt;<span class="built_in">string</span>&gt;(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// Simulate network request: After 2 seconds, resolve and append data to the list</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="title function_">resolve</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">data</span>.<span class="title function_">push</span>(<span class="string">&quot;Added item &quot;</span> + <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">length</span>);</span><br><span class="line">            &#125;, <span class="number">2000</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">customLoad</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">customRefresh</span>: <span class="literal">null</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Builder</span></span><br><span class="line">  <span class="keyword">private</span> <span class="title function_">getListView</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">List</span>(&#123; <span class="attr">space</span>: <span class="number">20</span>, <span class="attr">scroller</span>: <span class="variable language_">this</span>.<span class="property">scroller</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">data</span>, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">ListItem</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(item)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">160</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">150</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">20</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Center</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="string">&#x27;#95efd2&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="string">&#x27;#eeeeee&#x27;</span>)</span><br><span class="line">    .<span class="title function_">divider</span>(&#123; <span class="attr">strokeWidth</span>: <span class="number">1</span>, <span class="attr">color</span>: <span class="number">0x222222</span> &#125;)</span><br><span class="line">    .<span class="title function_">edgeEffect</span>(<span class="title class_">EdgeEffect</span>.<span class="property">None</span>) <span class="comment">// Must set no edge effect for scrolling</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### 5. How to achieve linked sliding for Lists in HarmonyOS?  </span></span><br><span class="line"><span class="string">A page requires two linked Lists, with the first List needing to stick to the top. However, using `</span><span class="title class_">ListItemGroup</span><span class="string">` for the sticky effect causes the index to behave as described in the API documentation: `</span><span class="title class_">ListItemGroup</span><span class="string">` calculates an index as a whole, and `</span><span class="title class_">ListItem</span><span class="string">` inside it does not calculate an index. This breaks the linked sliding based on indices between the two Lists.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Demo example:  </span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>typescript</span><br><span class="line"><span class="comment">// Top product categories</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">CategoriesType</span> &#123;</span><br><span class="line">  <span class="attr">current</span>: <span class="built_in">string</span>[],</span><br><span class="line">  <span class="attr">hot</span>: <span class="built_in">string</span>[],</span><br><span class="line">  <span class="title class_">Categories</span>: <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">Category</span>[]&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Category</span> &#123;</span><br><span class="line">  <span class="attr">code</span>: <span class="built_in">string</span>;</span><br><span class="line">  <span class="attr">category</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> struct <span class="title class_">CityList</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">currentCategory</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">private</span> <span class="attr">hotCategories</span>: <span class="built_in">string</span>[] = []</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">groupCategories</span>: <span class="title class_">Map</span>&lt;<span class="built_in">string</span>, <span class="title class_">Category</span>[]&gt; = <span class="keyword">new</span> <span class="title class_">Map</span></span><br><span class="line">  <span class="keyword">private</span> <span class="attr">groupNameList</span>: <span class="built_in">string</span>[] = [<span class="string">&#x27;Area A&#x27;</span>, <span class="string">&#x27;Area B&#x27;</span>, <span class="string">&#x27;Area C&#x27;</span>, <span class="string">&#x27;Area D&#x27;</span>, <span class="string">&#x27;Area F&#x27;</span>, <span class="string">&#x27;Area G&#x27;</span>, <span class="string">&#x27;Area H&#x27;</span>, <span class="string">&#x27;Area J&#x27;</span>, <span class="string">&#x27;Area K&#x27;</span>, <span class="string">&#x27;Area L&#x27;</span>]</span><br><span class="line">  <span class="meta">@State</span> <span class="keyword">private</span> <span class="attr">selectGroupIndex</span>: <span class="built_in">number</span> = -<span class="number">1</span></span><br><span class="line">  <span class="keyword">private</span> <span class="attr">categoryScroller</span>: <span class="title class_">ListScroller</span> = <span class="keyword">new</span> <span class="title class_">ListScroller</span>()</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">categoryScroller1</span>: <span class="title class_">ListScroller</span> = <span class="keyword">new</span> <span class="title class_">ListScroller</span>()</span><br><span class="line">  <span class="keyword">private</span> <span class="attr">isClickScroll</span>: <span class="built_in">boolean</span> = <span class="literal">false</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">jsonString</span>: <span class="built_in">string</span> = <span class="string">&#x27;&#123;&quot;current&quot;:[&quot;Health Products Zone&quot;],&quot;hot&quot;:[&quot;Insurance Type Conversion&quot;,&quot;Policy Loss Report&quot;,&quot;Policy Replacement&quot;],&quot;Categories&quot;:&#123;&quot;A区&quot;:[&#123;&quot;code&quot;:&quot;001&quot;,&quot;category&quot;:&quot;Add Additional Insurance&quot;&#125;,&#123;&quot;code&quot;:&quot;002&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;003&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;004&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;005&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;006&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;,&#123;&quot;code&quot;:&quot;007&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 6&quot;&#125;],&quot;B区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;],&quot;C区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;D区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;E区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;F区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;G区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;H区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;J区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;K区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;],&quot;L区&quot;:[&#123;&quot;code&quot;:&quot;008&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 1&quot;&#125;,&#123;&quot;code&quot;:&quot;009&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 2&quot;&#125;,&#123;&quot;code&quot;:&quot;010&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 3&quot;&#125;,&#123;&quot;code&quot;:&quot;011&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 4&quot;&#125;,&#123;&quot;code&quot;:&quot;012&quot;,&quot;category&quot;:&quot;Insurance Reinstatement 5&quot;&#125;]&#125;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">let</span> <span class="attr">data</span>: <span class="title class_">CategoriesType</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonString) <span class="keyword">as</span> <span class="title class_">CategoriesType</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">currentCategory</span> = data.<span class="property">current</span>[<span class="number">0</span>]</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">hotCategories</span> = data.<span class="property">hot</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">groupCategories</span> = data.<span class="property">Categories</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fxm = &#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>.<span class="property">groupCategories</span>[<span class="string">&#x27;A区&#x27;</span>]))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Row</span>() &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">navigationList</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">      .<span class="title function_">height</span>(<span class="number">42</span>)</span><br><span class="line">      <span class="title class_">Column</span>() &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">categoryList</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getCitiesWithGroupName</span>(<span class="attr">name</span>: <span class="built_in">string</span>): <span class="title class_">Category</span>[] &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;fxm &#x27;</span>, <span class="variable language_">this</span>.<span class="property">groupCategories</span>[name])</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">groupCategories</span>[name]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Builder</span></span><br><span class="line">  <span class="title function_">itemHead</span>(<span class="params"><span class="attr">text</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="title class_">Text</span>(text)</span><br><span class="line">      .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">      .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">      .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">10</span> &#125;)</span><br><span class="line">      .<span class="title function_">height</span>(<span class="number">45</span>)</span><br><span class="line">      .<span class="title function_">backgroundColor</span>(<span class="number">0xEEEEEE</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Builder</span></span><br><span class="line">  <span class="title function_">categoryList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">List</span>(&#123; <span class="attr">scroller</span>: <span class="variable language_">this</span>.<span class="property">categoryScroller</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">ListItemGroup</span>(&#123; <span class="attr">header</span>: <span class="variable language_">this</span>.<span class="title function_">itemHead</span>(<span class="string">&#x27;Current Zone&#x27;</span>) &#125;) &#123;</span><br><span class="line">        <span class="title class_">ListItem</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">currentCategory</span>)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">45</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(<span class="number">0xFFFFFF</span>)</span><br><span class="line">            .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">10</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="title class_">ListItemGroup</span>(&#123; <span class="attr">header</span>: <span class="variable language_">this</span>.<span class="title function_">itemHead</span>(<span class="string">&#x27;Hot Zones&#x27;</span>) &#125;) &#123;</span><br><span class="line">        <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">hotCategories</span>, <span class="function">(<span class="params"><span class="attr">hotCategory</span>: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="title class_">ListItem</span>() &#123;</span><br><span class="line">            <span class="title class_">Text</span>(hotCategory)</span><br><span class="line">              .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">              .<span class="title function_">height</span>(<span class="number">45</span>)</span><br><span class="line">              .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">              .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>)</span><br><span class="line">              .<span class="title function_">backgroundColor</span>(<span class="number">0xFFFFFF</span>)</span><br><span class="line">              .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">10</span> &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Grouping for Areas A~L</span></span><br><span class="line">      <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">groupNameList</span>, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">ListItemGroup</span>(&#123; <span class="attr">header</span>: <span class="variable language_">this</span>.<span class="title function_">itemHead</span>(item) &#125;) &#123;</span><br><span class="line">          <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="title function_">getCitiesWithGroupName</span>(item), <span class="function">(<span class="params"><span class="attr">item</span>: <span class="title class_">Category</span></span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="title class_">ListItem</span>() &#123;</span><br><span class="line">              <span class="title class_">Text</span>(item.<span class="property">category</span>)</span><br><span class="line">                .<span class="title function_">width</span>(<span class="string">&quot;100%&quot;</span>)</span><br><span class="line">                .<span class="title function_">height</span>(<span class="number">45</span>)</span><br><span class="line">                .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">                .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>)</span><br><span class="line">                .<span class="title function_">backgroundColor</span>(<span class="number">0xFFFFFF</span>)</span><br><span class="line">                .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">10</span> &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="title class_">Category</span></span>) =&gt;</span> item.<span class="property">category</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">scrollBar</span>(<span class="title class_">BarState</span>.<span class="property">Off</span>)</span><br><span class="line">    .<span class="title function_">sticky</span>(<span class="title class_">StickyStyle</span>.<span class="property">Header</span>)</span><br><span class="line">    .<span class="title function_">onTouch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// When the category list is touched to scroll, set isClickScroll to false to prevent scrolling conflicts with the navigation list</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">isClickScroll</span> = <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">onScrollIndex</span>(<span class="function">(<span class="params"><span class="attr">start</span>: <span class="built_in">number</span>, <span class="attr">end</span>: <span class="built_in">number</span>, <span class="attr">center</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//联动控制导航列表选中状态 via selectGroupIndex state variable and start</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isClickScroll</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">selectGroupIndex</span> = start - <span class="number">2</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Builder</span></span><br><span class="line">  <span class="title function_">navigationList</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">List</span>(&#123; <span class="attr">scroller</span>: <span class="variable language_">this</span>.<span class="property">categoryScroller1</span> &#125;) &#123;</span><br><span class="line">      <span class="title class_">ForEach</span>(<span class="variable language_">this</span>.<span class="property">groupNameList</span>, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="built_in">string</span>, <span class="attr">index</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title class_">ListItem</span>() &#123;</span><br><span class="line">          <span class="title class_">Text</span>(item)</span><br><span class="line">            .<span class="title function_">width</span>(<span class="number">42</span>)</span><br><span class="line">            .<span class="title function_">height</span>(<span class="number">30</span>)</span><br><span class="line">            .<span class="title function_">fontSize</span>(<span class="number">16</span>)</span><br><span class="line">            .<span class="title function_">textAlign</span>(<span class="title class_">TextAlign</span>.<span class="property">Start</span>)</span><br><span class="line">            .<span class="title function_">backgroundColor</span>(index == <span class="variable language_">this</span>.<span class="property">selectGroupIndex</span> ? <span class="number">0xCCCCCC</span> : <span class="title class_">Color</span>.<span class="property">Transparent</span>)</span><br><span class="line">            .<span class="title function_">padding</span>(&#123; <span class="attr">left</span>: <span class="number">10</span> &#125;)</span><br><span class="line">            .<span class="title function_">borderRadius</span>(<span class="number">15</span>)</span><br><span class="line">            .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">              <span class="comment">// When the navigation list is selected, set isClickScroll to true to prevent the category list from driving state changes during scrolling</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">isClickScroll</span> = <span class="literal">true</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">selectGroupIndex</span> = index</span><br><span class="line">              <span class="comment">// Control the category list to scroll to the corresponding position via selectGroupIndex and Scroller</span></span><br><span class="line">              <span class="variable language_">this</span>.<span class="property">categoryScroller</span>.<span class="title function_">scrollToIndex</span>(index + <span class="number">2</span>, <span class="literal">true</span>, <span class="title class_">ScrollAlign</span>.<span class="property">START</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="function">(<span class="params"><span class="attr">item</span>: <span class="built_in">string</span></span>) =&gt;</span> item)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">listDirection</span>(<span class="title class_">Axis</span>.<span class="property">Horizontal</span>)</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Transparent</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41125-Daily-HarmonyOS-Next-Knowledge-Initializing-BigInt-Package-Size-Optimization-Tabs-Nested-in-Grid-Aging-Adaptation-Release-Packaging-Failure/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41125-Daily-HarmonyOS-Next-Knowledge-Initializing-BigInt-Package-Size-Optimization-Tabs-Nested-in-Grid-Aging-Adaptation-Release-Packaging-Failure/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Initializing BigInt, Package Size Optimization, Tabs Nested in Grid, Aging Adaptation, Release Packaging Failure</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:36:36 / Modified: 09:37:15" itemprop="dateCreated datePublished" datetime="2025-06-29T09:36:36+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Initializing-BigInt-Package-Size-Optimization-Tabs-Nested-in-Grid-Aging-Adaptation-Release-Packaging-Failure"><a href="#Daily-HarmonyOS-Next-Knowledge-Initializing-BigInt-Package-Size-Optimization-Tabs-Nested-in-Grid-Aging-Adaptation-Release-Packaging-Failure" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Initializing BigInt, Package Size Optimization, Tabs Nested in Grid, Aging Adaptation, Release Packaging Failure"></a>[Daily HarmonyOS Next Knowledge] Initializing BigInt, Package Size Optimization, Tabs Nested in Grid, Aging Adaptation, Release Packaging Failure</h1><h4 id="1-How-to-initialize-a-BigInt-type-property-in-a-class-in-HarmonyOS"><a href="#1-How-to-initialize-a-BigInt-type-property-in-a-class-in-HarmonyOS" class="headerlink" title="1. How to initialize a BigInt type property in a class in HarmonyOS?"></a>1. How to initialize a BigInt type property in a class in HarmonyOS?</h4><p>BigInt can be initialized using the keyword, for example:  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line">let a = BigInt(1); let b = BigInt(&quot;2&quot;); </span><br><span class="line">```  </span><br><span class="line">Example of mutual conversion between Uint8Array and string:  </span><br><span class="line">```typescript</span><br><span class="line">// String to Uint8Array  </span><br><span class="line">let text1 = &quot;hello world&quot;;</span><br><span class="line">let buf = new ArrayBuffer(text1.length * 2);</span><br><span class="line">let uint8 = new Uint8Array(buf);</span><br><span class="line">for (let i = 0; i &lt; text1.length; i++) &#123;</span><br><span class="line">  uint8[i] = text1.charCodeAt(i);</span><br><span class="line">&#125;</span><br><span class="line">console.log(&#x27;uint8----&#x27;, uint8);</span><br><span class="line"></span><br><span class="line">// Uint8Array to string  </span><br><span class="line">let spArray = uint8.slice(0, 3);</span><br><span class="line">let dataString = &#x27;&#x27;;</span><br><span class="line">for (let i = 0; i &lt; spArray.length; i++) &#123;</span><br><span class="line">  dataString += String.fromCharCode(spArray[i]);</span><br><span class="line">&#125;</span><br><span class="line">console.log(&#x27;dataString-----&#x27;, dataString);</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 2. Can the same so be merged when packaging final apps for different haps? Reduce package size due to duplicate so files.  </span><br><span class="line">Reducing the app package size is crucial for improving download and installation experience. Compressing, streamlining, or reusing code/resources in the app can effectively reduce its size, enhance download/installation speed, and minimize system space occupation.  </span><br><span class="line"></span><br><span class="line">Developers can refer to the following three methods to reduce the app package size:  </span><br><span class="line"></span><br><span class="line">##### Configure so compression options  </span><br><span class="line">By compressing so libraries, the app package size can be reduced. In scenarios with multiple packages (HAP, HSP), use HSP (Harmony Shared Package) to dynamically share code/resources among multiple packages, eliminating duplicate copies caused by HAR (Harmony Archive) static shared packages.  </span><br><span class="line"></span><br><span class="line">**Configuration method**: https://gitee.com/openharmony/docs/blob/master/zh-cn/application-dev/quick-start/module-configuration-file.md  </span><br><span class="line">Modify the `compressNativeLibs` field in the module configuration file `module.json5` to `true`:  </span><br><span class="line">```json5</span><br><span class="line">&#123;</span><br><span class="line">  &quot;module&quot;: &#123;</span><br><span class="line">    // ...</span><br><span class="line">    &quot;compressNativeLibs&quot;: true // Indicate that libs should be packaged in compressed form</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line">##### So compression effect  </span><br><span class="line">Taking the default C++ library in DevEco Studio as an example, the size comparison before/after compression is as follows:  </span><br><span class="line">| File Name | Original Size | Compressed Size | Compression Rate |  </span><br><span class="line">|-----------|---------------|-----------------|------------------|  </span><br><span class="line">| armeabi-v7a/libc++_shared.so | 1,108k | 386k | 34% |  </span><br><span class="line"></span><br><span class="line">##### Use HSP to share code/resources in multi-package scenarios  </span><br><span class="line">The system provides two shared packages: HAR (static) and HSP (dynamic).  </span><br><span class="line">- HAR code/resources are compiled with the user, leading to duplicate copies in multiple users&#x27; outputs.  </span><br><span class="line">- HSP code/resources are independently compiled, with only one copy existing in a process at runtime.  </span><br><span class="line"></span><br><span class="line">In multi-package scenarios, using HAR for sharing causes redundant copies. Replacing HAR with HSP can reduce the package size when the total size of shared resources exceeds HSP (11k).  </span><br><span class="line"></span><br><span class="line">##### Use scanning tools to analyze app packages  </span><br><span class="line">Scanning tools can:  </span><br><span class="line">- Scan duplicate files.  </span><br><span class="line">- Identify files exceeding specified sizes.  </span><br><span class="line">- Statistically analyze the total size and proportion of each file type.  </span><br><span class="line"></span><br><span class="line">**Optimization measures based on scan results**:  </span><br><span class="line">- Remove duplicate resources within the same package.  </span><br><span class="line">- Use HSP to reuse duplicate resources across multi-packages.  </span><br><span class="line">- Compress large files (e.g., JPG, PNG, GIF).  </span><br><span class="line">- Compress so files by configuring compression options.  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 3. Issues with Tabs nested in Grid in HarmonyOS?  </span><br><span class="line">When using a Grid container in TabContent, the dynamic number of Grid elements causes inconsistent TabContent heights (the height of the TabContent with the most elements is applied to all).  </span><br><span class="line"></span><br><span class="line">**Solution**:  </span><br><span class="line">The TabContent component does not support universal height settings, as its height is determined by the Tabs parent component and TabBar. The Grid component can achieve adaptive height by setting `maxCount` (which acts as a height control switch). For details, refer to:  </span><br><span class="line">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-grid-V5#example6  </span><br><span class="line"></span><br><span class="line">```typescript</span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line">struct Index &#123;</span><br><span class="line">  @State numbers: string[] = [];</span><br><span class="line"></span><br><span class="line">  aboutToAppear() &#123;</span><br><span class="line">    for (let i = 1; i &lt;= 35; i++) &#123;</span><br><span class="line">      this.numbers.push(i + &#x27;&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  build() &#123;</span><br><span class="line">    Scroll() &#123;</span><br><span class="line">      Column(&#123; space: 5 &#125;) &#123;</span><br><span class="line">        Blank();</span><br><span class="line">        Text(&#x27;rowsTemplate and columnsTemplate are not set; layoutDirection, maxcount, minCount, and cellLength take effect&#x27;)</span><br><span class="line">          .fontSize(15)</span><br><span class="line">          .fontColor(0xCCCCCC)</span><br><span class="line">          .width(&#x27;90%&#x27;);</span><br><span class="line">        Grid() &#123;</span><br><span class="line">          ForEach(this.numbers, (day: string) =&gt; &#123;</span><br><span class="line">            GridItem() &#123;</span><br><span class="line">              Text(day).fontSize(16).backgroundColor(0xF9CF93);</span><br><span class="line">            &#125;.width(40).height(80).borderWidth(2).borderColor(Color.Red);</span><br><span class="line">          &#125;, (day: string) =&gt; day);</span><br><span class="line">        &#125;</span><br><span class="line">        .columnsGap(10)</span><br><span class="line">        .rowsGap(10)</span><br><span class="line">        .backgroundColor(0xFAEEE0)</span><br><span class="line">        .maxCount(6)</span><br><span class="line">        .minCount(2)</span><br><span class="line">        .cellLength(0)</span><br><span class="line">        .layoutDirection(GridDirection.Row)</span><br><span class="line">        .backgroundColor(Color.Blue);</span><br><span class="line">      &#125;.width(&#x27;90%&#x27;).margin(&#123; top: 5, left: 5, right: 5 &#125;).align(Alignment.Center);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 4. Are there best practices or demos for aging adaptation in HarmonyOS?  </span><br><span class="line">When the system font size is adjusted, the app layout may become ugly. It is desired to limit the font size within a specific range (min/max) regardless of system settings.  </span><br><span class="line"></span><br><span class="line">```typescript</span><br><span class="line">// xxx.ets</span><br><span class="line">import measure from &#x27;@ohos.measure&#x27;;</span><br><span class="line"></span><br><span class="line">@Entry</span><br><span class="line">@Component</span><br><span class="line">struct TextInputExample &#123;</span><br><span class="line">  @State text: string = &#x27;&#x27;;</span><br><span class="line">  @State truncatedHint: string = &quot;Text not truncated&quot;;</span><br><span class="line">  controller: TextInputController = new TextInputController();</span><br><span class="line"></span><br><span class="line">  build() &#123;</span><br><span class="line">    Column() &#123;</span><br><span class="line">      TextInput(&#123; text: this.text, placeholder: &#x27;input your word...&#x27;, controller: this.controller &#125;)</span><br><span class="line">        .placeholderColor(Color.Grey)</span><br><span class="line">        .placeholderFont(&#123; size: 14, weight: 400 &#125;)</span><br><span class="line">        .caretColor(Color.Blue)</span><br><span class="line">        .width(400)</span><br><span class="line">        .height(40)</span><br><span class="line">        .margin(20)</span><br><span class="line">        .fontSize(14)</span><br><span class="line">        .fontColor(Color.Black)</span><br><span class="line">        .onChange((value: string) =&gt; &#123;</span><br><span class="line">          this.text = value;</span><br><span class="line">          let textSizeShow1: SizeOptions = measure.measureTextSize(&#123;</span><br><span class="line">            textContent: this.text,</span><br><span class="line">            constraintWidth: 100,</span><br><span class="line">            fontSize: 14,</span><br><span class="line">            overflow: TextOverflow.Ellipsis,</span><br><span class="line">            maxLines: 2</span><br><span class="line">          &#125;);</span><br><span class="line">          let textSizeShow2: SizeOptions = measure.measureTextSize(&#123;</span><br><span class="line">            textContent: this.text + &quot; &quot;,</span><br><span class="line">            constraintWidth: 100,</span><br><span class="line">            fontSize: 14,</span><br><span class="line">            overflow: TextOverflow.Ellipsis,</span><br><span class="line">            maxLines: 2000000</span><br><span class="line">          &#125;);</span><br><span class="line">          console.log(&quot;tag textSizeShow1.height=&quot; + textSizeShow1.height);</span><br><span class="line">          console.log(&quot;tag textSizeShow2.height=&quot; + textSizeShow2.height);</span><br><span class="line"></span><br><span class="line">          if (textSizeShow2 &amp;&amp; textSizeShow1 &amp;&amp; textSizeShow2?.height &amp;&amp; textSizeShow1?.height &amp;&amp; (textSizeShow2?.height &gt; textSizeShow1?.height)) &#123;</span><br><span class="line">            console.log(&quot;tag Text truncated&quot;);</span><br><span class="line">            this.truncatedHint = &quot;Text truncated&quot;;</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            console.log(&quot;tag Text not truncated&quot;);</span><br><span class="line">            this.truncatedHint = &quot;Text not truncated&quot;;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      Text(this.text)</span><br><span class="line">        .maxLines(2)</span><br><span class="line">        .width(100)</span><br><span class="line">        .textOverflow(&#123; overflow: TextOverflow.Ellipsis &#125;)</span><br><span class="line">        .border(&#123; width: 1 &#125;)</span><br><span class="line">        .minFontSize(14)</span><br><span class="line">        .maxFontSize(24);</span><br><span class="line">      Text(this.truncatedHint);</span><br><span class="line">    &#125;.width(&#x27;100%&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 5. Release package compilation failed?  </span><br></pre></td></tr></table></figure>
<p>hvigor ERROR: Failed ::PackageApp…<br>hvigor ERROR: Tools execution failed.<br>2024&#x2F;06&#x2F;17 16:55:38.923 - Ohos BundleTool [Error]: debug is different.<br>2024&#x2F;06&#x2F;17 16:55:38.923 - Ohos BundleTool [Error]: some app variable is different.<br>2024&#x2F;06&#x2F;17 16:55:38.923 - Ohos BundleTool [Error]: Compressor::compressAppMode compress failed.<br>2024&#x2F;06&#x2F;17 16:55:38.926 - Ohos BundleTool [Error]: Compressor::compressProcess Bundle exception.<br>2024&#x2F;06&#x2F;17 16:55:38.926 - Ohos BundleTool [Error]: Compressor::compressProcess compress failed.<br>2024&#x2F;06&#x2F;17 16:55:38.926 - Ohos BundleTool [Error]: CompressEntrance::main exit, compress failed<br>Detail: Please check the message from tools.<br>hvigor ERROR: BUILD FAILED in 23 s 837 ms</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**Cause**: Inconsistent `vendor` fields in `app.json5` of multi-module references.  </span><br><span class="line"></span><br><span class="line">**Troubleshooting steps**:  </span><br><span class="line">1. In File -&gt; Settings -&gt; Build, Execution, Deployment -&gt; Build Tools -&gt; Hvigor, set Use log level to Debug.  </span><br><span class="line">2. Rebuild the app.  </span><br><span class="line">3. Search the build log for &quot;app_packing_tool&quot; parameters (–hap-path, –hsp-path) to identify all dependent haps/hsps.  </span><br><span class="line">4. Ensure consistent `vendor` fields across haps/hsps.  </span><br><span class="line"></span><br><span class="line">Example build log snippet:  </span><br></pre></td></tr></table></figure>
<p>hvigor DEBUG BasePackAppTask Use tool [PackageApp][‘java’,‘-Dfile.encoding&#x3D;GBK’,‘-jar’,<br>‘D:\DevEco_pakage\Huawei\harmonyos\HarmonyOS-NEXT-DP1\base\toolchains\lib\app_packing_tool.jar’,‘–mode’,‘app’,‘–pack-info-path’,‘D:\demo\MyApplication\build\outputs\default\pack.info’,‘–hap-path’,<br>‘D:\demo\MyApplication\entry\build\default\outputs\default\app\entry-default.hap’,‘–hsp-path’,<br>‘D:\demo\MyApplication\library\build\default\outputs\default\app\library-default.hsp’,‘–force’,‘true’,‘–out-path’,<br>‘D:\demo\MyApplication\build\outputs\default\MyApplication-default-unsigned.app’,‘–main-module-limit’,‘2’,‘–normal-module-limit’,‘2’]</p>
<pre><code>
For specific configuration procedures, refer to: https://developer.huawei.com/consumer/cn/doc/app/agc-help-harmonyos-internalrelease-0000001756878768
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41126-Daily-HarmonyOS-Next-Knowledge-Node-Destruction-Issues-Distinguishing-Between-Mobile-and-Pad-Navigation-Routing-Problems-Tabs-Component-Width-and-How-to-Monitor-Maps/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41126-Daily-HarmonyOS-Next-Knowledge-Node-Destruction-Issues-Distinguishing-Between-Mobile-and-Pad-Navigation-Routing-Problems-Tabs-Component-Width-and-How-to-Monitor-Maps/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Node Destruction Issues, Distinguishing Between Mobile and Pad, Navigation Routing Problems, Tabs Component Width, and How to Monitor Maps</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:35:32 / Modified: 09:36:10" itemprop="dateCreated datePublished" datetime="2025-06-29T09:35:32+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Next-Knowledge-Node-Destruction-Issues-Distinguishing-Between-Mobile-and-Pad-Navigation-Routing-Problems-Tabs-Component-Width-and-How-to-Monitor-Maps"><a href="#Daily-HarmonyOS-Next-Knowledge-Node-Destruction-Issues-Distinguishing-Between-Mobile-and-Pad-Navigation-Routing-Problems-Tabs-Component-Width-and-How-to-Monitor-Maps" class="headerlink" title="[Daily HarmonyOS Next Knowledge] Node Destruction Issues, Distinguishing Between Mobile and Pad, Navigation Routing Problems, Tabs Component Width, and How to Monitor Maps"></a>[Daily HarmonyOS Next Knowledge] Node Destruction Issues, Distinguishing Between Mobile and Pad, Navigation Routing Problems, Tabs Component Width, and How to Monitor Maps</h1><h4 id="1-In-HarmonyOS-if-only-the-root-node’s-dispose-is-called-can-its-child-nodes-be-destroyed-or-do-child-nodes-need-to-be-traversed-and-their-dispose-methods-executed-for-proper-destruction"><a href="#1-In-HarmonyOS-if-only-the-root-node’s-dispose-is-called-can-its-child-nodes-be-destroyed-or-do-child-nodes-need-to-be-traversed-and-their-dispose-methods-executed-for-proper-destruction" class="headerlink" title="1. In HarmonyOS, if only the root node’s dispose is called, can its child nodes be destroyed, or do child nodes need to be traversed and their dispose methods executed for proper destruction?"></a>1. In HarmonyOS, if only the root node’s dispose is called, can its child nodes be destroyed, or do child nodes need to be traversed and their dispose methods executed for proper destruction?</h4><p>Frontend-referenced objects need to be disposed, and builderNodes and FrameNodes created with new also require dispose. Calling only the root node’s dispose cannot guarantee that child nodes will be properly released.  </p>
<h4 id="2-How-to-distinguish-between-mobile-and-pad-devices-in-the-Web-UserAgent-of-HarmonyOS"><a href="#2-How-to-distinguish-between-mobile-and-pad-devices-in-the-Web-UserAgent-of-HarmonyOS" class="headerlink" title="2. How to distinguish between mobile and pad devices in the Web UserAgent of HarmonyOS?"></a>2. How to distinguish between mobile and pad devices in the Web UserAgent of HarmonyOS?</h4><p>Reference: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/multi-faq-V5#ZH-CN_TOPIC_0000001884757262__%E5%A6%82%E4%BD%95%E6%9F%A5%E8%AF%A2%E8%AE%BE%E5%A4%87%E7%B1%BB%E5%9E%8B">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/multi-faq-V5#ZH-CN_TOPIC_0000001884757262__%E5%A6%82%E4%BD%95%E6%9F%A5%E8%AF%A2%E8%AE%BE%E5%A4%87%E7%B1%BB%E5%9E%8B</a>  </p>
<ol>
<li><p>Query device type via command line.<br>Query the specified system parameter (const.product.devicetype) via command line to determine the device type:  </p>
<pre><code class="language-bash"># Method 1  
hdc shell param get &quot;const.product.devicetype&quot;  
# Method 2  
hdc shell cat /etc/param/ohos.para | grep const.product.devicetype  
</code></pre>
</li>
<li><p>Query device type during application development.  </p>
<pre><code class="language-typescript">import &#123; deviceInfo &#125; from &#39;@kit.BasicServicesKit&#39;;

@Entry
@Component
struct GetDeviceTypeSample &#123;
  @State deviceType: string = &#39;unknown&#39;;

  aboutToAppear() &#123;
    this.deviceType = deviceInfo.deviceType;
  &#125;

  build() &#123;
    Column() &#123;
      Text(this.deviceType).fontSize(24);
    &#125;
    .width(&#39;100%&#39;)
    .height(&#39;100%&#39;);
  &#125;
&#125;
</code></pre>
</li>
</ol>
<h4 id="3-Navigation-routing-issues-in-HarmonyOS"><a href="#3-Navigation-routing-issues-in-HarmonyOS" class="headerlink" title="3. Navigation routing issues in HarmonyOS?"></a>3. Navigation routing issues in HarmonyOS?</h4><p>When navigating from the Index page to the PageOne page, the navigation bar is hidden (hideNavBar), but why does a white screen appear when returning from PageOne to the previous page?  </p>
<pre><code class="language-typescript">// Index.ets  
@Entry
@Component
struct Index &#123;
  @State hideNavBar: boolean = false;
  private pageStack: NavPathStack = new NavPathStack();

  build() &#123;
    Navigation(this.pageStack) &#123;
      Column() &#123;
        Button(&#39;Jump to PageOne, hide NavBar&#39;)
          .onClick(() =&gt; &#123;
            this.hideNavBar = true;
            this.pageStack.replacePath(&#123;
              name: &#39;PageOne&#39;
            &#125;);
          &#125;);
      &#125;
      .height(&#39;100%&#39;)
      .justifyContent(FlexAlign.Center);
    &#125;
    .hideNavBar(this.hideNavBar)
    .hideTitleBar(true)
    .hideBackButton(true);
  &#125;
&#125;

// PageOne.ets  
@Builder
function PageOneBuilder() &#123;
  PageOne();
&#125;

@Component
export struct PageOne &#123;
  pageStack: NavPathStack | null = null;
  build() &#123;
    NavDestination() &#123;
      Column() &#123;
        Button(&#39;Return to previous page&#39;)
          .onClick(() =&gt; &#123;
            // Return to the previous page here  
            this.pageStack?.pop?.();
          &#125;);
      &#125;.height(&#39;100%&#39;);
    &#125;
    .hideTitleBar(true)
    .onReady((ctx: NavDestinationContext) =&gt; &#123;
      this.pageStack = ctx.pathStack;
    &#125;);
  &#125;
&#125;
</code></pre>
<p>API reference: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-navigation-navigation-V5">https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-navigation-navigation-V5</a>  </p>
<p><strong>White screen cause</strong>: Hiding the navigation bar via hideNavBar(true) leads to this issue. Setting it to false restores the previous page’s navigation bar buttons. Adding a Button component to Navigation ensures visibility even when Navigation is hidden. Refer to the API documentation for details.  </p>
<h4 id="4-Width-issues-with-the-HarmonyOS-Tabs-component"><a href="#4-Width-issues-with-the-HarmonyOS-Tabs-component" class="headerlink" title="4. Width issues with the HarmonyOS Tabs component?"></a>4. Width issues with the HarmonyOS Tabs component?</h4><p>Documentation states that the Tabs component’s indicator matches the view width. The app’s home page has numerous columns, with a semi-transparent cover strip and button on the right, causing operational issues—some columns may be unreachable. Is there a way to separate these elements or use alternative components?  </p>
<p>Refer to the following demo:  </p>
<pre><code class="language-typescript">@Entry
@Component
struct tabTest &#123;
  @State tabArray: Array&lt;number&gt; = [0, 1, 2, 3, 4];
  @State focusIndex: number = 0;
  @State pre: number = 0;
  @State index: number = 0;
  private controller: TabsController = new TabsController();
  @State test: boolean = false;
  @State animationDuration: number = 300;
  @State indicatorLeftMargin: number = 0;
  @State indicatorWidth: number = 0;
  private tabsWidth: number = 0;
  private tabWidth: number = 0;
  private scrollerForScroll: Scroller = new Scroller();

  // Individual tab  
  @Builder
  Tab(tabName: string, tabItem: number, tabIndex: number) &#123;
    Row(&#123; space: 20 &#125;) &#123;
      Text(tabName)
        .fontSize(18)
        .fontColor(tabIndex === this.focusIndex ? Color.Blue : Color.Black)
        .id(tabIndex.toString())
        .onAreaChange((oldValue: Area, newValue: Area) =&gt; &#123;
          if (this.focusIndex === tabIndex &amp;&amp; (this.indicatorLeftMargin === 0 || this.indicatorWidth === 0)) &#123;
            if (newValue.position.x !== undefined) &#123;
              let positionX = Number.parseFloat(newValue.position.x.toString());
              this.indicatorLeftMargin = Number.isNaN(positionX) ? 0 : positionX;
            &#125;
            let width = Number.parseFloat(newValue.width.toString());
            this.tabWidth = Number.isNaN(width) ? 0 : width;
            this.indicatorWidth = this.tabWidth;
          &#125;
        &#125;);
    &#125;
    .justifyContent(FlexAlign.Center)
    .constraintSize(&#123; minWidth: 35 &#125;)
    .width(100)
    .height(30)
    .onClick(() =&gt; &#123;
      this.controller.changeIndex(tabIndex);
      this.focusIndex = tabIndex;
    &#125;)
    .backgroundColor(&quot;#ffb7b7b7&quot;);
  &#125;

  @Builder
  textTest(textName: string) &#123;
    Row(&#123; space: 20 &#125;) &#123;
      Text(textName).fontSize(18);
    &#125;
    .justifyContent(FlexAlign.Center)
    .constraintSize(&#123; minWidth: 35 &#125;)
    .height(30)
    .backgroundColor(&quot;#ffb7b7b7&quot;);
  &#125;

  build() &#123;
    Column() &#123;
      Stack(&#123; alignContent: Alignment.TopStart &#125;) &#123;
        Column() &#123;
          // Tabs  
          Row(&#123; space: 8 &#125;) &#123;
            List(&#123; space: 20, initialIndex: 0, scroller: this.scrollerForScroll &#125;) &#123;
              ForEach(this.tabArray, (item: number, index: number) =&gt; &#123;
                ListItem() &#123;
                  this.Tab(&quot;Tab &quot; + item, item, index);
                &#125;
              &#125;, (item: string) =&gt; item);
            &#125;
            .listDirection(Axis.Horizontal)
            .height(30)
            .width(&#39;80%&#39;)
            .friction(0.6)
            .alignListItem(ListItemAlign.Start)
            .scrollBar(BarState.Off)
            .width(&#39;80%&#39;)
            .backgroundColor(&quot;#ffb7b7b7&quot;)
            .onScroll((xOffset: number, yOffset: number) =&gt; &#123;
              this.indicatorLeftMargin -= xOffset;
            &#125;);
            this.textTest(&#39;More&#39;);
          &#125;
          .alignItems(VerticalAlign.Bottom)
          .width(&#39;100%&#39;)
          .backgroundColor(&quot;#ffb7b7b7&quot;);
        &#125;
        .alignItems(HorizontalAlign.Start)
        .width(&#39;100%&#39;);

        Column()
          .height(2)
          .width(this.indicatorWidth)
          .margin(&#123; left: this.indicatorLeftMargin, top: 30 &#125;)
          .backgroundColor(Color.Blue);
        Column()
          .height(10)
          .width(&quot;20%&quot;)
          .margin(&#123; left: &#39;80%&#39;, top: 28 &#125;)
          .backgroundColor(&quot;#ffb7b7b7&quot;);
      &#125;
      .height(40)
      .width(&#39;100%&#39;)
      .backgroundColor(&quot;#ffb7b7b7&quot;);
      // Tabs  
      Tabs(&#123; barPosition: BarPosition.Start, controller: this.controller &#125;) &#123;
        ForEach(this.tabArray, (item: number, index: number) =&gt; &#123;
          TabContent() &#123;
            Text(&#39;Content of Page &#39; + item)
              .height(300)
              .width(&#39;100%&#39;)
              .fontSize(30);
          &#125;
          .backgroundColor(Color.White);
        &#125;, (item: string) =&gt; item);
      &#125;
      .onAreaChange((oldValue: Area, newValue: Area) =&gt; &#123;
        let width = Number.parseFloat(newValue.width.toString());
        this.tabsWidth = Number.isNaN(width) ? 0 : width;
      &#125;)
      .width(&#39;100%&#39;)
      .barHeight(0)
      .animationDuration(100)
      .onChange((index: number) =&gt; &#123;
        console.log(&#39;foo change&#39;);
        this.focusIndex = index;
        this.scrollerForScroll.scrollToIndex(index - 1, true);
      &#125;)
      .onAnimationStart((index: number, targetIndex: number, event: TabsAnimationEvent) =&gt; &#123;
        // Callback triggered at the start of the tab switch animation. The underline slides with the page.  
        this.focusIndex = targetIndex;
        let targetIndexInfo = this.getTextInfo(targetIndex);
        this.startAnimateTo(this.animationDuration, targetIndexInfo.left, targetIndexInfo.width);
      &#125;)
      .onAnimationEnd((index: number, event: TabsAnimationEvent) =&gt; &#123;
        // Callback triggered at the end of the tab switch animation. The underline animation stops.  
        let currentIndicatorInfo = this.getCurrentIndicatorInfo(index, event);
        this.startAnimateTo(0, currentIndicatorInfo.left, currentIndicatorInfo.width);
      &#125;)
      .onGestureSwipe((index: number, event: TabsAnimationEvent) =&gt; &#123;
        // Callback triggered frame-by-frame during page swipe.  
        let currentIndicatorInfo = this.getCurrentIndicatorInfo(index, event);
        this.focusIndex = currentIndicatorInfo.index;
        this.indicatorLeftMargin = currentIndicatorInfo.left;
        this.tabWidth = currentIndicatorInfo.width;
        this.indicatorWidth = currentIndicatorInfo.width;
      &#125;);
    &#125;
    .height(&#39;100%&#39;);
  &#125;

  private getTextInfo(index: number): Record&lt;string, number&gt; &#123;
    let strJson = getInspectorByKey(index.toString());
    try &#123;
      let obj: Record&lt;string, string&gt; = JSON.parse(strJson);
      let rectInfo: number[][] = JSON.parse(&#39;[&#39; + obj.$rect + &#39;]&#39;);
      return &#123; &#39;left&#39;: px2vp(rectInfo[0][0]), &#39;width&#39;: px2vp(rectInfo[1][0] - rectInfo[0][0]) &#125;;
    &#125; catch (error) &#123;
      return &#123; &#39;left&#39;: 0, &#39;width&#39;: 0 &#125;;
    &#125;
  &#125;

  private getCurrentIndicatorInfo(index: number, event: TabsAnimationEvent): Record&lt;string, number&gt; &#123;
    let nextIndex = index;
    if (index &gt; 0 &amp;&amp; event.currentOffset &gt; 0) &#123;
      nextIndex--;
    &#125; else if (index &lt; 4 &amp;&amp; event.currentOffset &lt; 0) &#123;
      nextIndex++;
    &#125;
    let indexInfo = this.getTextInfo(index);
    let nextIndexInfo = this.getTextInfo(nextIndex);
    let swipeRatio = Math.abs(event.currentOffset / this.tabsWidth);
    let currentIndex = swipeRatio &gt; 0.5 ? nextIndex : index; // Switch to the next tab if the page swipe exceeds half.  
    let currentLeft = indexInfo.left + (nextIndexInfo.left - indexInfo.left) * swipeRatio;
    let currentWidth = indexInfo.width + (nextIndexInfo.width - indexInfo.width) * swipeRatio;
    return &#123; &#39;index&#39;: currentIndex, &#39;left&#39;: currentLeft, &#39;width&#39;: currentWidth &#125;;
  &#125;

  private startAnimateTo(duration: number, leftMargin: number, width: number) &#123;
    animateTo(&#123;
      duration: duration, // Animation duration  
      curve: Curve.Linear, // Animation curve  
      iterations: 1, // Number of plays  
      playMode: PlayMode.Normal, // Animation mode  
      onFinish: () =&gt; &#123;
        console.info(&#39;play end&#39;);
      &#125;
    &#125;, () =&gt; &#123;
      this.indicatorLeftMargin = leftMargin;
      this.tabWidth = width;
      this.indicatorWidth = width;
    &#125;);
  &#125;
&#125;
</code></pre>
<h4 id="5-How-to-monitor-Maps-in-HarmonyOS"><a href="#5-How-to-monitor-Maps-in-HarmonyOS" class="headerlink" title="5. How to monitor Maps in HarmonyOS?"></a>5. How to monitor Maps in HarmonyOS?</h4><p>Map variables can be decorated with @State. Currently, Map and Set types are supported, but HashMap is not.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://harmonyostech.github.io/2025/06/29/41127-Daily-HarmonyOS-Next-Knowledge-Web-Height-Adaptation-Variable-Declaration-Specifications-Animation-Cancellation-Signature-Files-and-Package-Size-Optimization-related/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Qingkouwei">
      <meta itemprop="description" content="Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HarmonyOS NEXT Knowledge Charging Station">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/06/29/41127-Daily-HarmonyOS-Next-Knowledge-Web-Height-Adaptation-Variable-Declaration-Specifications-Animation-Cancellation-Signature-Files-and-Package-Size-Optimization-related/" class="post-title-link" itemprop="url">[Daily HarmonyOS Next Knowledge] Web Height Adaptation, Variable Declaration Specifications, Animation Cancellation, Signature Files, and Package Size Optimization-related</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-06-29 09:34:25 / Modified: 09:36:44" itemprop="dateCreated datePublished" datetime="2025-06-29T09:34:25+08:00">2025-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Daily-HarmonyOS-Next-Knowledge/" itemprop="url" rel="index"><span itemprop="name">Daily HarmonyOS Next Knowledge</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Daily-HarmonyOS-Knowledge-Web-Height-Adaptation-Variable-Declaration-Specifications-Animation-Cancellation-Signature-Files-and-Package-Size-Optimization-related"><a href="#Daily-HarmonyOS-Knowledge-Web-Height-Adaptation-Variable-Declaration-Specifications-Animation-Cancellation-Signature-Files-and-Package-Size-Optimization-related" class="headerlink" title="[Daily HarmonyOS Knowledge] Web Height Adaptation, Variable Declaration Specifications, Animation Cancellation, Signature Files, and Package Size Optimization-related"></a>[Daily HarmonyOS Knowledge] Web Height Adaptation, Variable Declaration Specifications, Animation Cancellation, Signature Files, and Package Size Optimization-related</h1><h4 id="1-How-to-Adapt-the-Height-of-a-HarmonyOS-Web-Page"><a href="#1-How-to-Adapt-the-Height-of-a-HarmonyOS-Web-Page" class="headerlink" title="1. How to Adapt the Height of a HarmonyOS Web Page?"></a>1. How to Adapt the Height of a HarmonyOS Web Page?</h4><p>When setting the height of a Web page to 100%, it is found that the height is inconsistent with that of the Web control. What needs to be set to make the page height consistent with the Web container height?</p>
<p>Currently, only two web layout modes are supported, namely Web layout following the system WebLayoutMode.NONE and Web adaptive webpage layout based on page size WebLayoutMode.FIT_CONTENT. The default is WebLayoutMode.NONE mode. Reference document: <a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-tabcontent-V5#layoutmode10%E6%9E%9A%E4%B8%BE%E8%AF%B4%E6%98%8E">https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-tabcontent-V5#layoutmode10%E6%9E%9A%E4%B8%BE%E8%AF%B4%E6%98%8E</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Web(&#123; src: $rawfile(&#x27;index.html&#x27;), controller: this.controller &#125;)</span><br><span class="line">  .width(CommonConstants.WIDTH_OR_HEIGHT)</span><br><span class="line">  .layoutMode(WebLayoutMode.FIT_CONTENT)</span><br></pre></td></tr></table></figure>

<h4 id="2-Does-HarmonyOS-ArkTS-have-relevant-specifications-for-variable-type-declaration"><a href="#2-Does-HarmonyOS-ArkTS-have-relevant-specifications-for-variable-type-declaration" class="headerlink" title="2. Does HarmonyOS ArkTS have relevant specifications for variable type declaration?"></a>2. Does HarmonyOS ArkTS have relevant specifications for variable type declaration?</h4><p>Is it necessary to add variable types when declaring variables? Are the requirements consistent for different types? For example:<br>Is let result &#x3D; ‘’ required to be written as let result: string &#x3D; ‘’?<br>Is const TEST_RESULT &#x3D; ‘ok’ required to be written as const TEST_RESULT: string &#x3D; ‘ok’?<br>Are there differences between member variables and temporary variables?</p>
<p>Using let result &#x3D; ‘’; is sufficient, and the engine will infer the type based on the value. let and const are the same, and regardless of the type of variable, the type can be automatically inferred.</p>
<h4 id="3-How-to-cancel-the-animateTo-or-animation-in-HarmonyOS"><a href="#3-How-to-cancel-the-animateTo-or-animation-in-HarmonyOS" class="headerlink" title="3. How to cancel the animateTo or animation in HarmonyOS?"></a>3. How to cancel the animateTo or animation in HarmonyOS?</h4><p>I didn’t see the relevant cancellation method in the document.</p>
<p>If you need to interrupt the animation, you can refer to this demo, which sets an animation with a value of 0 to interrupt the previous animation.<br>Reference demo:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">@Entry</span><br><span class="line">struct Index &#123;</span><br><span class="line">  @State clickNumber: number = 0;</span><br><span class="line">  @State myScale: number = 1.0;</span><br><span class="line">  uiContext: UIContext | undefined = undefined;</span><br><span class="line">  imageIndex: number = 0</span><br><span class="line">  aboutToAppear() &#123;</span><br><span class="line">    this.uiContext = this.getUIContext?.();</span><br><span class="line">  &#125;</span><br><span class="line">  build() &#123;</span><br><span class="line">    Stack(&#123; alignContent: Alignment.TopEnd &#125;) &#123;</span><br><span class="line">      // Wooden fish picture</span><br><span class="line">      Image($r(&#x27;app.media.startIcon&#x27;))</span><br><span class="line">        .zIndex(2)</span><br><span class="line">        .width(200)</span><br><span class="line">        .height(200)</span><br><span class="line">        .margin(&#123; top: 300, right: 130 &#125;)</span><br><span class="line">        .scale(&#123; x: this.myScale, y: this.myScale &#125;)// .clickEffect(&#123;level:ClickEffectLevel.LIGHT,scale:0.5&#125;)</span><br><span class="line">        .onClick(() =&gt; &#123;</span><br><span class="line">          if (!this.uiContext) &#123;</span><br><span class="line">            return;</span><br><span class="line">          &#125;</span><br><span class="line">          // Set an animation with a display animation of 0 to interrupt the previous animation</span><br><span class="line">          animateTo(&#123; duration: 0, iterations: 1&#125;, () =&gt; &#123;</span><br><span class="line">            console.info(&#x27;this.dur0xxx---&#x27;, this.myScale)</span><br><span class="line">            this.myScale = 1;</span><br><span class="line">          &#125;)</span><br><span class="line">          animateTo(&#123; duration: 1500, iterations: 1 ,onFinish: () =&gt; &#123;</span><br><span class="line">            animateTo(&#123; duration: 1500, iterations: 1&#125;, () =&gt;&#123;</span><br><span class="line">              console.info(&#x27;this.dur2---&#x27;, this.myScale)</span><br><span class="line">              this.myScale = 1;</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;&#125;, () =&gt; &#123;</span><br><span class="line">            console.info(&#x27;this.dur1---&#x27;, this.myScale)</span><br><span class="line">            this.myScale = 0.8;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;.backgroundColor(Color.Black)</span><br><span class="line">    .width(&#x27;100%&#x27;)</span><br><span class="line">    .height(&#x27;100%&#x27;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-How-to-configure-to-use-one-signature-file-in-debug-mode-and-another-in-release-mode-in-build-profile"><a href="#4-How-to-configure-to-use-one-signature-file-in-debug-mode-and-another-in-release-mode-in-build-profile" class="headerlink" title="4. How to configure to use one signature file in debug mode and another in release mode in build-profile?"></a>4. How to configure to use one signature file in debug mode and another in release mode in build-profile?</h4><p>In the project-level build-profile.json5 file, add customized products and use different signature certificates respectively.</p>
<ol>
<li>Configure the signature file</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;signingConfigs&quot;: [ &#123; &quot;name&quot;: &quot;default&quot;, &quot;type&quot;: &quot;HarmonyOS&quot;, &quot;material&quot;: &#123; &quot;certpath&quot;: &quot;&quot;, &quot;storePassword&quot;: &quot;&quot;, &quot;keyAlias&quot;: &quot;&quot;, &quot;keyPassword&quot;: &quot;&quot;, &quot;profile&quot;: &quot;b&quot;, &quot;signAlg&quot;: &quot;&quot;, &quot;storeFile&quot;: &quot;&quot; &#125; &#125;, &#123; &quot;name&quot;: &quot;useForRelease&quot;, &quot;type&quot;: &quot;HarmonyOS&quot;, &quot;material&quot;: &#123; &quot;certpath&quot;: &quot;&quot;, &quot;storePassword&quot;: &quot;&quot;, &quot;keyAlias&quot;: &quot;&quot;, &quot;keyPassword&quot;: &quot;&quot;, &quot;profile&quot;: &quot;b&quot;, &quot;signAlg&quot;: &quot;&quot;, &quot;storeFile&quot;: &quot;&quot; &#125; &#125;, &#123; &quot;name&quot;: &quot;useForDebug&quot;, &quot;type&quot;: &quot;HarmonyOS&quot;, &quot;material&quot;: &#123; &quot;certpath&quot;: &quot;&quot;, &quot;storePassword&quot;: &quot;&quot;, &quot;keyAlias&quot;: &quot;&quot;, &quot;keyPassword&quot;: &quot;&quot;, &quot;profile&quot;: &quot;b&quot;, &quot;signAlg&quot;: &quot;&quot;, &quot;storeFile&quot;: &quot;&quot; &#125; ] </span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Configure</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;products&quot;: [ &#123; &quot;name&quot;: &quot;default&quot;, &quot;signingConfig&quot;: &quot;default&quot;, &quot;compatibleSdkVersion&quot;: &quot;5.0.0(12)&quot;, &quot;runtimeOS&quot;: &quot;HarmonyOS&quot;, &#125;, &#123; &quot;name&quot;: &quot;useForDebug&quot;, &quot;signingConfig&quot;: &quot;useForDebug&quot;, &quot;compatibleSdkVersion&quot;: &quot;5.0.0(12)&quot;, &quot;runtimeOS&quot;: &quot;HarmonyOS&quot;, &#125;, &#123; &quot;name&quot;: &quot;useForRelease&quot;, &quot;signingConfig&quot;: &quot;useForRelease&quot;, &quot;compatibleSdkVersion&quot;: &quot;5.0.0(12)&quot;, &quot;runtimeOS&quot;: &quot;HarmonyOS&quot;, &#125; ],</span><br></pre></td></tr></table></figure>
<p>Click the Product button in the upper right corner. Select useForDebug in Product to choose the hap using the debug certificate, and select useForRelease-&gt;apply. The built APP will use the release certificate. Do not delete the default configuration item.</p>
<ol start="3">
<li>In the module, add the two parameters useForDebug and useForRelease to the applytoProducts attribute “modules”:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ &#123; &quot;name&quot;: &quot;entry&quot;, &quot;srcPath&quot;: &quot;./entry&quot;, &quot;targets&quot;: [ &#123; &quot;name&quot;: &quot;default&quot;, &quot;applyToProducts&quot;: [ &quot;default&quot;, &quot;default_debug&quot;, &quot;default_realse&quot; ] &#125; ] &#125; ] </span><br></pre></td></tr></table></figure>

<h4 id="5-What-is-the-difference-between-configuring-dependent-third-party-applications-in-the-global-configuration-oh-package-and-configuring-them-in-the-module’s-oh-package-and-will-it-affect-the-package-size"><a href="#5-What-is-the-difference-between-configuring-dependent-third-party-applications-in-the-global-configuration-oh-package-and-configuring-them-in-the-module’s-oh-package-and-will-it-affect-the-package-size" class="headerlink" title="5. What is the difference between configuring dependent third-party applications in the global configuration oh-package and configuring them in the module’s oh-package, and will it affect the package size?"></a>5. What is the difference between configuring dependent third-party applications in the global configuration oh-package and configuring them in the module’s oh-package, and will it affect the package size?</h4><p>Does configuring third-party library dependencies globally or in the module affect the package size?</p>
<p>Configuring dependent third-party applications in the global oh-package can be used throughout the entire project, while configuring them in the module’s oh-package can only be used in that module. Therefore, global configuration will affect the package size of the entire project, while module configuration will only affect the package size of that module.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Qingkouwei</p>
  <div class="site-description" itemprop="description">Welcome to the HarmonyOS NEXT Knowledge Charging Station!  This is a hub for knowledge about HarmonyOS Next`s new-generation system. With its self-developed kernel, HarmonyOS NEXT achieves native smoothness, security, intelligence, and interconnectivity. We deeply analyze how its new distributed soft bus revolutionizes device connectivity experiences and explain the principles behind the enhanced perception and reasoning capabilities of the Xiaoyi intelligent agent based on the Pangu large model. Whether you are a developer exploring application development or an ordinary user eager to understand system features, you can "recharge" here and quickly grasp the essence of HarmonyOS NEXT.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">342</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qingkouwei</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
